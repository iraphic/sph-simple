<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPH Generator</title>
    <link rel="icon" type="image/x-icon" href="logo.png">
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Libraries -->
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <div id="root">
        <div style="text-align: center; padding: 50px; font-family: sans-serif; color: #666;">
            Loading Application...<br>
            <small>Jika halaman tidak muncul, pastikan koneksi internet aktif untuk memuat library.</small>
        </div>
    </div>

    <script type="text/babel">
        
        
        const base64ToUint8Array = (base64) => {
            const binaryString = window.atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes;
        };

        const { useState, useEffect } = React;
        
        // Safety check for docx
        const docx = window.docx;
        if (!docx) {
            document.getElementById('root').innerHTML = '<div style="color:red; padding:20px; text-align:center;">Error: Library docx gagal dimuat. Coba refresh halaman.</div>';
            throw new Error("docx library not loaded");
        }
        
        const { Document, Packer, Paragraph, Table, TableCell, TableRow, TextRun, AlignmentType, WidthType, BorderStyle, Header, Footer, ImageRun, VerticalAlign } = docx;

        // Icons
        const IconPlus = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>;
        const IconTrash = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>;
        const IconDownload = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>;
        const IconFileText = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>;
        const IconX = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;

        const SERVICE_OPTIONS = [
            "Astinet", "Astinet Lite", "Astinet Fit", "Astinet Beda Bandwidth",
            "Metro Ethernet", "SIP Trunk", "WMS", "WMS Fit", "WMS Lite",
            "IP Transit", "IP Transit Beda Bandwidth", "VPN IP"
        ];
        
        // --- IP Transit Pricing Data ---
        const IP_TRANSIT_PRICING = [
            { bw: 1, jabodetabek: 99000, jawa: 112000, sumatera: 120000, kti: 130000 },
            { bw: 2, jabodetabek: 192000, jawa: 216000, sumatera: 231000, kti: 250000 },
            { bw: 3, jabodetabek: 279000, jawa: 314000, sumatera: 336000, kti: 364000 },
            { bw: 4, jabodetabek: 360000, jawa: 405000, sumatera: 433000, kti: 470000 },
            { bw: 5, jabodetabek: 438000, jawa: 491000, sumatera: 526000, kti: 569000 },
            { bw: 6, jabodetabek: 507000, jawa: 569000, sumatera: 610000, kti: 661000 },
            { bw: 7, jabodetabek: 572000, jawa: 643000, sumatera: 688000, kti: 746000 },
            { bw: 8, jabodetabek: 634000, jawa: 711000, sumatera: 761000, kti: 824000 },
            { bw: 9, jabodetabek: 686000, jawa: 770000, sumatera: 825000, kti: 893000 },
            { bw: 10, jabodetabek: 735000, jawa: 825000, sumatera: 883000, kti: 957000 },
            { bw: 20, jabodetabek: 1429000, jawa: 1602000, sumatera: 1716000, kti: 1859000 },
            { bw: 50, jabodetabek: 3256000, jawa: 3648000, sumatera: 3909000, kti: 4234000 },
            { bw: 100, jabodetabek: 5797000, jawa: 6493000, sumatera: 6956000, kti: 7537000 },
            { bw: 200, jabodetabek: 10583000, jawa: 11854000, sumatera: 12701000, kti: 13759000 },
            { bw: 500, jabodetabek: 21383000, jawa: 23950000, sumatera: 25661000, kti: 27799000 },
            { bw: 600, jabodetabek: 24975000, jawa: 27973000, sumatera: 29970000, kti: 32468000 },
            { bw: 700, jabodetabek: 27412000, jawa: 30702000, sumatera: 32896000, kti: 35637000 },
            { bw: 800, jabodetabek: 29417000, jawa: 32950000, sumatera: 35302000, kti: 38244000 },
            { bw: 900, jabodetabek: 31010000, jawa: 34732000, sumatera: 37213000, kti: 40314000 },
            { bw: 1000, jabodetabek: 32216000, jawa: 36083000, sumatera: 38660000, kti: 41881000 },
            { bw: 2000, jabodetabek: 62640000, jawa: 70158000, sumatera: 75169000, kti: 81433000 },
            { bw: 3000, jabodetabek: 91275000, jawa: 102229000, sumatera: 109531000, kti: 118658000 },
            { bw: 4000, jabodetabek: 118120000, jawa: 132296000, sumatera: 141745000, kti: 153558000 },
            { bw: 5000, jabodetabek: 143176000, jawa: 160359000, sumatera: 171813000, kti: 186130000 },
            { bw: 6000, jabodetabek: 166441000, jawa: 186414000, sumatera: 199731000, kti: 216375000 },
            { bw: 7000, jabodetabek: 187918000, jawa: 210469000, sumatera: 225502000, kti: 244294000 },
            { bw: 8000, jabodetabek: 207604000, jawa: 232517000, sumatera: 249126000, kti: 269886000 },
            { bw: 9000, jabodetabek: 225501000, jawa: 252561000, sumatera: 270602000, kti: 293152000 },
            { bw: 10000, jabodetabek: 241608000, jawa: 270602000, sumatera: 289931000, kti: 314092000 }
        ];


        const IP_TRANSIT_NEUCENTRIX_PRICING = [
            { bw: 10, price: 671000 },
            { bw: 20, price: 1302000 },
            { bw: 50, price: 2973000 },
            { bw: 100, price: 5016000 },
            { bw: 200, price: 9753000 },
            { bw: 500, price: 20108000 },
            { bw: 600, price: 22742000 },
            { bw: 700, price: 24960000 },
            { bw: 800, price: 26786000 },
            { bw: 900, price: 28237000 },
            { bw: 1000, price: 29334000 },
            { bw: 2000, price: 55734600 },
            { bw: 3000, price: 79201800 },
            { bw: 5000, price: 123202800 }
        ];

        const IP_TRANSIT_NEUCENTRIX_BB_PRICING = [
            { bw: 100, g: 6278000, d: 3074000 },
            { bw: 200, g: 12196000, d: 5971000 },
            { bw: 300, g: 16509000, d: 8620000 },
            { bw: 400, g: 20822000, d: 11268000 },
            { bw: 500, g: 25135000, d: 13072000 },
            { bw: 600, g: 28431000, d: 15181000 },
            { bw: 700, g: 31207000, d: 17543000 },
            { bw: 800, g: 33490000, d: 18825000 },
            { bw: 900, g: 35298000, d: 19845000 },
            { bw: 1000, g: 36668000, d: 21084000 }
        ];

        
        const WMS_PACKAGES = {
            "WMS Silver": { bandwidth: "20 Mbps", price: 435000 },
            "WMS Gamer 30": { bandwidth: "30 Mbps", price: 600000 },
            "WMS Gamer 40": { bandwidth: "40 Mbps", price: 775000 },
            "WMS Gold": { bandwidth: "50 Mbps", price: 950000 },
            "WMS Platinum": { bandwidth: "100 Mbps", price: 1500000 }
        };

        const WMS_FIT_PACKAGES = {
            "WMS Fit Gold": { bandwidth: "50 Mbps", price: 393400 },
            "WMS Fit GoldPlus 75": { bandwidth: "75 Mbps", price: 519400 },
            "WMS Fit GoldPlus 100": { bandwidth: "100 Mbps", price: 643300 }
        };

        const WMS_LITE_PACKAGES = {
            "WMS Silver Lite": { bandwidth: "30 Mbps", price: 375000 },
            "WMS Silver Plus Lite": { bandwidth: "40 Mbps", price: 475000 },
            "WMS Gold Lite": { bandwidth: "50 Mbps", price: 575000 },
            "WMS Platinum Lite": { bandwidth: "100 Mbps", price: 1000000 }
        };

        const DURATION_OPTIONS = ["12 Bulan", "24 Bulan", "36 Bulan"];
        const BANDWIDTH_OPTIONS = [
            10, 20, 30, 50, 100, 200, 300, 400, 500, 1000, 2000, 5000, 10000
        ].map(n => n + " Mbps");
        
        const SL_WDM_BANDWIDTH_OPTIONS = [
            10, 20, 30, 40, 50, 60, 70, 80, 90, 100
        ].map(n => n + " Gbps");


        const VPN_IP_PRICING = {
            standard: {
                "Best Effort": {
                    0.032: { "JABODETABEK": 634000, "JATIM & BALNUS": 685000, "JABAR & JATENG": 685000, "SUMATRA": 755000, "KALIMANTAN": 838000, "SULAWESI": 846000, "PALMAL": 973000 },
                    0.064: { "JABODETABEK": 701000, "JATIM & BALNUS": 760000, "JABAR & JATENG": 760000, "SUMATRA": 838000, "KALIMANTAN": 928000, "SULAWESI": 936000, "PALMAL": 1075000 },
                    0.128: { "JABODETABEK": 759000, "JATIM & BALNUS": 822000, "JABAR & JATENG": 822000, "SUMATRA": 904000, "KALIMANTAN": 1004000, "SULAWESI": 1012000, "PALMAL": 1164000 },
                    0.256: { "JABODETABEK": 867000, "JATIM & BALNUS": 940000, "JABAR & JATENG": 940000, "SUMATRA": 1034000, "KALIMANTAN": 1147000, "SULAWESI": 1154000, "PALMAL": 1329000 },
                    0.512: { "JABODETABEK": 1050000, "JATIM & BALNUS": 1135000, "JABAR & JATENG": 1135000, "SUMATRA": 1251000, "KALIMANTAN": 1389000, "SULAWESI": 1399000, "PALMAL": 1611000 },
                    1: { "JABODETABEK": 1802000, "JATIM & BALNUS": 1948000, "JABAR & JATENG": 1948000, "SUMATRA": 2146000, "KALIMANTAN": 2380000, "SULAWESI": 2398000, "PALMAL": 2763000 },
                    2: { "JABODETABEK": 3302000, "JATIM & BALNUS": 3568000, "JABAR & JATENG": 3568000, "SUMATRA": 3934000, "KALIMANTAN": 4362000, "SULAWESI": 4393000, "PALMAL": 5064000 },
                    3: { "JABODETABEK": 3528000, "JATIM & BALNUS": 3811000, "JABAR & JATENG": 3811000, "SUMATRA": 4199000, "KALIMANTAN": 4658000, "SULAWESI": 4694000, "PALMAL": 5410000 },
                    4: { "JABODETABEK": 3718000, "JATIM & BALNUS": 4018000, "JABAR & JATENG": 4018000, "SUMATRA": 4424000, "KALIMANTAN": 4910000, "SULAWESI": 4945000, "PALMAL": 5701000 },
                    5: { "JABODETABEK": 3943000, "JATIM & BALNUS": 4261000, "JABAR & JATENG": 4261000, "SUMATRA": 4694000, "KALIMANTAN": 5206000, "SULAWESI": 5246000, "PALMAL": 6046000 },
                    6: { "JABODETABEK": 4128000, "JATIM & BALNUS": 4460000, "JABAR & JATENG": 4460000, "SUMATRA": 4914000, "KALIMANTAN": 5453000, "SULAWESI": 5493000, "PALMAL": 6330000 },
                    7: { "JABODETABEK": 4318000, "JATIM & BALNUS": 4667000, "JABAR & JATENG": 4667000, "SUMATRA": 5140000, "KALIMANTAN": 5701000, "SULAWESI": 5745000, "PALMAL": 6622000 },
                    8: { "JABODETABEK": 4543000, "JATIM & BALNUS": 4910000, "JABAR & JATENG": 4910000, "SUMATRA": 5409000, "KALIMANTAN": 6001000, "SULAWESI": 6045000, "PALMAL": 6967000 },
                    9: { "JABODETABEK": 4954000, "JATIM & BALNUS": 5351000, "JABAR & JATENG": 5351000, "SUMATRA": 5899000, "KALIMANTAN": 6544000, "SULAWESI": 6592000, "PALMAL": 7596000 },
                    10: { "JABODETABEK": 5404000, "JATIM & BALNUS": 5837000, "JABAR & JATENG": 5837000, "SUMATRA": 6433000, "KALIMANTAN": 7135000, "SULAWESI": 7189000, "PALMAL": 8287000 },
                    20: { "JABODETABEK": 7621000, "JATIM & BALNUS": 8235000, "JABAR & JATENG": 8235000, "SUMATRA": 9070000, "KALIMANTAN": 10063000, "SULAWESI": 10138000, "PALMAL": 11686000 },
                    30: { "JABODETABEK": 9873000, "JATIM & BALNUS": 10663000, "JABAR & JATENG": 10663000, "SUMATRA": 11750000, "KALIMANTAN": 13035000, "SULAWESI": 13132000, "PALMAL": 15139000 },
                    40: { "JABODETABEK": 12085000, "JATIM & BALNUS": 13052000, "JABAR & JATENG": 13052000, "SUMATRA": 14386000, "KALIMANTAN": 15954000, "SULAWESI": 16077000, "PALMAL": 18531000 },
                    50: { "JABODETABEK": 13661000, "JATIM & BALNUS": 14757000, "JABAR & JATENG": 14757000, "SUMATRA": 16258000, "KALIMANTAN": 18038000, "SULAWESI": 18174000, "PALMAL": 20948000 },
                    60: { "JABODETABEK": 14602000, "JATIM & BALNUS": 15772000, "JABAR & JATENG": 15772000, "SUMATRA": 17380000, "KALIMANTAN": 19278000, "SULAWESI": 19424000, "PALMAL": 22390000 },
                    70: { "JABODETABEK": 15503000, "JATIM & BALNUS": 16744000, "JABAR & JATENG": 16744000, "SUMATRA": 18453000, "KALIMANTAN": 20466000, "SULAWESI": 20621000, "PALMAL": 23772000 },
                    80: { "JABODETABEK": 16439000, "JATIM & BALNUS": 17755000, "JABAR & JATENG": 17755000, "SUMATRA": 19566000, "KALIMANTAN": 21703000, "SULAWESI": 21866000, "PALMAL": 25207000 },
                    90: { "JABODETABEK": 17340000, "JATIM & BALNUS": 18730000, "JABAR & JATENG": 18730000, "SUMATRA": 20638000, "KALIMANTAN": 22890000, "SULAWESI": 23062000, "PALMAL": 26588000 },
                    100: { "JABODETABEK": 18281000, "JATIM & BALNUS": 19747000, "JABAR & JATENG": 19747000, "SUMATRA": 21756000, "KALIMANTAN": 24132000, "SULAWESI": 24317000, "PALMAL": 28031000 },
                    200: { "JABODETABEK": 26162000, "JATIM & BALNUS": 28255000, "JABAR & JATENG": 28255000, "SUMATRA": 31134000, "KALIMANTAN": 34534000, "SULAWESI": 34799000, "PALMAL": 40115000 },
                    300: { "JABODETABEK": 31902000, "JATIM & BALNUS": 34455000, "JABAR & JATENG": 34455000, "SUMATRA": 37965000, "KALIMANTAN": 42112000, "SULAWESI": 42434000, "PALMAL": 48918000 },
                    400: { "JABODETABEK": 37082000, "JATIM & BALNUS": 40050000, "JABAR & JATENG": 40050000, "SUMATRA": 44130000, "KALIMANTAN": 48952000, "SULAWESI": 49323000, "PALMAL": 56860000 },
                    500: { "JABODETABEK": 42262000, "JATIM & BALNUS": 45644000, "JABAR & JATENG": 45644000, "SUMATRA": 50294000, "KALIMANTAN": 55787000, "SULAWESI": 56211000, "PALMAL": 64802000 },
                    600: { "JABODETABEK": 47441000, "JATIM & BALNUS": 51239000, "JABAR & JATENG": 51239000, "SUMATRA": 56458000, "KALIMANTAN": 62627000, "SULAWESI": 63099000, "PALMAL": 72743000 },
                    700: { "JABODETABEK": 51759000, "JATIM & BALNUS": 55901000, "JABAR & JATENG": 55901000, "SUMATRA": 61597000, "KALIMANTAN": 68327000, "SULAWESI": 68843000, "PALMAL": 79364000 },
                    800: { "JABODETABEK": 55888000, "JATIM & BALNUS": 60361000, "JABAR & JATENG": 60361000, "SUMATRA": 66507000, "KALIMANTAN": 73775000, "SULAWESI": 74332000, "PALMAL": 85695000 },
                    900: { "JABODETABEK": 59977000, "JATIM & BALNUS": 64777000, "JABAR & JATENG": 64777000, "SUMATRA": 71374000, "KALIMANTAN": 79172000, "SULAWESI": 79772000, "PALMAL": 91965000 },
                    1000: { "JABODETABEK": 64070000, "JATIM & BALNUS": 69197000, "JABAR & JATENG": 69197000, "SUMATRA": 76245000, "KALIMANTAN": 84576000, "SULAWESI": 85217000, "PALMAL": 98241000 },
                },
                "Critical": {
                    0.032: { "JABODETABEK": 720000, "JATIM & BALNUS": 779000, "JABAR & JATENG": 779000, "SUMATRA": 857000, "KALIMANTAN": 952000, "SULAWESI": 960000, "PALMAL": 1105000 },
                    0.064: { "JABODETABEK": 799000, "JATIM & BALNUS": 866000, "JABAR & JATENG": 866000, "SUMATRA": 952000, "KALIMANTAN": 1057000, "SULAWESI": 1065000, "PALMAL": 1225000 },
                    0.128: { "JABODETABEK": 901000, "JATIM & BALNUS": 975000, "JABAR & JATENG": 975000, "SUMATRA": 1074000, "KALIMANTAN": 1191000, "SULAWESI": 1199000, "PALMAL": 1381000 },
                    0.256: { "JABODETABEK": 1065000, "JATIM & BALNUS": 1152000, "JABAR & JATENG": 1152000, "SUMATRA": 1269000, "KALIMANTAN": 1410000, "SULAWESI": 1418000, "PALMAL": 1633000 },
                    0.512: { "JABODETABEK": 1331000, "JATIM & BALNUS": 1441000, "JABAR & JATENG": 1441000, "SUMATRA": 1586000, "KALIMANTAN": 1758000, "SULAWESI": 1774000, "PALMAL": 2041000 },
                    1: { "JABODETABEK": 2027000, "JATIM & BALNUS": 2191000, "JABAR & JATENG": 2191000, "SUMATRA": 2416000, "KALIMANTAN": 2676000, "SULAWESI": 2699000, "PALMAL": 3108000 },
                    2: { "JABODETABEK": 3678000, "JATIM & BALNUS": 3974000, "JABAR & JATENG": 3974000, "SUMATRA": 4380000, "KALIMANTAN": 4857000, "SULAWESI": 4892000, "PALMAL": 5640000 },
                    3: { "JABODETABEK": 3943000, "JATIM & BALNUS": 4261000, "JABAR & JATENG": 4261000, "SUMATRA": 4694000, "KALIMANTAN": 5206000, "SULAWESI": 5246000, "PALMAL": 6046000 },
                    4: { "JABODETABEK": 4168000, "JATIM & BALNUS": 4505000, "JABAR & JATENG": 4505000, "SUMATRA": 4964000, "KALIMANTAN": 5506000, "SULAWESI": 5546000, "PALMAL": 6392000 },
                    5: { "JABODETABEK": 4393000, "JATIM & BALNUS": 4747000, "JABAR & JATENG": 4747000, "SUMATRA": 5233000, "KALIMANTAN": 5803000, "SULAWESI": 5847000, "PALMAL": 6737000 },
                    6: { "JABODETABEK": 4619000, "JATIM & BALNUS": 4990000, "JABAR & JATENG": 4990000, "SUMATRA": 5498000, "KALIMANTAN": 6098000, "SULAWESI": 6147000, "PALMAL": 7082000 },
                    7: { "JABODETABEK": 4844000, "JATIM & BALNUS": 5232000, "JABAR & JATENG": 5232000, "SUMATRA": 5767000, "KALIMANTAN": 6399000, "SULAWESI": 6447000, "PALMAL": 7427000 },
                    8: { "JABODETABEK": 5069000, "JATIM & BALNUS": 5475000, "JABAR & JATENG": 5475000, "SUMATRA": 6036000, "KALIMANTAN": 6694000, "SULAWESI": 6743000, "PALMAL": 7773000 },
                    9: { "JABODETABEK": 5555000, "JATIM & BALNUS": 6001000, "JABAR & JATENG": 6001000, "SUMATRA": 6615000, "KALIMANTAN": 7334000, "SULAWESI": 7392000, "PALMAL": 8517000 },
                    10: { "JABODETABEK": 6045000, "JATIM & BALNUS": 6531000, "JABAR & JATENG": 6531000, "SUMATRA": 7198000, "KALIMANTAN": 7983000, "SULAWESI": 8041000, "PALMAL": 9269000 },
                    20: { "JABODETABEK": 8522000, "JATIM & BALNUS": 9207000, "JABAR & JATENG": 9207000, "SUMATRA": 10143000, "KALIMANTAN": 11251000, "SULAWESI": 11335000, "PALMAL": 13067000 },
                    30: { "JABODETABEK": 11034000, "JATIM & BALNUS": 11918000, "JABAR & JATENG": 11918000, "SUMATRA": 13132000, "KALIMANTAN": 14567000, "SULAWESI": 14678000, "PALMAL": 16919000 },
                    40: { "JABODETABEK": 13512000, "JATIM & BALNUS": 14594000, "JABAR & JATENG": 14594000, "SUMATRA": 16082000, "KALIMANTAN": 17840000, "SULAWESI": 17972000, "PALMAL": 20718000 },
                    50: { "JABODETABEK": 15313000, "JATIM & BALNUS": 16541000, "JABAR & JATENG": 16541000, "SUMATRA": 18224000, "KALIMANTAN": 20215000, "SULAWESI": 20369000, "PALMAL": 23480000 },
                    60: { "JABODETABEK": 16364000, "JATIM & BALNUS": 17676000, "JABAR & JATENG": 17676000, "SUMATRA": 19477000, "KALIMANTAN": 21601000, "SULAWESI": 21764000, "PALMAL": 25092000 },
                    70: { "JABODETABEK": 17380000, "JATIM & BALNUS": 18771000, "JABAR & JATENG": 18771000, "SUMATRA": 20683000, "KALIMANTAN": 22944000, "SULAWESI": 23116000, "PALMAL": 26649000 },
                    80: { "JABODETABEK": 18391000, "JATIM & BALNUS": 19866000, "JABAR & JATENG": 19866000, "SUMATRA": 21889000, "KALIMANTAN": 24278000, "SULAWESI": 24463000, "PALMAL": 28200000 },
                    90: { "JABODETABEK": 19441000, "JATIM & BALNUS": 21001000, "JABAR & JATENG": 21001000, "SUMATRA": 23138000, "KALIMANTAN": 25663000, "SULAWESI": 25858000, "PALMAL": 29811000 },
                    100: { "JABODETABEK": 20458000, "JATIM & BALNUS": 22096000, "JABAR & JATENG": 22096000, "SUMATRA": 24348000, "KALIMANTAN": 27006000, "SULAWESI": 27210000, "PALMAL": 31369000 },
                    200: { "JABODETABEK": 29315000, "JATIM & BALNUS": 31664000, "JABAR & JATENG": 31664000, "SUMATRA": 34888000, "KALIMANTAN": 38699000, "SULAWESI": 38990000, "PALMAL": 44949000 },
                    300: { "JABODETABEK": 35731000, "JATIM & BALNUS": 38593000, "JABAR & JATENG": 38593000, "SUMATRA": 42523000, "KALIMANTAN": 47168000, "SULAWESI": 47525000, "PALMAL": 54787000 },
                    400: { "JABODETABEK": 41551000, "JATIM & BALNUS": 44876000, "JABAR & JATENG": 44876000, "SUMATRA": 49446000, "KALIMANTAN": 54851000, "SULAWESI": 55267000, "PALMAL": 63711000 },
                    500: { "JABODETABEK": 47331000, "JATIM & BALNUS": 51120000, "JABAR & JATENG": 51120000, "SUMATRA": 56326000, "KALIMANTAN": 62481000, "SULAWESI": 62954000, "PALMAL": 72574000 },
                    600: { "JABODETABEK": 53146000, "JATIM & BALNUS": 57399000, "JABAR & JATENG": 57399000, "SUMATRA": 63246000, "KALIMANTAN": 70156000, "SULAWESI": 70686000, "PALMAL": 81491000 },
                    700: { "JABODETABEK": 57990000, "JATIM & BALNUS": 62631000, "JABAR & JATENG": 62631000, "SUMATRA": 69011000, "KALIMANTAN": 76549000, "SULAWESI": 77127000, "PALMAL": 88917000 },
                    800: { "JABODETABEK": 62569000, "JATIM & BALNUS": 67576000, "JABAR & JATENG": 67576000, "SUMATRA": 74460000, "KALIMANTAN": 82593000, "SULAWESI": 83221000, "PALMAL": 95938000 },
                    900: { "JABODETABEK": 67184000, "JATIM & BALNUS": 72562000, "JABAR & JATENG": 72562000, "SUMATRA": 79949000, "KALIMANTAN": 88683000, "SULAWESI": 89354000, "PALMAL": 103014000 },
                    1000: { "JABODETABEK": 71763000, "JATIM & BALNUS": 77507000, "JABAR & JATENG": 77507000, "SUMATRA": 85398000, "KALIMANTAN": 94728000, "SULAWESI": 95448000, "PALMAL": 110036000 },
                },
                "Interactive": {
                    0.032: { "JABODETABEK": 842000, "JATIM & BALNUS": 913000, "JABAR & JATENG": 913000, "SUMATRA": 1003000, "KALIMANTAN": 1112000, "SULAWESI": 1120000, "PALMAL": 1291000 },
                    0.064: { "JABODETABEK": 932000, "JATIM & BALNUS": 1011000, "JABAR & JATENG": 1011000, "SUMATRA": 1112000, "KALIMANTAN": 1234000, "SULAWESI": 1242000, "PALMAL": 1429000 },
                    0.128: { "JABODETABEK": 1065000, "JATIM & BALNUS": 1152000, "JABAR & JATENG": 1152000, "SUMATRA": 1269000, "KALIMANTAN": 1410000, "SULAWESI": 1418000, "PALMAL": 1633000 },
                    0.256: { "JABODETABEK": 1265000, "JATIM & BALNUS": 1367000, "JABAR & JATENG": 1367000, "SUMATRA": 1508000, "KALIMANTAN": 1672000, "SULAWESI": 1684000, "PALMAL": 1939000 },
                    0.512: { "JABODETABEK": 1566000, "JATIM & BALNUS": 1692000, "JABAR & JATENG": 1692000, "SUMATRA": 1864000, "KALIMANTAN": 2068000, "SULAWESI": 2083000, "PALMAL": 2401000 },
                    1: { "JABODETABEK": 2403000, "JATIM & BALNUS": 2597000, "JABAR & JATENG": 2597000, "SUMATRA": 2862000, "KALIMANTAN": 3175000, "SULAWESI": 3198000, "PALMAL": 3684000 },
                    2: { "JABODETABEK": 4393000, "JATIM & BALNUS": 4747000, "JABAR & JATENG": 4747000, "SUMATRA": 5232000, "KALIMANTAN": 5803000, "SULAWESI": 5846000, "PALMAL": 6736000 },
                    3: { "JABODETABEK": 4654000, "JATIM & BALNUS": 5030000, "JABAR & JATENG": 5030000, "SUMATRA": 5542000, "KALIMANTAN": 6146000, "SULAWESI": 6191000, "PALMAL": 7136000 },
                    4: { "JABODETABEK": 4954000, "JATIM & BALNUS": 5352000, "JABAR & JATENG": 5352000, "SUMATRA": 5900000, "KALIMANTAN": 6545000, "SULAWESI": 6592000, "PALMAL": 7597000 },
                    5: { "JABODETABEK": 5219000, "JATIM & BALNUS": 5639000, "JABAR & JATENG": 5639000, "SUMATRA": 6214000, "KALIMANTAN": 6894000, "SULAWESI": 6946000, "PALMAL": 8003000 },
                    6: { "JABODETABEK": 5480000, "JATIM & BALNUS": 5922000, "JABAR & JATENG": 5922000, "SUMATRA": 6522000, "KALIMANTAN": 7237000, "SULAWESI": 7291000, "PALMAL": 8402000 },
                    7: { "JABODETABEK": 5745000, "JATIM & BALNUS": 6209000, "JABAR & JATENG": 6209000, "SUMATRA": 6840000, "KALIMANTAN": 7586000, "SULAWESI": 7644000, "PALMAL": 8809000 },
                    8: { "JABODETABEK": 6045000, "JATIM & BALNUS": 6531000, "JABAR & JATENG": 6531000, "SUMATRA": 7198000, "KALIMANTAN": 7984000, "SULAWESI": 8041000, "PALMAL": 9269000 },
                    9: { "JABODETABEK": 6605000, "JATIM & BALNUS": 7136000, "JABAR & JATENG": 7136000, "SUMATRA": 7864000, "KALIMANTAN": 8721000, "SULAWESI": 8787000, "PALMAL": 10128000 },
                    10: { "JABODETABEK": 7206000, "JATIM & BALNUS": 7785000, "JABAR & JATENG": 7785000, "SUMATRA": 8580000, "KALIMANTAN": 9516000, "SULAWESI": 9587000, "PALMAL": 11050000 },
                    20: { "JABODETABEK": 10134000, "JATIM & BALNUS": 10946000, "JABAR & JATENG": 10946000, "SUMATRA": 12064000, "KALIMANTAN": 13379000, "SULAWESI": 13481000, "PALMAL": 15539000 },
                    30: { "JABODETABEK": 13136000, "JATIM & BALNUS": 14187000, "JABAR & JATENG": 14187000, "SUMATRA": 15636000, "KALIMANTAN": 17341000, "SULAWESI": 17473000, "PALMAL": 20143000 },
                    40: { "JABODETABEK": 16064000, "JATIM & BALNUS": 17353000, "JABAR & JATENG": 17353000, "SUMATRA": 19120000, "KALIMANTAN": 21209000, "SULAWESI": 21368000, "PALMAL": 24632000 },
                    50: { "JABODETABEK": 18205000, "JATIM & BALNUS": 19663000, "JABAR & JATENG": 19663000, "SUMATRA": 21668000, "KALIMANTAN": 24034000, "SULAWESI": 24215000, "PALMAL": 27915000 },
                    60: { "JABODETABEK": 19441000, "JATIM & BALNUS": 21001000, "JABAR & JATENG": 21001000, "SUMATRA": 23138000, "KALIMANTAN": 25663000, "SULAWESI": 25858000, "PALMAL": 29811000 },
                    70: { "JABODETABEK": 20643000, "JATIM & BALNUS": 22295000, "JABAR & JATENG": 22295000, "SUMATRA": 24569000, "KALIMANTAN": 27249000, "SULAWESI": 27457000, "PALMAL": 31653000 },
                    80: { "JABODETABEK": 21884000, "JATIM & BALNUS": 23637000, "JABAR & JATENG": 23637000, "SUMATRA": 26044000, "KALIMANTAN": 28888000, "SULAWESI": 29108000, "PALMAL": 33556000 },
                    90: { "JABODETABEK": 23120000, "JATIM & BALNUS": 24970000, "JABAR & JATENG": 24970000, "SUMATRA": 27513000, "KALIMANTAN": 30521000, "SULAWESI": 30750000, "PALMAL": 35451000 },
                    100: { "JABODETABEK": 24322000, "JATIM & BALNUS": 26269000, "JABAR & JATENG": 26269000, "SUMATRA": 28945000, "KALIMANTAN": 32107000, "SULAWESI": 32350000, "PALMAL": 37293000 },
                    200: { "JABODETABEK": 34905000, "JATIM & BALNUS": 37701000, "JABAR & JATENG": 37701000, "SUMATRA": 41538000, "KALIMANTAN": 46077000, "SULAWESI": 46426000, "PALMAL": 53521000 },
                    300: { "JABODETABEK": 42487000, "JATIM & BALNUS": 45887000, "JABAR & JATENG": 45887000, "SUMATRA": 50564000, "KALIMANTAN": 56087000, "SULAWESI": 56511000, "PALMAL": 65147000 },
                    400: { "JABODETABEK": 49358000, "JATIM & BALNUS": 53310000, "JABAR & JATENG": 53310000, "SUMATRA": 58737000, "KALIMANTAN": 65153000, "SULAWESI": 65647000, "PALMAL": 75682000 },
                    500: { "JABODETABEK": 56264000, "JATIM & BALNUS": 60768000, "JABAR & JATENG": 60768000, "SUMATRA": 66955000, "KALIMANTAN": 74271000, "SULAWESI": 74832000, "PALMAL": 86271000 },
                    600: { "JABODETABEK": 63170000, "JATIM & BALNUS": 68226000, "JABAR & JATENG": 68226000, "SUMATRA": 75177000, "KALIMANTAN": 83385000, "SULAWESI": 84017000, "PALMAL": 96860000 },
                    700: { "JABODETABEK": 68910000, "JATIM & BALNUS": 74425000, "JABAR & JATENG": 74425000, "SUMATRA": 82006000, "KALIMANTAN": 90962000, "SULAWESI": 91650000, "PALMAL": 105661000 },
                    800: { "JABODETABEK": 74389000, "JATIM & BALNUS": 80342000, "JABAR & JATENG": 80342000, "SUMATRA": 88523000, "KALIMANTAN": 98198000, "SULAWESI": 98941000, "PALMAL": 114063000 },
                    900: { "JABODETABEK": 79834000, "JATIM & BALNUS": 86224000, "JABAR & JATENG": 86224000, "SUMATRA": 95007000, "KALIMANTAN": 105383000, "SULAWESI": 106182000, "PALMAL": 122412000 },
                    1000: { "JABODETABEK": 85314000, "JATIM & BALNUS": 92141000, "JABAR & JATENG": 92141000, "SUMATRA": 101524000, "KALIMANTAN": 112616000, "SULAWESI": 113468000, "PALMAL": 130815000 },
                }
            },
            dual_homing: {
                "Best Effort": {
                    0.032: { "JABODETABEK": 889000, "JATIM & BALNUS": 959000, "JABAR & JATENG": 960000, "SUMATRA": 1061000, "KALIMANTAN": 1175000, "SULAWESI": 1187000, "PALMAL": 1364000 },
                    0.064: { "JABODETABEK": 983000, "JATIM & BALNUS": 1066000, "JABAR & JATENG": 1064000, "SUMATRA": 1175000, "KALIMANTAN": 1300000, "SULAWESI": 1312000, "PALMAL": 1508000 },
                    0.128: { "JABODETABEK": 1064000, "JATIM & BALNUS": 1154000, "JABAR & JATENG": 1154000, "SUMATRA": 1269000, "KALIMANTAN": 1406000, "SULAWESI": 1418000, "PALMAL": 1632000 },
                    0.256: { "JABODETABEK": 1217000, "JATIM & BALNUS": 1319000, "JABAR & JATENG": 1318000, "SUMATRA": 1449000, "KALIMANTAN": 1606000, "SULAWESI": 1617000, "PALMAL": 1863000 },
                    0.512: { "JABODETABEK": 1474000, "JATIM & BALNUS": 1590000, "JABAR & JATENG": 1590000, "SUMATRA": 1752000, "KALIMANTAN": 1946000, "SULAWESI": 1960000, "PALMAL": 2257000 },
                    1: { "JABODETABEK": 2526000, "JATIM & BALNUS": 2730000, "JABAR & JATENG": 2982000, "SUMATRA": 3008000, "KALIMANTAN": 3335000, "SULAWESI": 3362000, "PALMAL": 3870000 },
                    2: { "JABODETABEK": 4627000, "JATIM & BALNUS": 4999000, "JABAR & JATENG": 5462000, "SUMATRA": 5511000, "KALIMANTAN": 6112000, "SULAWESI": 6151000, "PALMAL": 7093000 },
                    3: { "JABODETABEK": 4941000, "JATIM & BALNUS": 5339000, "JABAR & JATENG": 5834000, "SUMATRA": 5882000, "KALIMANTAN": 6522000, "SULAWESI": 6575000, "PALMAL": 7577000 },
                    4: { "JABODETABEK": 5206000, "JATIM & BALNUS": 5626000, "JABAR & JATENG": 6147000, "SUMATRA": 6195000, "KALIMANTAN": 6875000, "SULAWESI": 6924000, "PALMAL": 7983000 },
                    5: { "JABODETABEK": 5524000, "JATIM & BALNUS": 5966000, "JABAR & JATENG": 6518000, "SUMATRA": 6575000, "KALIMANTAN": 7291000, "SULAWESI": 7348000, "PALMAL": 8467000 },
                    6: { "JABODETABEK": 5780000, "JATIM & BALNUS": 6244000, "JABAR & JATENG": 6827000, "SUMATRA": 6884000, "KALIMANTAN": 7634000, "SULAWESI": 7693000, "PALMAL": 8863000 },
                    7: { "JABODETABEK": 6050000, "JATIM & BALNUS": 6535000, "JABAR & JATENG": 7141000, "SUMATRA": 7198000, "KALIMANTAN": 7984000, "SULAWESI": 8046000, "PALMAL": 9273000 },
                    8: { "JABODETABEK": 6363000, "JATIM & BALNUS": 6875000, "JABAR & JATENG": 7511000, "SUMATRA": 7573000, "KALIMANTAN": 8404000, "SULAWESI": 8465000, "PALMAL": 9757000 },
                    9: { "JABODETABEK": 6937000, "JATIM & BALNUS": 7493000, "JABAR & JATENG": 8187000, "SUMATRA": 8262000, "KALIMANTAN": 9163000, "SULAWESI": 9234000, "PALMAL": 10637000 },
                    10: { "JABODETABEK": 7568000, "JATIM & BALNUS": 8173000, "JABAR & JATENG": 8933000, "SUMATRA": 9008000, "KALIMANTAN": 9992000, "SULAWESI": 10068000, "PALMAL": 11605000 },
                    20: { "JABODETABEK": 10672000, "JATIM & BALNUS": 11529000, "JABAR & JATENG": 12593000, "SUMATRA": 12700000, "KALIMANTAN": 14090000, "SULAWESI": 14196000, "PALMAL": 16361000 },
                    30: { "JABODETABEK": 13825000, "JATIM & BALNUS": 14929000, "JABAR & JATENG": 16316000, "SUMATRA": 16452000, "KALIMANTAN": 18250000, "SULAWESI": 18387000, "PALMAL": 21196000 },
                    40: { "JABODETABEK": 16921000, "JATIM & BALNUS": 18276000, "JABAR & JATENG": 19968000, "SUMATRA": 20145000, "KALIMANTAN": 22340000, "SULAWESI": 22511000, "PALMAL": 25946000 },
                    50: { "JABODETABEK": 19128000, "JATIM & BALNUS": 20661000, "JABAR & JATENG": 22572000, "SUMATRA": 22763000, "KALIMANTAN": 25253000, "SULAWESI": 25447000, "PALMAL": 29330000 },
                    60: { "JABODETABEK": 20444000, "JATIM & BALNUS": 22083000, "JABAR & JATENG": 24132000, "SUMATRA": 24334000, "KALIMANTAN": 26992000, "SULAWESI": 27196000, "PALMAL": 31348000 },
                    70: { "JABODETABEK": 21707000, "JATIM & BALNUS": 23443000, "JABAR & JATENG": 25615000, "SUMATRA": 25836000, "KALIMANTAN": 28653000, "SULAWESI": 28870000, "PALMAL": 33281000 },
                    80: { "JABODETABEK": 23019000, "JATIM & BALNUS": 24861000, "JABAR & JATENG": 27166000, "SUMATRA": 27396000, "KALIMANTAN": 30385000, "SULAWESI": 30614000, "PALMAL": 35292000 },
                    90: { "JABODETABEK": 24277000, "JATIM & BALNUS": 26224000, "JABAR & JATENG": 28648000, "SUMATRA": 28896000, "KALIMANTAN": 32048000, "SULAWESI": 32292000, "PALMAL": 37225000 },
                    100: { "JABODETABEK": 25593000, "JATIM & BALNUS": 27647000, "JABAR & JATENG": 30208000, "SUMATRA": 30460000, "KALIMANTAN": 33785000, "SULAWESI": 34046000, "PALMAL": 39243000 },
                    200: { "JABODETABEK": 36627000, "JATIM & BALNUS": 39560000, "JABAR & JATENG": 43225000, "SUMATRA": 43591000, "KALIMANTAN": 48351000, "SULAWESI": 48722000, "PALMAL": 56162000 },
                    300: { "JABODETABEK": 44664000, "JATIM & BALNUS": 48241000, "JABAR & JATENG": 52709000, "SUMATRA": 53155000, "KALIMANTAN": 58957000, "SULAWESI": 59408000, "PALMAL": 68485000 },
                    400: { "JABODETABEK": 51919000, "JATIM & BALNUS": 56070000, "JABAR & JATENG": 61263000, "SUMATRA": 61784000, "KALIMANTAN": 68536000, "SULAWESI": 69052000, "PALMAL": 79606000 },
                    500: { "JABODETABEK": 59169000, "JATIM & BALNUS": 63903000, "JABAR & JATENG": 69820000, "SUMATRA": 70412000, "KALIMANTAN": 78104000, "SULAWESI": 78696000, "PALMAL": 90724000 },
                    600: { "JABODETABEK": 66420000, "JATIM & BALNUS": 71736000, "JABAR & JATENG": 78377000, "SUMATRA": 79045000, "KALIMANTAN": 87682000, "SULAWESI": 88339000, "PALMAL": 101843000 },
                    700: { "JABODETABEK": 72464000, "JATIM & BALNUS": 78262000, "JABAR & JATENG": 85508000, "SUMATRA": 86236000, "KALIMANTAN": 95660000, "SULAWESI": 96384000, "PALMAL": 111112000 },
                    800: { "JABODETABEK": 78244000, "JATIM & BALNUS": 84506000, "JABAR & JATENG": 92334000, "SUMATRA": 93112000, "KALIMANTAN": 103290000, "SULAWESI": 104067000, "PALMAL": 119975000 },
                    900: { "JABODETABEK": 83972000, "JATIM & BALNUS": 90688000, "JABAR & JATENG": 99086000, "SUMATRA": 99926000, "KALIMANTAN": 110841000, "SULAWESI": 111684000, "PALMAL": 128753000 },
                    1000: { "JABODETABEK": 89699000, "JATIM & BALNUS": 96879000, "JABAR & JATENG": 105847000, "SUMATRA": 106744000, "KALIMANTAN": 118409000, "SULAWESI": 119306000, "PALMAL": 137538000 },
                },
                "Critical": {
                    0.032: { "JABODETABEK": 1010000, "JATIM & BALNUS": 1092000, "JABAR & JATENG": 1199000, "SUMATRA": 1202000, "KALIMANTAN": 1336000, "SULAWESI": 1344000, "PALMAL": 1549000 },
                    0.064: { "JABODETABEK": 1120000, "JATIM & BALNUS": 1214000, "JABAR & JATENG": 1324000, "SUMATRA": 1336000, "KALIMANTAN": 1480000, "SULAWESI": 1492000, "PALMAL": 1718000 },
                    0.128: { "JABODETABEK": 1261000, "JATIM & BALNUS": 1367000, "JABAR & JATENG": 1492000, "SUMATRA": 1504000, "KALIMANTAN": 1669000, "SULAWESI": 1680000, "PALMAL": 1933000 },
                    0.256: { "JABODETABEK": 1492000, "JATIM & BALNUS": 1614000, "JABAR & JATENG": 1763000, "SUMATRA": 1778000, "KALIMANTAN": 1974000, "SULAWESI": 1985000, "PALMAL": 2288000 },
                    0.512: { "JABODETABEK": 1864000, "JATIM & BALNUS": 2021000, "JABAR & JATENG": 2205000, "SUMATRA": 2220000, "KALIMANTAN": 2464000, "SULAWESI": 2487000, "PALMAL": 2859000 },
                    1: { "JABODETABEK": 2840000, "JATIM & BALNUS": 3070000, "JABAR & JATENG": 3353000, "SUMATRA": 3384000, "KALIMANTAN": 3750000, "SULAWESI": 3781000, "PALMAL": 4355000 },
                    2: { "JABODETABEK": 5153000, "JATIM & BALNUS": 5564000, "JABAR & JATENG": 6080000, "SUMATRA": 6133000, "KALIMANTAN": 6800000, "SULAWESI": 6854000, "PALMAL": 7898000 },
                    3: { "JABODETABEK": 5524000, "JATIM & BALNUS": 5966000, "JABAR & JATENG": 6518000, "SUMATRA": 6575000, "KALIMANTAN": 7290000, "SULAWESI": 7348000, "PALMAL": 8467000 },
                    4: { "JABODETABEK": 5838000, "JATIM & BALNUS": 6306000, "JABAR & JATENG": 6889000, "SUMATRA": 6951000, "KALIMANTAN": 7710000, "SULAWESI": 7767000, "PALMAL": 8951000 },
                    5: { "JABODETABEK": 6151000, "JATIM & BALNUS": 6646000, "JABAR & JATENG": 7264000, "SUMATRA": 7327000, "KALIMANTAN": 8126000, "SULAWESI": 8187000, "PALMAL": 9432000 },
                    6: { "JABODETABEK": 6469000, "JATIM & BALNUS": 6986000, "JABAR & JATENG": 7635000, "SUMATRA": 7697000, "KALIMANTAN": 8540000, "SULAWESI": 8606000, "PALMAL": 9916000 },
                    7: { "JABODETABEK": 6783000, "JATIM & BALNUS": 7326000, "JABAR & JATENG": 8007000, "SUMATRA": 8076000, "KALIMANTAN": 8960000, "SULAWESI": 9027000, "PALMAL": 10400000 },
                    8: { "JABODETABEK": 7101000, "JATIM & BALNUS": 7666000, "JABAR & JATENG": 8377000, "SUMATRA": 8452000, "KALIMANTAN": 9376000, "SULAWESI": 9441000, "PALMAL": 10884000 },
                    9: { "JABODETABEK": 7780000, "JATIM & BALNUS": 8403000, "JABAR & JATENG": 9181000, "SUMATRA": 9265000, "KALIMANTAN": 10271000, "SULAWESI": 10351000, "PALMAL": 11926000 },
                    10: { "JABODETABEK": 8465000, "JATIM & BALNUS": 9145000, "JABAR & JATENG": 9993000, "SUMATRA": 10077000, "KALIMANTAN": 11180000, "SULAWESI": 11261000, "PALMAL": 12980000 },
                    20: { "JABODETABEK": 11931000, "JATIM & BALNUS": 12889000, "JABAR & JATENG": 14086000, "SUMATRA": 14201000, "KALIMANTAN": 15755000, "SULAWESI": 15870000, "PALMAL": 18295000 },
                    30: { "JABODETABEK": 15450000, "JATIM & BALNUS": 16687000, "JABAR & JATENG": 18232000, "SUMATRA": 18387000, "KALIMANTAN": 20396000, "SULAWESI": 20551000, "PALMAL": 23690000 },
                    40: { "JABODETABEK": 18917000, "JATIM & BALNUS": 20432000, "JABAR & JATENG": 22326000, "SUMATRA": 22516000, "KALIMANTAN": 24976000, "SULAWESI": 25161000, "PALMAL": 29006000 },
                    50: { "JABODETABEK": 21442000, "JATIM & BALNUS": 23160000, "JABAR & JATENG": 25306000, "SUMATRA": 25514000, "KALIMANTAN": 28305000, "SULAWESI": 28521000, "PALMAL": 32874000 },
                    60: { "JABODETABEK": 22912000, "JATIM & BALNUS": 24750000, "JABAR & JATENG": 27042000, "SUMATRA": 27271000, "KALIMANTAN": 30243000, "SULAWESI": 30472000, "PALMAL": 35129000 },
                    70: { "JABODETABEK": 24334000, "JATIM & BALNUS": 26282000, "JABAR & JATENG": 28716000, "SUMATRA": 28958000, "KALIMANTAN": 32124000, "SULAWESI": 32363000, "PALMAL": 37310000 },
                    80: { "JABODETABEK": 25748000, "JATIM & BALNUS": 27815000, "JABAR & JATENG": 30385000, "SUMATRA": 30646000, "KALIMANTAN": 33992000, "SULAWESI": 34248000, "PALMAL": 39481000 },
                    90: { "JABODETABEK": 27222000, "JATIM & BALNUS": 29403000, "JABAR & JATENG": 32123000, "SUMATRA": 32393000, "KALIMANTAN": 35930000, "SULAWESI": 36203000, "PALMAL": 41738000 },
                    100: { "JABODETABEK": 28645000, "JATIM & BALNUS": 30936000, "JABAR & JATENG": 33798000, "SUMATRA": 34089000, "KALIMANTAN": 37812000, "SULAWESI": 38095000, "PALMAL": 43919000 },
                    200: { "JABODETABEK": 41043000, "JATIM & BALNUS": 44333000, "JABAR & JATENG": 48436000, "SUMATRA": 48846000, "KALIMANTAN": 54180000, "SULAWESI": 54586000, "PALMAL": 62932000 },
                    300: { "JABODETABEK": 50024000, "JATIM & BALNUS": 54030000, "JABAR & JATENG": 59033000, "SUMATRA": 59532000, "KALIMANTAN": 66036000, "SULAWESI": 66539000, "PALMAL": 76704000 },
                    400: { "JABODETABEK": 58171000, "JATIM & BALNUS": 62830000, "JABAR & JATENG": 68646000, "SUMATRA": 69228000, "KALIMANTAN": 76793000, "SULAWESI": 77376000, "PALMAL": 89196000 },
                    500: { "JABODETABEK": 66265000, "JATIM & BALNUS": 71568000, "JABAR & JATENG": 78197000, "SUMATRA": 78859000, "KALIMANTAN": 87474000, "SULAWESI": 88136000, "PALMAL": 101607000 },
                    600: { "JABODETABEK": 74408000, "JATIM & BALNUS": 80360000, "JABAR & JATENG": 87805000, "SUMATRA": 88547000, "KALIMANTAN": 98222000, "SULAWESI": 98964000, "PALMAL": 114088000 },
                    700: { "JABODETABEK": 81189000, "JATIM & BALNUS": 87685000, "JABAR & JATENG": 95801000, "SUMATRA": 96618000, "KALIMANTAN": 107171000, "SULAWESI": 107979000, "PALMAL": 124487000 },
                    800: { "JABODETABEK": 87596000, "JATIM & BALNUS": 94609000, "JABAR & JATENG": 103369000, "SUMATRA": 104248000, "KALIMANTAN": 115631000, "SULAWESI": 116510000, "PALMAL": 134314000 },
                    900: { "JABODETABEK": 94057000, "JATIM & BALNUS": 101590000, "JABAR & JATENG": 110991000, "SUMATRA": 111932000, "KALIMANTAN": 124158000, "SULAWESI": 125099000, "PALMAL": 144220000 },
                    1000: { "JABODETABEK": 100468000, "JATIM & BALNUS": 108514000, "JABAR & JATENG": 118559000, "SUMATRA": 119558000, "KALIMANTAN": 132623000, "SULAWESI": 133630000, "PALMAL": 154052000 },
                },
                "Interactive": {
                    0.032: { "JABODETABEK": 1179000, "JATIM & BALNUS": 1281000, "JABAR & JATENG": 1395000, "SUMATRA": 1406000, "KALIMANTAN": 1559000, "SULAWESI": 1571000, "PALMAL": 1808000 },
                    0.064: { "JABODETABEK": 1308000, "JATIM & BALNUS": 1418000, "JABAR & JATENG": 1543000, "SUMATRA": 1559000, "KALIMANTAN": 1727000, "SULAWESI": 1739000, "PALMAL": 2002000 },
                    0.128: { "JABODETABEK": 1492000, "JATIM & BALNUS": 1614000, "JABAR & JATENG": 1763000, "SUMATRA": 1778000, "KALIMANTAN": 1974000, "SULAWESI": 1986000, "PALMAL": 2288000 },
                    0.256: { "JABODETABEK": 1774000, "JATIM & BALNUS": 1916000, "JABAR & JATENG": 2095000, "SUMATRA": 2111000, "KALIMANTAN": 2342000, "SULAWESI": 2358000, "PALMAL": 2717000 },
                    0.512: { "JABODETABEK": 2193000, "JATIM & BALNUS": 2369000, "JABAR & JATENG": 2589000, "SUMATRA": 2612000, "KALIMANTAN": 2899000, "SULAWESI": 2917000, "PALMAL": 3362000 },
                    1: { "JABODETABEK": 3366000, "JATIM & BALNUS": 3640000, "JABAR & JATENG": 3971000, "SUMATRA": 4011000, "KALIMANTAN": 4447000, "SULAWESI": 4480000, "PALMAL": 5160000 },
                    2: { "JABODETABEK": 6150000, "JATIM & BALNUS": 6646000, "JABAR & JATENG": 7263000, "SUMATRA": 7325000, "KALIMANTAN": 8125000, "SULAWESI": 8187000, "PALMAL": 9431000 },
                    3: { "JABODETABEK": 6517000, "JATIM & BALNUS": 7044000, "JABAR & JATENG": 7693000, "SUMATRA": 7759000, "KALIMANTAN": 8606000, "SULAWESI": 8669000, "PALMAL": 9994000 },
                    4: { "JABODETABEK": 6937000, "JATIM & BALNUS": 7494000, "JABAR & JATENG": 8187000, "SUMATRA": 8262000, "KALIMANTAN": 9163000, "SULAWESI": 9234000, "PALMAL": 10637000 },
                    5: { "JABODETABEK": 7308000, "JATIM & BALNUS": 7896000, "JABAR & JATENG": 8624000, "SUMATRA": 8700000, "KALIMANTAN": 9654000, "SULAWESI": 9728000, "PALMAL": 11206000 },
                    6: { "JABODETABEK": 7674000, "JATIM & BALNUS": 8293000, "JABAR & JATENG": 9057000, "SUMATRA": 9132000, "KALIMANTAN": 10134000, "SULAWESI": 10209000, "PALMAL": 11765000 },
                    7: { "JABODETABEK": 8045000, "JATIM & BALNUS": 8695000, "JABAR & JATENG": 9499000, "SUMATRA": 9578000, "KALIMANTAN": 10625000, "SULAWESI": 10705000, "PALMAL": 12333000 },
                    8: { "JABODETABEK": 8465000, "JATIM & BALNUS": 9146000, "JABAR & JATENG": 9993000, "SUMATRA": 10077000, "KALIMANTAN": 11182000, "SULAWESI": 11260000, "PALMAL": 12980000 },
                    9: { "JABODETABEK": 9251000, "JATIM & BALNUS": 9993000, "JABAR & JATENG": 10921000, "SUMATRA": 11013000, "KALIMANTAN": 12210000, "SULAWESI": 12303000, "PALMAL": 14181000 },
                    10: { "JABODETABEK": 10090000, "JATIM & BALNUS": 10903000, "JABAR & JATENG": 11910000, "SUMATRA": 12015000, "KALIMANTAN": 13322000, "SULAWESI": 13424000, "PALMAL": 15471000 },
                    20: { "JABODETABEK": 14187000, "JATIM & BALNUS": 15327000, "JABAR & JATENG": 16749000, "SUMATRA": 16890000, "KALIMANTAN": 18731000, "SULAWESI": 18877000, "PALMAL": 21755000 },
                    30: { "JABODETABEK": 18391000, "JATIM & BALNUS": 19866000, "JABAR & JATENG": 21707000, "SUMATRA": 21892000, "KALIMANTAN": 24278000, "SULAWESI": 24463000, "PALMAL": 28200000 },
                    40: { "JABODETABEK": 22494000, "JATIM & BALNUS": 24296000, "JABAR & JATENG": 26543000, "SUMATRA": 26768000, "KALIMANTAN": 29697000, "SULAWESI": 29916000, "PALMAL": 34487000 },
                    50: { "JABODETABEK": 25491000, "JATIM & BALNUS": 27532000, "JABAR & JATENG": 30083000, "SUMATRA": 30336000, "KALIMANTAN": 33652000, "SULAWESI": 33903000, "PALMAL": 39083000 },
                    60: { "JABODETABEK": 27222000, "JATIM & BALNUS": 29404000, "JABAR & JATENG": 32124000, "SUMATRA": 32393000, "KALIMANTAN": 35930000, "SULAWESI": 36203000, "PALMAL": 41738000 },
                    70: { "JABODETABEK": 28900000, "JATIM & BALNUS": 31215000, "JABAR & JATENG": 34107000, "SUMATRA": 34398000, "KALIMANTAN": 38152000, "SULAWESI": 38443000, "PALMAL": 44314000 },
                    80: { "JABODETABEK": 30640000, "JATIM & BALNUS": 33096000, "JABAR & JATENG": 36161000, "SUMATRA": 36466000, "KALIMANTAN": 40444000, "SULAWESI": 40753000, "PALMAL": 46979000 },
                    90: { "JABODETABEK": 32371000, "JATIM & BALNUS": 34958000, "JABAR & JATENG": 38199000, "SUMATRA": 38522000, "KALIMANTAN": 42730000, "SULAWESI": 43053000, "PALMAL": 49632000 },
                    100: { "JABODETABEK": 34054000, "JATIM & BALNUS": 36779000, "JABAR & JATENG": 40183000, "SUMATRA": 40523000, "KALIMANTAN": 44952000, "SULAWESI": 45293000, "PALMAL": 52213000 },
                    200: { "JABODETABEK": 48867000, "JATIM & BALNUS": 52785000, "JABAR & JATENG": 57668000, "SUMATRA": 58154000, "KALIMANTAN": 64508000, "SULAWESI": 64998000, "PALMAL": 74930000 },
                    300: { "JABODETABEK": 59483000, "JATIM & BALNUS": 64243000, "JABAR & JATENG": 70191000, "SUMATRA": 70792000, "KALIMANTAN": 78523000, "SULAWESI": 79119000, "PALMAL": 91207000 },
                    400: { "JABODETABEK": 69105000, "JATIM & BALNUS": 74638000, "JABAR & JATENG": 81549000, "SUMATRA": 82233000, "KALIMANTAN": 91214000, "SULAWESI": 91908000, "PALMAL": 105957000 },
                    500: { "JABODETABEK": 78770000, "JATIM & BALNUS": 85076000, "JABAR & JATENG": 92954000, "SUMATRA": 93740000, "KALIMANTAN": 103979000, "SULAWESI": 104765000, "PALMAL": 120781000 },
                    600: { "JABODETABEK": 88440000, "JATIM & BALNUS": 95519000, "JABAR & JATENG": 104364000, "SUMATRA": 105248000, "KALIMANTAN": 116741000, "SULAWESI": 117624000, "PALMAL": 135605000 },
                    700: { "JABODETABEK": 96476000, "JATIM & BALNUS": 104195000, "JABAR & JATENG": 113847000, "SUMATRA": 114810000, "KALIMANTAN": 127346000, "SULAWESI": 128313000, "PALMAL": 147927000 },
                    800: { "JABODETABEK": 104146000, "JATIM & BALNUS": 112479000, "JABAR & JATENG": 122895000, "SUMATRA": 123937000, "KALIMANTAN": 137479000, "SULAWESI": 138518000, "PALMAL": 159691000 },
                    900: { "JABODETABEK": 111768000, "JATIM & BALNUS": 120714000, "JABAR & JATENG": 131890000, "SUMATRA": 133012000, "KALIMANTAN": 147539000, "SULAWESI": 148656000, "PALMAL": 171378000 },
                    1000: { "JABODETABEK": 119442000, "JATIM & BALNUS": 128998000, "JABAR & JATENG": 140942000, "SUMATRA": 142135000, "KALIMANTAN": 157664000, "SULAWESI": 158857000, "PALMAL": 183142000 }
                }
            }
        };

        const VPN_IP_COS_OPTIONS = ["Best Effort", "Critical", "Interactive"];
        const VPN_IP_TYPE_OPTIONS = ["Standard", "Dual Homing"];

        const VPN_IP_LOCATION_OPTIONS = [
            "JABODETABEK", "JATIM & BALNUS", "JABAR & JATENG", "SUMATRA", "KALIMANTAN", "SULAWESI", "PALMAL"
        ];
        const VPN_IP_BANDWIDTH_OPTIONS = [
            { value: 0.032, label: "32 Kbps" },
            { value: 0.064, label: "64 Kbps" },
            { value: 0.128, label: "128 Kbps" },
            { value: 0.256, label: "256 Kbps" },
            { value: 0.512, label: "512 Kbps" },
            { value: 1, label: "1 Mbps" },
            { value: 2, label: "2 Mbps" },
            { value: 3, label: "3 Mbps" },
            { value: 4, label: "4 Mbps" },
            { value: 5, label: "5 Mbps" },
            { value: 6, label: "6 Mbps" },
            { value: 7, label: "7 Mbps" },
            { value: 8, label: "8 Mbps" },
            { value: 9, label: "9 Mbps" },
            { value: 10, label: "10 Mbps" },
            { value: 20, label: "20 Mbps" },
            { value: 30, label: "30 Mbps" },
            { value: 40, label: "40 Mbps" },
            { value: 50, label: "50 Mbps" },
            { value: 60, label: "60 Mbps" },
            { value: 70, label: "70 Mbps" },
            { value: 80, label: "80 Mbps" },
            { value: 90, label: "90 Mbps" },
            { value: 100, label: "100 Mbps" },
            { value: 200, label: "200 Mbps" },
            { value: 300, label: "300 Mbps" },
            { value: 400, label: "400 Mbps" },
            { value: 500, label: "500 Mbps" },
            { value: 600, label: "600 Mbps" },
            { value: 700, label: "700 Mbps" },
            { value: 800, label: "800 Mbps" },
            { value: 900, label: "900 Mbps" },
            { value: 1000, label: "1 Gbps" }
        ];

        const IP_TRANSIT_NEUCENTRIX_BANDWIDTH_OPTIONS = [
            100, 200, 300, 400, 500, 600, 700, 800, 900, 1000
        ].map(n => n + " Mbps");

        const LOCATION_OPTIONS = [
            "JaBoDeTaBek",
            "Jawa",
            "Sumatera",
            "Kalimantan & KTI",
            "NTT",
            "Sulawesi Selatan"
        ];

        const METRO_ZONE_OPTIONS = [
            "Jabodetabek",
            "Jabar Jateng",
            "Jatim Bali",
            "Sumatra",
            "Kalimantan",
            "Sulawesi",
            "Papua Maluku",
            "NTT",
            "Sulawesi Selatan"
        ];

        const IP_TRANSIT_BB_ZONE_OPTIONS = [
            "JaBoDeTaBek",
            "Jawa",
            "Sumatera",
            "Kalimantan & KTI"
        ];

        const IP_TRANSIT_STD_ZONE_OPTIONS = [
            "JaBoDeTaBek",
            "Jawa",
            "Sumatera",
            "Kalimantan & KTI",
            "NTT",
            "Sulawesi Selatan"
        ];

        const AM_NAMES = [
            "Amalia Husna Tsabitah",
            "Andri",
            "Dwi Iriani",
            "Firda Duana Monardi",
            "Firman Amrullah",
            "Firra Monicha Mukhneri",
            "Ika Mufliha",
            "Mohamad Helmi Riyandanu",
            "Rosdiana",
            "Sabda Mochamad Firdi Toekan",
            "Sabila Amni",
            "Tika Zelfiana",
            "Yosy Agustia"
        ];

        const ASTINET_PRICING = {
            1: { "JaBoDeTaBek": 125000, "Jawa": 143000, "Sumatera": 152000, "Kalimantan & KTI": 155000, "NTT": 269000 },
            2: { "JaBoDeTaBek": 243000, "Jawa": 273000, "Sumatera": 291000, "Kalimantan & KTI": 316000, "NTT": 521000 },
            3: { "JaBoDeTaBek": 351000, "Jawa": 394000, "Sumatera": 423000, "Kalimantan & KTI": 456000, "NTT": 750000 },
            4: { "JaBoDeTaBek": 453000, "Jawa": 509000, "Sumatera": 546000, "Kalimantan & KTI": 591000, "NTT": 972000 },
            5: { "JaBoDeTaBek": 548000, "Jawa": 615000, "Sumatera": 658000, "Kalimantan & KTI": 714000, "NTT": 1176000 },
            6: { "JaBoDeTaBek": 634000, "Jawa": 712000, "Sumatera": 761000, "Kalimantan & KTI": 825000, "NTT": 1357000 },
            7: { "JaBoDeTaBek": 712000, "Jawa": 799000, "Sumatera": 855000, "Kalimantan & KTI": 926000, "NTT": 1524000 },
            8: { "JaBoDeTaBek": 785000, "Jawa": 881000, "Sumatera": 944000, "Kalimantan & KTI": 1021000, "NTT": 1683000 },
            9: { "JaBoDeTaBek": 847000, "Jawa": 950000, "Sumatera": 1018000, "Kalimantan & KTI": 1104000, "NTT": 1818000 },
            10: { "JaBoDeTaBek": 904000, "Jawa": 1013000, "Sumatera": 1085000, "Kalimantan & KTI": 1176000, "NTT": 1937000 },
            20: { "JaBoDeTaBek": 1752000, "Jawa": 1963000, "Sumatera": 2104000, "Kalimantan & KTI": 2278000, "NTT": 3752000 },
            50: { "JaBoDeTaBek": 3409000, "Jawa": 3820000, "Sumatera": 4092000, "Kalimantan & KTI": 4434000, "NTT": 7302000 },
            100: { "JaBoDeTaBek": 5531000, "Jawa": 6195000, "Sumatera": 6638000, "Kalimantan & KTI": 7190000, "NTT": 13900000 },
            200: { "JaBoDeTaBek": 10728000, "Jawa": 12017000, "Sumatera": 12875000, "Kalimantan & KTI": 13948000 },
            300: { "NTT": 40547500 },
            500: { "JaBoDeTaBek": 23982000, "Jawa": 26860000, "Sumatera": 28779000, "Kalimantan & KTI": 31177000, "NTT": 64200000 },
            1000: { "JaBoDeTaBek": 35715000, "Jawa": 40001000, "Sumatera": 42862000, "Kalimantan & KTI": 46427000, "NTT": 112208500 }
        };

        const METRO_JABO_PRICING = {
            1: { be: 439000, int: 506000 },
            2: { be: 558000, int: 644000 },
            3: { be: 658000, int: 759000 },
            4: { be: 758000, int: 873000 },
            5: { be: 858000, int: 987000 },
            6: { be: 886000, int: 1020000 },
            7: { be: 934000, int: 1073000 },
            8: { be: 977000, int: 1125000 },
            9: { be: 1058000, int: 1216000 },
            10: { be: 1139000, int: 1316000 },
            20: { be: 1567000, int: 1806000 },
            30: { be: 2005000, int: 2310000 },
            40: { be: 2434000, int: 2806000 },
            50: { be: 2748000, int: 3168000 },
            60: { be: 2924000, int: 3372000 },
            70: { be: 3105000, int: 3582000 },
            80: { be: 3281000, int: 3782000 },
            90: { be: 3457000, int: 3986000 },
            100: { be: 3643000, int: 4196000 },
            200: { be: 5167000, int: 5958000 },
            300: { be: 6286000, int: 7244000 },
            400: { be: 7291000, int: 8401000 },
            500: { be: 8295000, int: 9557000 },
            600: { be: 9300000, int: 10715000 },
            700: { be: 10143000, int: 11686000 },
            800: { be: 10938000, int: 12605000 },
            900: { be: 11733000, int: 13519000 },
            1000: { be: 12528000, int: 14438000 },
            2000: { be: 24095000, int: 27762000 },
            3000: { be: 34794000, int: 40085000 },
            4000: { be: 44617000, int: 51408000 },
            5000: { be: 53569000, int: 61722000 },
            6000: { be: 61655000, int: 71036000 },
            7000: { be: 68873000, int: 79349000 },
            8000: { be: 75206000, int: 86654000 },
            9000: { be: 80682000, int: 92963000 },
            10000: { be: 85282000, int: 98263000 }
        };

        const METRO_JABAR_JATENG_PRICING = {
            1: { intra: { be: 517000, int: 615000 }, inter: { be: 903000, int: 1094000 } },
            2: { intra: { be: 657000, int: 783000 }, inter: { be: 1148000, int: 1392000 } },
            3: { intra: { be: 775000, int: 922000 }, inter: { be: 1354000, int: 1641000 } },
            4: { intra: { be: 893000, int: 1061000 }, inter: { be: 1560000, int: 1887000 } },
            5: { intra: { be: 1011000, int: 1199000 }, inter: { be: 1765000, int: 2134000 } },
            6: { intra: { be: 1044000, int: 1239000 }, inter: { be: 1823000, int: 2205000 } },
            7: { intra: { be: 1100000, int: 1303000 }, inter: { be: 1922000, int: 2319000 } },
            8: { intra: { be: 1151000, int: 1367000 }, inter: { be: 2010000, int: 2432000 } },
            9: { intra: { be: 1246000, int: 1477000 }, inter: { be: 2177000, int: 2628000 } },
            10: { intra: { be: 1342000, int: 1599000 }, inter: { be: 2343000, int: 2845000 } },
            20: { intra: { be: 1845000, int: 2194000 }, inter: { be: 3224000, int: 3904000 } },
            30: { intra: { be: 2361000, int: 2806000 }, inter: { be: 4125000, int: 4993000 } },
            40: { intra: { be: 2866000, int: 3408000 }, inter: { be: 5007000, int: 6065000 } },
            50: { intra: { be: 3236000, int: 3848000 }, inter: { be: 5653000, int: 6847000 } },
            60: { intra: { be: 3443000, int: 4095000 }, inter: { be: 6015000, int: 7288000 } },
            70: { intra: { be: 3656000, int: 4350000 }, inter: { be: 6387000, int: 7742000 } },
            80: { intra: { be: 3864000, int: 4593000 }, inter: { be: 6749000, int: 8174000 } },
            90: { intra: { be: 4071000, int: 4841000 }, inter: { be: 7111000, int: 8615000 } },
            100: { intra: { be: 4290000, int: 5096000 }, inter: { be: 7494000, int: 9069000 } },
            200: { intra: { be: 6084000, int: 7236000 }, inter: { be: 10628000, int: 12877000 } },
            300: { intra: { be: 7402000, int: 8797000 }, inter: { be: 12930000, int: 15656000 } },
            400: { intra: { be: 8585000, int: 10202000 }, inter: { be: 14997000, int: 18156000 } },
            500: { intra: { be: 9767000, int: 11606000 }, inter: { be: 17062000, int: 20655000 } },
            600: { intra: { be: 10950000, int: 13012000 }, inter: { be: 19130000, int: 23157000 } },
            700: { intra: { be: 11943000, int: 14191000 }, inter: { be: 20864000, int: 25256000 } },
            800: { intra: { be: 12879000, int: 15307000 }, inter: { be: 22499000, int: 27242000 } },
            900: { intra: { be: 13815000, int: 16417000 }, inter: { be: 24134000, int: 29217000 } },
            1000: { intra: { be: 14751000, int: 17533000 }, inter: { be: 25769000, int: 31203000 } },
            2000: { intra: { be: 28370000, int: 33713000 }, inter: { be: 49561000, int: 59998000 } },
            3000: { intra: { be: 40967000, int: 48678000 }, inter: { be: 71568000, int: 86630000 } },
            4000: { intra: { be: 52533000, int: 62428000 }, inter: { be: 91773000, int: 111100000 } },
            5000: { intra: { be: 63073000, int: 74953000 }, inter: { be: 110186000, int: 133390000 } },
            6000: { intra: { be: 72594000, int: 86263000 }, inter: { be: 126818000, int: 153519000 } },
            7000: { intra: { be: 81092000, int: 96358000 }, inter: { be: 141665000, int: 171485000 } },
            8000: { intra: { be: 88549000, int: 105229000 }, inter: { be: 154691000, int: 187272000 } },
            9000: { intra: { be: 94996000, int: 112890000 }, inter: { be: 165955000, int: 200906000 } },
            10000: { intra: { be: 100412000, int: 119326000 }, inter: { be: 175416000, int: 212361000 } }
        };

        const METRO_SUMATRA_PRICING = {
            1: { intra: { be: 584000, int: 698000 }, inter: { be: 1078000, int: 1304000 } },
            2: { intra: { be: 742000, int: 888000 }, inter: { be: 1371000, int: 1660000 } },
            3: { intra: { be: 875000, int: 1047000 }, inter: { be: 1616000, int: 1956000 } },
            4: { intra: { be: 1008000, int: 1204000 }, inter: { be: 1862000, int: 2250000 } },
            5: { intra: { be: 1141000, int: 1361000 }, inter: { be: 2107000, int: 2544000 } },
            6: { intra: { be: 1178000, int: 1407000 }, inter: { be: 2176000, int: 2629000 } },
            7: { intra: { be: 1242000, int: 1480000 }, inter: { be: 2294000, int: 2765000 } },
            8: { intra: { be: 1299000, int: 1551000 }, inter: { be: 2400000, int: 2899000 } },
            9: { intra: { be: 1407000, int: 1677000 }, inter: { be: 2598000, int: 3134000 } },
            10: { intra: { be: 1514000, int: 1815000 }, inter: { be: 2797000, int: 3392000 } },
            20: { intra: { be: 2083000, int: 2490000 }, inter: { be: 3848000, int: 4654000 } },
            30: { intra: { be: 2665000, int: 3185000 }, inter: { be: 4924000, int: 5953000 } },
            40: { intra: { be: 3236000, int: 3868000 }, inter: { be: 5977000, int: 7231000 } },
            50: { intra: { be: 3653000, int: 4367000 }, inter: { be: 6748000, int: 8164000 } },
            60: { intra: { be: 3887000, int: 4649000 }, inter: { be: 7181000, int: 8690000 } },
            70: { intra: { be: 4127000, int: 4938000 }, inter: { be: 7625000, int: 9231000 } },
            80: { intra: { be: 4361000, int: 5214000 }, inter: { be: 8057000, int: 9746000 } },
            90: { intra: { be: 4595000, int: 5495000 }, inter: { be: 8489000, int: 10272000 } },
            100: { intra: { be: 4843000, int: 5784000 }, inter: { be: 8946000, int: 10813000 } },
            200: { intra: { be: 6868000, int: 8213000 }, inter: { be: 12688000, int: 15354000 } },
            300: { intra: { be: 8355000, int: 9986000 }, inter: { be: 15436000, int: 18667000 } },
            400: { intra: { be: 9691000, int: 11581000 }, inter: { be: 17904000, int: 21649000 } },
            500: { intra: { be: 11026000, int: 13174000 }, inter: { be: 20369000, int: 24628000 } },
            600: { intra: { be: 12361000, int: 14771000 }, inter: { be: 22837000, int: 27612000 } },
            700: { intra: { be: 13482000, int: 16109000 }, inter: { be: 24907000, int: 30114000 } },
            800: { intra: { be: 14539000, int: 17376000 }, inter: { be: 26859000, int: 32482000 } },
            900: { intra: { be: 15595000, int: 18636000 }, inter: { be: 28812000, int: 34837000 } },
            1000: { intra: { be: 16652000, int: 19903000 }, inter: { be: 30764000, int: 37206000 } },
            2000: { intra: { be: 32026000, int: 38269000 }, inter: { be: 59167000, int: 71540000 } },
            3000: { intra: { be: 46246000, int: 55256000 }, inter: { be: 85439000, int: 103295000 } },
            4000: { intra: { be: 59302000, int: 70864000 }, inter: { be: 109560000, int: 132473000 } },
            5000: { intra: { be: 71201000, int: 85081000 }, inter: { be: 131543000, int: 159051000 } },
            6000: { intra: { be: 81948000, int: 97920000 }, inter: { be: 151398000, int: 183052000 } },
            7000: { intra: { be: 91542000, int: 109379000 }, inter: { be: 169122000, int: 204474000 } },
            8000: { intra: { be: 99959000, int: 119449000 }, inter: { be: 184674000, int: 223298000 } },
            9000: { intra: { be: 107238000, int: 128145000 }, inter: { be: 198120000, int: 239555000 } },
            10000: { intra: { be: 113352000, int: 135451000 }, inter: { be: 209416000, int: 253213000 } }
        };

        const METRO_SULAWESI_PRICING = {
            1: { intra: { be: 763000, int: 914000 }, inter: { be: 1110000, int: 1357000 } },
            2: { intra: { be: 970000, int: 1163000 }, inter: { be: 1411000, int: 1727000 } },
            3: { intra: { be: 1144000, int: 1370000 }, inter: { be: 1664000, int: 2036000 } },
            4: { intra: { be: 1317000, int: 1576000 }, inter: { be: 1917000, int: 2341000 } },
            5: { intra: { be: 1491000, int: 1782000 }, inter: { be: 2170000, int: 2647000 } },
            6: { intra: { be: 1540000, int: 1842000 }, inter: { be: 2241000, int: 2736000 } },
            7: { intra: { be: 1623000, int: 1937000 }, inter: { be: 2362000, int: 2878000 } },
            8: { intra: { be: 1698000, int: 2031000 }, inter: { be: 2471000, int: 3017000 } },
            9: { intra: { be: 1839000, int: 2195000 }, inter: { be: 2676000, int: 3261000 } },
            10: { intra: { be: 1979000, int: 2376000 }, inter: { be: 2880000, int: 3529000 } },
            20: { intra: { be: 2723000, int: 3260000 }, inter: { be: 3962000, int: 4843000 } },
            30: { intra: { be: 3484000, int: 4170000 }, inter: { be: 5070000, int: 6195000 } },
            40: { intra: { be: 4229000, int: 5065000 }, inter: { be: 6155000, int: 7525000 } },
            50: { intra: { be: 4775000, int: 5718000 }, inter: { be: 6949000, int: 8495000 } },
            60: { intra: { be: 5081000, int: 6087000 }, inter: { be: 7394000, int: 9042000 } },
            70: { intra: { be: 5395000, int: 6466000 }, inter: { be: 7851000, int: 9605000 } },
            80: { intra: { be: 5701000, int: 6827000 }, inter: { be: 8296000, int: 10142000 } },
            90: { intra: { be: 6007000, int: 7195000 }, inter: { be: 8741000, int: 10689000 } },
            100: { intra: { be: 6330000, int: 7574000 }, inter: { be: 9211000, int: 11252000 } },
            200: { intra: { be: 8978000, int: 10754000 }, inter: { be: 13065000, int: 15976000 } },
            300: { intra: { be: 10922000, int: 13075000 }, inter: { be: 15894000, int: 19425000 } },
            400: { intra: { be: 12668000, int: 15164000 }, inter: { be: 18435000, int: 22527000 } },
            500: { intra: { be: 14412000, int: 17250000 }, inter: { be: 20974000, int: 25627000 } },
            600: { intra: { be: 16158000, int: 19340000 }, inter: { be: 23515000, int: 28732000 } },
            700: { intra: { be: 17623000, int: 21093000 }, inter: { be: 25646000, int: 31335000 } },
            800: { intra: { be: 19004000, int: 22751000 }, inter: { be: 27656000, int: 33800000 } },
            900: { intra: { be: 20385000, int: 24401000 }, inter: { be: 29666000, int: 36250000 } },
            1000: { intra: { be: 21767000, int: 26060000 }, inter: { be: 31676000, int: 38715000 } },
            2000: { intra: { be: 41863000, int: 50109000 }, inter: { be: 60922000, int: 74442000 } },
            3000: { intra: { be: 60452000, int: 72350000 }, inter: { be: 87974000, int: 107485000 } },
            4000: { intra: { be: 77518000, int: 92787000 }, inter: { be: 112810000, int: 137846000 } },
            5000: { intra: { be: 93071000, int: 111403000 }, inter: { be: 135444000, int: 165502000 } },
            6000: { intra: { be: 107120000, int: 128214000 }, inter: { be: 155889000, int: 190477000 } },
            7000: { intra: { be: 119660000, int: 143219000 }, inter: { be: 174139000, int: 212767000 } },
            8000: { intra: { be: 130663000, int: 156403000 }, inter: { be: 190151000, int: 232355000 } },
            9000: { intra: { be: 140177000, int: 167791000 }, inter: { be: 203997000, int: 249272000 } },
            10000: { intra: { be: 148170000, int: 177357000 }, inter: { be: 215627000, int: 263484000 } }
        };

        const METRO_KALIMANTAN_PRICING = {
            1: { intra: { be: 763000, int: 914000 }, inter: { be: 1110000, int: 1357000 } },
            2: { intra: { be: 970000, int: 1163000 }, inter: { be: 1411000, int: 1727000 } },
            3: { intra: { be: 1144000, int: 1370000 }, inter: { be: 1664000, int: 2036000 } },
            4: { intra: { be: 1317000, int: 1576000 }, inter: { be: 1917000, int: 2341000 } },
            5: { intra: { be: 1491000, int: 1782000 }, inter: { be: 2170000, int: 2647000 } },
            6: { intra: { be: 1540000, int: 1842000 }, inter: { be: 2241000, int: 2736000 } },
            7: { intra: { be: 1623000, int: 1937000 }, inter: { be: 2362000, int: 2878000 } },
            8: { intra: { be: 1698000, int: 2031000 }, inter: { be: 2471000, int: 3017000 } },
            9: { intra: { be: 1839000, int: 2195000 }, inter: { be: 2676000, int: 3261000 } },
            10: { intra: { be: 1979000, int: 2376000 }, inter: { be: 2880000, int: 3529000 } },
            20: { intra: { be: 2723000, int: 3260000 }, inter: { be: 3962000, int: 4843000 } },
            30: { intra: { be: 3484000, int: 4170000 }, inter: { be: 5070000, int: 6195000 } },
            40: { intra: { be: 4229000, int: 5065000 }, inter: { be: 6155000, int: 7525000 } },
            50: { intra: { be: 4775000, int: 5718000 }, inter: { be: 6949000, int: 8495000 } },
            60: { intra: { be: 5081000, int: 6087000 }, inter: { be: 7394000, int: 9042000 } },
            70: { intra: { be: 5395000, int: 6466000 }, inter: { be: 7851000, int: 9605000 } },
            80: { intra: { be: 5701000, int: 6827000 }, inter: { be: 8296000, int: 10142000 } },
            90: { intra: { be: 6007000, int: 7195000 }, inter: { be: 8741000, int: 10689000 } },
            100: { intra: { be: 6330000, int: 7574000 }, inter: { be: 9211000, int: 11252000 } },
            200: { intra: { be: 8978000, int: 10754000 }, inter: { be: 13065000, int: 15976000 } },
            300: { intra: { be: 10922000, int: 13075000 }, inter: { be: 15894000, int: 19425000 } },
            400: { intra: { be: 12668000, int: 15164000 }, inter: { be: 18435000, int: 22527000 } },
            500: { intra: { be: 14412000, int: 17250000 }, inter: { be: 20974000, int: 25627000 } },
            600: { intra: { be: 16158000, int: 19340000 }, inter: { be: 23515000, int: 28732000 } },
            700: { intra: { be: 17623000, int: 21093000 }, inter: { be: 25646000, int: 31335000 } },
            800: { intra: { be: 19004000, int: 22751000 }, inter: { be: 27656000, int: 33800000 } },
            900: { intra: { be: 20385000, int: 24401000 }, inter: { be: 29666000, int: 36250000 } },
            1000: { intra: { be: 21767000, int: 26060000 }, inter: { be: 31676000, int: 38715000 } },
            2000: { intra: { be: 41863000, int: 50109000 }, inter: { be: 60922000, int: 74442000 } },
            3000: { intra: { be: 60452000, int: 72350000 }, inter: { be: 87974000, int: 107485000 } },
            4000: { intra: { be: 77518000, int: 92787000 }, inter: { be: 112810000, int: 137846000 } },
            5000: { intra: { be: 93071000, int: 111403000 }, inter: { be: 135444000, int: 165502000 } },
            6000: { intra: { be: 107120000, int: 128214000 }, inter: { be: 155889000, int: 190477000 } },
            7000: { intra: { be: 119660000, int: 143219000 }, inter: { be: 174139000, int: 212767000 } },
            8000: { intra: { be: 130663000, int: 156403000 }, inter: { be: 190151000, int: 232355000 } },
            9000: { intra: { be: 140177000, int: 167791000 }, inter: { be: 203997000, int: 249272000 } },
            10000: { intra: { be: 148170000, int: 177357000 }, inter: { be: 215627000, int: 263484000 } }
        };

        const METRO_PAPUA_MALUKU_PRICING = {
            1: { intra: { be: 931000, int: 1053000 }, inter: { be: 1326000, int: 1570000 } },
            2: { intra: { be: 1183000, int: 1340000 }, inter: { be: 1686000, int: 2010000 } },
            3: { intra: { be: 1395000, int: 1579000 }, inter: { be: 1988000, int: 2369000 } },
            4: { intra: { be: 1607000, int: 1816000 }, inter: { be: 2290000, int: 2724000 } },
            5: { intra: { be: 1819000, int: 2053000 }, inter: { be: 2592000, int: 3080000 } },
            6: { intra: { be: 1879000, int: 2122000 }, inter: { be: 2676000, int: 3183000 } },
            7: { intra: { be: 1981000, int: 2232000 }, inter: { be: 2821000, int: 3348000 } },
            8: { intra: { be: 2072000, int: 2340000 }, inter: { be: 2951000, int: 3510000 } },
            9: { intra: { be: 2243000, int: 2530000 }, inter: { be: 3196000, int: 3794000 } },
            10: { intra: { be: 2415000, int: 2738000 }, inter: { be: 3440000, int: 4106000 } },
            20: { intra: { be: 3323000, int: 3757000 }, inter: { be: 4733000, int: 5635000 } },
            30: { intra: { be: 4251000, int: 4805000 }, inter: { be: 6056000, int: 7208000 } },
            40: { intra: { be: 5161000, int: 5837000 }, inter: { be: 7351000, int: 8755000 } },
            50: { intra: { be: 5826000, int: 6590000 }, inter: { be: 8299000, int: 9885000 } },
            60: { intra: { be: 6199000, int: 7014000 }, inter: { be: 8831000, int: 10521000 } },
            70: { intra: { be: 6583000, int: 7451000 }, inter: { be: 9378000, int: 11176000 } },
            80: { intra: { be: 6956000, int: 7867000 }, inter: { be: 9909000, int: 11800000 } },
            90: { intra: { be: 7329000, int: 8291000 }, inter: { be: 10441000, int: 12437000 } },
            100: { intra: { be: 7724000, int: 8728000 }, inter: { be: 11002000, int: 13092000 } },
            200: { intra: { be: 10955000, int: 12393000 }, inter: { be: 15605000, int: 18589000 } },
            300: { intra: { be: 13327000, int: 15068000 }, inter: { be: 18984000, int: 22602000 } },
            400: { intra: { be: 15457000, int: 17475000 }, inter: { be: 22019000, int: 26212000 } },
            500: { intra: { be: 17586000, int: 19879000 }, inter: { be: 25051000, int: 29818000 } },
            600: { intra: { be: 19716000, int: 22288000 }, inter: { be: 28086000, int: 33431000 } },
            700: { intra: { be: 21504000, int: 24307000 }, inter: { be: 30632000, int: 36461000 } },
            800: { intra: { be: 23189000, int: 26219000 }, inter: { be: 33033000, int: 39328000 } },
            900: { intra: { be: 24874000, int: 28120000 }, inter: { be: 35434000, int: 42180000 } },
            1000: { intra: { be: 26560000, int: 30032000 }, inter: { be: 37835000, int: 45047000 } },
            2000: { intra: { be: 51082000, int: 57745000 }, inter: { be: 72767000, int: 86618000 } },
            3000: { intra: { be: 73764000, int: 83377000 }, inter: { be: 105078000, int: 125066000 } },
            4000: { intra: { be: 94589000, int: 106929000 }, inter: { be: 134744000, int: 160393000 } },
            5000: { intra: { be: 113567000, int: 128382000 }, inter: { be: 161779000, int: 192573000 } },
            6000: { intra: { be: 130709000, int: 147755000 }, inter: { be: 186199000, int: 221633000 } },
            7000: { intra: { be: 146011000, int: 165046000 }, inter: { be: 207997000, int: 247569000 } },
            8000: { intra: { be: 159437000, int: 180241000 }, inter: { be: 227123000, int: 270361000 } },
            9000: { intra: { be: 171046000, int: 193364000 }, inter: { be: 243660000, int: 290045000 } },
            10000: { intra: { be: 180798000, int: 204388000 }, inter: { be: 257552000, int: 306581000 } }
        };

        const METRO_NUSA_TENGGARA_PRICING = {
            1: { intra: { be: 1110000, int: 1240000 }, inter: { be: 2890000, int: 3220000 } },
            2: { intra: { be: 1410000, int: 1580000 }, inter: { be: 3670000, int: 4090000 } },
            3: { intra: { be: 1670000, int: 1860000 }, inter: { be: 4340000, int: 4830000 } },
            4: { intra: { be: 1910000, int: 2140000 }, inter: { be: 4970000, int: 5540000 } },
            5: { intra: { be: 2170000, int: 2420000 }, inter: { be: 5640000, int: 6290000 } },
            6: { intra: { be: 2240000, int: 2500000 }, inter: { be: 5820000, int: 6480000 } },
            7: { intra: { be: 2360000, int: 2640000 }, inter: { be: 6140000, int: 6840000 } },
            8: { intra: { be: 2470000, int: 2760000 }, inter: { be: 6420000, int: 7150000 } },
            9: { intra: { be: 2670000, int: 2980000 }, inter: { be: 6950000, int: 7740000 } },
            10: { intra: { be: 2890000, int: 3230000 }, inter: { be: 7510000, int: 8370000 } },
            20: { intra: { be: 3970000, int: 4440000 }, inter: { be: 10330000, int: 11510000 } },
            30: { intra: { be: 5080000, int: 5680000 }, inter: { be: 13220000, int: 14730000 } },
            40: { intra: { be: 6160000, int: 6890000 }, inter: { be: 16040000, int: 17870000 } },
            50: { intra: { be: 6960000, int: 7780000 }, inter: { be: 18120000, int: 20190000 } },
            60: { intra: { be: 7410000, int: 8280000 }, inter: { be: 19280000, int: 21480000 } },
            70: { intra: { be: 7870000, int: 8790000 }, inter: { be: 20480000, int: 22820000 } },
            80: { intra: { be: 8320000, int: 9290000 }, inter: { be: 21640000, int: 24120000 } },
            90: { intra: { be: 8760000, int: 9790000 }, inter: { be: 22810000, int: 25410000 } },
            100: { intra: { be: 9220000, int: 10300000 }, inter: { be: 24010000, int: 26750000 } },
            200: { intra: { be: 13090000, int: 14630000 }, inter: { be: 34090000, int: 37980000 } },
            300: { intra: { be: 15920000, int: 17790000 }, inter: { be: 41450000, int: 46180000 } },
            400: { intra: { be: 18470000, int: 20630000 }, inter: { be: 48080000, int: 53570000 } },
            500: { intra: { be: 21010000, int: 23470000 }, inter: { be: 54700000, int: 60950000 } },
            600: { intra: { be: 23560000, int: 26320000 }, inter: { be: 61330000, int: 68330000 } },
            700: { intra: { be: 25700000, int: 28710000 }, inter: { be: 66900000, int: 74540000 } },
            800: { intra: { be: 27710000, int: 30960000 }, inter: { be: 72150000, int: 80390000 } },
            900: { intra: { be: 29730000, int: 33210000 }, inter: { be: 77400000, int: 86240000 } },
            1000: { intra: { be: 31750000, int: 35470000 }, inter: { be: 82650000, int: 92090000 } },
            2000: { intra: { be: 61280000, int: 68460000 }, inter: { be: 159520000, int: 177740000 } },
            3000: { intra: { be: 88590000, int: 98970000 }, inter: { be: 230600000, int: 256940000 } },
            4000: { intra: { be: 113670000, int: 126990000 }, inter: { be: 295890000, int: 329690000 } },
            5000: { intra: { be: 136530000, int: 152530000 }, inter: { be: 355400000, int: 395990000 } },
            6000: { intra: { be: 157170000, int: 175580000 }, inter: { be: 409120000, int: 455850000 } },
            7000: { intra: { be: 175580000, int: 196150000 }, inter: { be: 457060000, int: 509260000 } },
            8000: { intra: { be: 191770000, int: 214240000 }, inter: { be: 499210000, int: 556230000 } },
            9000: { intra: { be: 205740000, int: 229850000 }, inter: { be: 535580000, int: 596750000 } },
            10000: { intra: { be: 217490000, int: 242970000 }, inter: { be: 566160000, int: 630820000 } }
        };

        const METRO_NEUCENTRIX_JABODETABEK_PRICING = {
            1: { intra: { be: 352000, int: 405000 }, inter: { be: 352000, int: 405000 } },
            2: { intra: { be: 447000, int: 516000 }, inter: { be: 447000, int: 516000 } },
            3: { intra: { be: 527000, int: 608000 }, inter: { be: 527000, int: 608000 } },
            4: { intra: { be: 607000, int: 699000 }, inter: { be: 607000, int: 699000 } },
            5: { intra: { be: 687000, int: 790000 }, inter: { be: 687000, int: 790000 } },
            6: { intra: { be: 709000, int: 816000 }, inter: { be: 709000, int: 816000 } },
            7: { intra: { be: 748000, int: 859000 }, inter: { be: 748000, int: 859000 } },
            8: { intra: { be: 782000, int: 900000 }, inter: { be: 782000, int: 900000 } },
            9: { intra: { be: 847000, int: 973000 }, inter: { be: 847000, int: 973000 } },
            10: { intra: { be: 912000, int: 1053000 }, inter: { be: 912000, int: 1053000 } },
            20: { intra: { be: 1254000, int: 1445000 }, inter: { be: 1254000, int: 1445000 } },
            30: { intra: { be: 1604000, int: 1848000 }, inter: { be: 1604000, int: 1848000 } },
            40: { intra: { be: 1948000, int: 2245000 }, inter: { be: 1948000, int: 2245000 } },
            50: { intra: { be: 2199000, int: 2535000 }, inter: { be: 2199000, int: 2535000 } },
            60: { intra: { be: 2340000, int: 2698000 }, inter: { be: 2340000, int: 2698000 } },
            70: { intra: { be: 2484000, int: 2866000 }, inter: { be: 2484000, int: 2866000 } },
            80: { intra: { be: 2625000, int: 3026000 }, inter: { be: 2625000, int: 3026000 } },
            90: { intra: { be: 2766000, int: 3189000 }, inter: { be: 2766000, int: 3189000 } },
            100: { intra: { be: 2915000, int: 3357000 }, inter: { be: 2915000, int: 3357000 } },
            200: { intra: { be: 4134000, int: 4767000 }, inter: { be: 4134000, int: 4767000 } },
            300: { intra: { be: 5029000, int: 5796000 }, inter: { be: 5029000, int: 5796000 } },
            400: { intra: { be: 5833000, int: 6721000 }, inter: { be: 5833000, int: 6721000 } },
            500: { intra: { be: 6636000, int: 7646000 }, inter: { be: 6636000, int: 7646000 } },
            600: { intra: { be: 7440000, int: 8572000 }, inter: { be: 7440000, int: 8572000 } },
            700: { intra: { be: 8115000, int: 9349000 }, inter: { be: 8115000, int: 9349000 } },
            800: { intra: { be: 8751000, int: 10084000 }, inter: { be: 8751000, int: 10084000 } },
            900: { intra: { be: 9387000, int: 10816000 }, inter: { be: 9387000, int: 10816000 } },
            1000: { intra: { be: 10023000, int: 11551000 }, inter: { be: 10023000, int: 11551000 } },
            2000: { intra: { be: 19276000, int: 22210000 }, inter: { be: 19276000, int: 22210000 } },
            3000: { intra: { be: 27836000, int: 32068000 }, inter: { be: 27836000, int: 32068000 } },
            4000: { intra: { be: 35694000, int: 41127000 }, inter: { be: 35694000, int: 41127000 } },
            5000: { intra: { be: 42856000, int: 49378000 }, inter: { be: 42856000, int: 49378000 } },
            6000: { intra: { be: 49324000, int: 56829000 }, inter: { be: 49324000, int: 56829000 } },
            7000: { intra: { be: 55099000, int: 63480000 }, inter: { be: 55099000, int: 63480000 } },
            8000: { intra: { be: 60165000, int: 69324000 }, inter: { be: 60165000, int: 69324000 } },
            9000: { intra: { be: 64546000, int: 74371000 }, inter: { be: 64546000, int: 74371000 } },
            10000: { intra: { be: 68226000, int: 78611000 }, inter: { be: 68226000, int: 78611000 } }
        };

        const METRO_NEUCENTRIX_JAWA_BALI_PRICING = {
            1: { intra: { be: 414000, int: 492000 }, inter: { be: 723000, int: 876000 } },
            2: { intra: { be: 526000, int: 627000 }, inter: { be: 919000, int: 1114000 } },
            3: { intra: { be: 620000, int: 738000 }, inter: { be: 1084000, int: 1313000 } },
            4: { intra: { be: 715000, int: 849000 }, inter: { be: 1248000, int: 1510000 } },
            5: { intra: { be: 809000, int: 960000 }, inter: { be: 1412000, int: 1708000 } },
            6: { intra: { be: 836000, int: 992000 }, inter: { be: 1459000, int: 1764000 } },
            7: { intra: { be: 880000, int: 1043000 }, inter: { be: 1538000, int: 1856000 } },
            8: { intra: { be: 921000, int: 1094000 }, inter: { be: 1608000, int: 1946000 } },
            9: { intra: { be: 997000, int: 1182000 }, inter: { be: 1742000, int: 2103000 } },
            10: { intra: { be: 1074000, int: 1280000 }, inter: { be: 1875000, int: 2276000 } },
            20: { intra: { be: 1476000, int: 1756000 }, inter: { be: 2580000, int: 3124000 } },
            30: { intra: { be: 1889000, int: 2245000 }, inter: { be: 3300000, int: 3995000 } },
            40: { intra: { be: 2293000, int: 2727000 }, inter: { be: 4006000, int: 4852000 } },
            50: { intra: { be: 2589000, int: 3079000 }, inter: { be: 4523000, int: 5478000 } },
            60: { intra: { be: 2755000, int: 3276000 }, inter: { be: 4812000, int: 5831000 } },
            70: { intra: { be: 2925000, int: 3480000 }, inter: { be: 5110000, int: 6194000 } },
            80: { intra: { be: 3092000, int: 3675000 }, inter: { be: 5400000, int: 6540000 } },
            90: { intra: { be: 3257000, int: 3873000 }, inter: { be: 5689000, int: 6892000 } },
            100: { intra: { be: 3432000, int: 4077000 }, inter: { be: 5996000, int: 7256000 } },
            200: { intra: { be: 4868000, int: 5789000 }, inter: { be: 8503000, int: 10302000 } },
            300: { intra: { be: 5922000, int: 7038000 }, inter: { be: 10344000, int: 12525000 } },
            400: { intra: { be: 6868000, int: 8162000 }, inter: { be: 11998000, int: 14525000 } },
            500: { intra: { be: 7814000, int: 9285000 }, inter: { be: 13650000, int: 16524000 } },
            600: { intra: { be: 8760000, int: 10410000 }, inter: { be: 15304000, int: 18526000 } },
            700: { intra: { be: 9555000, int: 11353000 }, inter: { be: 16692000, int: 20205000 } },
            800: { intra: { be: 10304000, int: 12246000 }, inter: { be: 18000000, int: 21794000 } },
            900: { intra: { be: 11052000, int: 13134000 }, inter: { be: 19308000, int: 23374000 } },
            1000: { intra: { be: 11801000, int: 14027000 }, inter: { be: 20616000, int: 24963000 } },
            2000: { intra: { be: 22696000, int: 26971000 }, inter: { be: 39649000, int: 47999000 } },
            3000: { intra: { be: 32774000, int: 38943000 }, inter: { be: 57255000, int: 69304000 } },
            4000: { intra: { be: 42027000, int: 49943000 }, inter: { be: 73419000, int: 88880000 } },
            5000: { intra: { be: 50459000, int: 59963000 }, inter: { be: 88149000, int: 106712000 } },
            6000: { intra: { be: 58076000, int: 69011000 }, inter: { be: 101455000, int: 122816000 } },
            7000: { intra: { be: 64874000, int: 77087000 }, inter: { be: 113332000, int: 137188000 } },
            8000: { intra: { be: 70840000, int: 84184000 }, inter: { be: 123753000, int: 149818000 } },
            9000: { intra: { be: 75997000, int: 90312000 }, inter: { be: 132764000, int: 160725000 } },
            10000: { intra: { be: 80330000, int: 95461000 }, inter: { be: 140333000, int: 169889000 } }
        };

        const METRO_NEUCENTRIX_SUMATRA_PRICING = {
            1: { intra: { be: 468000, int: 559000 }, inter: { be: 863000, int: 1044000 } },
            2: { intra: { be: 594000, int: 711000 }, inter: { be: 1097000, int: 1328000 } },
            3: { intra: { be: 700000, int: 838000 }, inter: { be: 1293000, int: 1565000 } },
            4: { intra: { be: 807000, int: 964000 }, inter: { be: 1490000, int: 1800000 } },
            5: { intra: { be: 913000, int: 1089000 }, inter: { be: 1686000, int: 2036000 } },
            6: { intra: { be: 943000, int: 1126000 }, inter: { be: 1741000, int: 2104000 } },
            7: { intra: { be: 994000, int: 1184000 }, inter: { be: 1836000, int: 2212000 } },
            8: { intra: { be: 1040000, int: 1241000 }, inter: { be: 1920000, int: 2320000 } },
            9: { intra: { be: 1126000, int: 1342000 }, inter: { be: 2079000, int: 2508000 } },
            10: { intra: { be: 1212000, int: 1452000 }, inter: { be: 2238000, int: 2714000 } },
            20: { intra: { be: 1667000, int: 1992000 }, inter: { be: 3079000, int: 3724000 } },
            30: { intra: { be: 2132000, int: 2548000 }, inter: { be: 3940000, int: 4763000 } },
            40: { intra: { be: 2589000, int: 3095000 }, inter: { be: 4782000, int: 5785000 } },
            50: { intra: { be: 2923000, int: 3494000 }, inter: { be: 5399000, int: 6532000 } },
            60: { intra: { be: 3110000, int: 3720000 }, inter: { be: 5745000, int: 6952000 } },
            70: { intra: { be: 3302000, int: 3951000 }, inter: { be: 6100000, int: 7385000 } },
            80: { intra: { be: 3489000, int: 4172000 }, inter: { be: 6446000, int: 7797000 } },
            90: { intra: { be: 3676000, int: 4396000 }, inter: { be: 6792000, int: 8218000 } },
            100: { intra: { be: 3875000, int: 4628000 }, inter: { be: 7157000, int: 8651000 } },
            200: { intra: { be: 5495000, int: 6571000 }, inter: { be: 10151000, int: 12284000 } },
            300: { intra: { be: 6684000, int: 7989000 }, inter: { be: 12349000, int: 14934000 } },
            400: { intra: { be: 7753000, int: 9265000 }, inter: { be: 14324000, int: 17320000 } },
            500: { intra: { be: 8821000, int: 10540000 }, inter: { be: 16296000, int: 19703000 } },
            600: { intra: { be: 9889000, int: 11817000 }, inter: { be: 18270000, int: 22090000 } },
            700: { intra: { be: 10786000, int: 12888000 }, inter: { be: 19926000, int: 24092000 } },
            800: { intra: { be: 11632000, int: 13901000 }, inter: { be: 21488000, int: 25986000 } },
            900: { intra: { be: 12476000, int: 14909000 }, inter: { be: 23050000, int: 27870000 } },
            1000: { intra: { be: 13322000, int: 15923000 }, inter: { be: 24612000, int: 29765000 } },
            2000: { intra: { be: 25621000, int: 30616000 }, inter: { be: 47334000, int: 57232000 } },
            3000: { intra: { be: 36997000, int: 44205000 }, inter: { be: 68352000, int: 82636000 } },
            4000: { intra: { be: 47442000, int: 56692000 }, inter: { be: 87648000, int: 105979000 } },
            5000: { intra: { be: 56961000, int: 68065000 }, inter: { be: 105235000, int: 127241000 } },
            6000: { intra: { be: 65559000, int: 78336000 }, inter: { be: 121119000, int: 146442000 } },
            7000: { intra: { be: 73234000, int: 87504000 }, inter: { be: 135298000, int: 163580000 } },
            8000: { intra: { be: 79968000, int: 95560000 }, inter: { be: 147740000, int: 178639000 } },
            9000: { intra: { be: 85791000, int: 102516000 }, inter: { be: 158496000, int: 191644000 } },
            10000: { intra: { be: 90682000, int: 108361000 }, inter: { be: 167533000, int: 202571000 } }
        };

        const METRO_NEUCENTRIX_KALIMANTAN_PRICING = {
            1: { intra: { be: 611000, int: 732000 }, inter: { be: 888000, int: 1086000 } },
            2: { intra: { be: 776000, int: 931000 }, inter: { be: 1129000, int: 1382000 } },
            3: { intra: { be: 916000, int: 1096000 }, inter: { be: 1332000, int: 1629000 } },
            4: { intra: { be: 1054000, int: 1261000 }, inter: { be: 1534000, int: 1873000 } },
            5: { intra: { be: 1193000, int: 1426000 }, inter: { be: 1736000, int: 2118000 } },
            6: { intra: { be: 1232000, int: 1474000 }, inter: { be: 1793000, int: 2189000 } },
            7: { intra: { be: 1299000, int: 1550000 }, inter: { be: 1890000, int: 2303000 } },
            8: { intra: { be: 1359000, int: 1625000 }, inter: { be: 1977000, int: 2414000 } },
            9: { intra: { be: 1472000, int: 1756000 }, inter: { be: 2141000, int: 2609000 } },
            10: { intra: { be: 1584000, int: 1901000 }, inter: { be: 2304000, int: 2824000 } },
            20: { intra: { be: 2179000, int: 2608000 }, inter: { be: 3170000, int: 3875000 } },
            30: { intra: { be: 2788000, int: 3336000 }, inter: { be: 4056000, int: 4956000 } },
            40: { intra: { be: 3384000, int: 4052000 }, inter: { be: 4924000, int: 6020000 } },
            50: { intra: { be: 3820000, int: 4575000 }, inter: { be: 5560000, int: 6796000 } },
            60: { intra: { be: 4065000, int: 4870000 }, inter: { be: 5916000, int: 7234000 } },
            70: { intra: { be: 4316000, int: 5173000 }, inter: { be: 6281000, int: 7684000 } },
            80: { intra: { be: 4561000, int: 5462000 }, inter: { be: 6637000, int: 8114000 } },
            90: { intra: { be: 4806000, int: 5756000 }, inter: { be: 6993000, int: 8552000 } },
            100: { intra: { be: 5064000, int: 6060000 }, inter: { be: 7369000, int: 9002000 } },
            200: { intra: { be: 7183000, int: 8604000 }, inter: { be: 10452000, int: 12781000 } },
            300: { intra: { be: 8738000, int: 10460000 }, inter: { be: 12716000, int: 15540000 } },
            400: { intra: { be: 10135000, int: 12132000 }, inter: { be: 14748000, int: 18022000 } },
            500: { intra: { be: 11530000, int: 13800000 }, inter: { be: 16780000, int: 20502000 } },
            600: { intra: { be: 12927000, int: 15472000 }, inter: { be: 18812000, int: 22986000 } },
            700: { intra: { be: 14099000, int: 16875000 }, inter: { be: 20517000, int: 25068000 } },
            800: { intra: { be: 15204000, int: 18201000 }, inter: { be: 22125000, int: 27040000 } },
            900: { intra: { be: 16308000, int: 19521000 }, inter: { be: 23733000, int: 29000000 } },
            1000: { intra: { be: 17414000, int: 20848000 }, inter: { be: 25341000, int: 30972000 } },
            2000: { intra: { be: 33491000, int: 40088000 }, inter: { be: 48738000, int: 59554000 } },
            3000: { intra: { be: 48362000, int: 57880000 }, inter: { be: 70380000, int: 85988000 } },
            4000: { intra: { be: 62015000, int: 74230000 }, inter: { be: 90248000, int: 110277000 } },
            5000: { intra: { be: 74457000, int: 89123000 }, inter: { be: 108356000, int: 132402000 } },
            6000: { intra: { be: 85696000, int: 102572000 }, inter: { be: 124712000, int: 152382000 } },
            7000: { intra: { be: 95728000, int: 114576000 }, inter: { be: 139312000, int: 170214000 } },
            8000: { intra: { be: 104531000, int: 125123000 }, inter: { be: 152121000, int: 185884000 } },
            9000: { intra: { be: 112142000, int: 134233000 }, inter: { be: 163198000, int: 199418000 } },
            10000: { intra: { be: 118536000, int: 141886000 }, inter: { be: 172502000, int: 210788000 } }
        };

        const METRO_NEUCENTRIX_KTI_PRICING = {
            1: { intra: { be: 611000, int: 732000 }, inter: { be: 888000, int: 1086000 } },
            2: { intra: { be: 776000, int: 931000 }, inter: { be: 1129000, int: 1382000 } },
            3: { intra: { be: 916000, int: 1096000 }, inter: { be: 1332000, int: 1629000 } },
            4: { intra: { be: 1054000, int: 1261000 }, inter: { be: 1534000, int: 1873000 } },
            5: { intra: { be: 1193000, int: 1426000 }, inter: { be: 1736000, int: 2118000 } },
            6: { intra: { be: 1232000, int: 1474000 }, inter: { be: 1793000, int: 2189000 } },
            7: { intra: { be: 1299000, int: 1550000 }, inter: { be: 1890000, int: 2303000 } },
            8: { intra: { be: 1359000, int: 1625000 }, inter: { be: 1977000, int: 2414000 } },
            9: { intra: { be: 1472000, int: 1756000 }, inter: { be: 2141000, int: 2609000 } },
            10: { intra: { be: 1584000, int: 1901000 }, inter: { be: 2304000, int: 2824000 } },
            20: { intra: { be: 2179000, int: 2608000 }, inter: { be: 3170000, int: 3875000 } },
            30: { intra: { be: 2788000, int: 3336000 }, inter: { be: 4056000, int: 4956000 } },
            40: { intra: { be: 3384000, int: 4052000 }, inter: { be: 4924000, int: 6020000 } },
            50: { intra: { be: 3820000, int: 4575000 }, inter: { be: 5560000, int: 6796000 } },
            60: { intra: { be: 4065000, int: 4870000 }, inter: { be: 5916000, int: 7234000 } },
            70: { intra: { be: 4316000, int: 5173000 }, inter: { be: 6281000, int: 7684000 } },
            80: { intra: { be: 4561000, int: 5462000 }, inter: { be: 6637000, int: 8114000 } },
            90: { intra: { be: 4806000, int: 5756000 }, inter: { be: 6993000, int: 8552000 } },
            100: { intra: { be: 5064000, int: 6060000 }, inter: { be: 7369000, int: 9002000 } },
            200: { intra: { be: 7183000, int: 8604000 }, inter: { be: 10452000, int: 12781000 } },
            300: { intra: { be: 8738000, int: 10460000 }, inter: { be: 12716000, int: 15540000 } },
            400: { intra: { be: 10135000, int: 12132000 }, inter: { be: 14748000, int: 18022000 } },
            500: { intra: { be: 11530000, int: 13800000 }, inter: { be: 16780000, int: 20502000 } },
            600: { intra: { be: 12927000, int: 15472000 }, inter: { be: 18812000, int: 22986000 } },
            700: { intra: { be: 14099000, int: 16875000 }, inter: { be: 20517000, int: 25068000 } },
            800: { intra: { be: 15204000, int: 18201000 }, inter: { be: 22125000, int: 27040000 } },
            900: { intra: { be: 16308000, int: 19521000 }, inter: { be: 23733000, int: 29000000 } },
            1000: { intra: { be: 17414000, int: 20848000 }, inter: { be: 25341000, int: 30972000 } },
            2000: { intra: { be: 33491000, int: 40088000 }, inter: { be: 48738000, int: 59554000 } },
            3000: { intra: { be: 48362000, int: 57880000 }, inter: { be: 70380000, int: 85988000 } },
            4000: { intra: { be: 62015000, int: 74230000 }, inter: { be: 90248000, int: 110277000 } },
            5000: { intra: { be: 74457000, int: 89123000 }, inter: { be: 108356000, int: 132402000 } },
            6000: { intra: { be: 85696000, int: 102572000 }, inter: { be: 124712000, int: 152382000 } },
            7000: { intra: { be: 95728000, int: 114576000 }, inter: { be: 139312000, int: 170214000 } },
            8000: { intra: { be: 104531000, int: 125123000 }, inter: { be: 152121000, int: 185884000 } },
            9000: { intra: { be: 112142000, int: 134233000 }, inter: { be: 163198000, int: 199418000 } },
            10000: { intra: { be: 118536000, int: 141886000 }, inter: { be: 172502000, int: 210788000 } }
        };

        const METRO_JATIM_BALI_PRICING = {
            1: { intra: { be: 517000, int: 615000 }, inter: { be: 903000, int: 1094000 } },
            2: { intra: { be: 657000, int: 783000 }, inter: { be: 1148000, int: 1392000 } },
            3: { intra: { be: 775000, int: 922000 }, inter: { be: 1354000, int: 1641000 } },
            4: { intra: { be: 893000, int: 1061000 }, inter: { be: 1560000, int: 1887000 } },
            5: { intra: { be: 1011000, int: 1199000 }, inter: { be: 1765000, int: 2134000 } },
            6: { intra: { be: 1044000, int: 1239000 }, inter: { be: 1823000, int: 2205000 } },
            7: { intra: { be: 1100000, int: 1303000 }, inter: { be: 1922000, int: 2319000 } },
            8: { intra: { be: 1151000, int: 1367000 }, inter: { be: 2010000, int: 2432000 } },
            9: { intra: { be: 1246000, int: 1477000 }, inter: { be: 2177000, int: 2628000 } },
            10: { intra: { be: 1342000, int: 1599000 }, inter: { be: 2343000, int: 2845000 } },
            20: { intra: { be: 1845000, int: 2194000 }, inter: { be: 3224000, int: 3904000 } },
            30: { intra: { be: 2361000, int: 2806000 }, inter: { be: 4125000, int: 4993000 } },
            40: { intra: { be: 2866000, int: 3408000 }, inter: { be: 5007000, int: 6065000 } },
            50: { intra: { be: 3236000, int: 3848000 }, inter: { be: 5653000, int: 6847000 } },
            60: { intra: { be: 3443000, int: 4095000 }, inter: { be: 6015000, int: 7288000 } },
            70: { intra: { be: 3656000, int: 4350000 }, inter: { be: 6387000, int: 7742000 } },
            80: { intra: { be: 3864000, int: 4593000 }, inter: { be: 6749000, int: 8174000 } },
            90: { intra: { be: 4071000, int: 4841000 }, inter: { be: 7111000, int: 8615000 } },
            100: { intra: { be: 4290000, int: 5096000 }, inter: { be: 7494000, int: 9069000 } },
            200: { intra: { be: 6084000, int: 7236000 }, inter: { be: 10628000, int: 12877000 } },
            300: { intra: { be: 7402000, int: 8797000 }, inter: { be: 12930000, int: 15656000 } },
            400: { intra: { be: 8585000, int: 10202000 }, inter: { be: 14997000, int: 18156000 } },
            500: { intra: { be: 9767000, int: 11606000 }, inter: { be: 17062000, int: 20655000 } },
            600: { intra: { be: 10950000, int: 13012000 }, inter: { be: 19130000, int: 23157000 } },
            700: { intra: { be: 11943000, int: 14191000 }, inter: { be: 20864000, int: 25256000 } },
            800: { intra: { be: 12879000, int: 15307000 }, inter: { be: 22499000, int: 27242000 } },
            900: { intra: { be: 13815000, int: 16417000 }, inter: { be: 24134000, int: 29217000 } },
            1000: { intra: { be: 14751000, int: 17533000 }, inter: { be: 25769000, int: 31203000 } },
            2000: { intra: { be: 28370000, int: 33713000 }, inter: { be: 49561000, int: 59998000 } },
            3000: { intra: { be: 40967000, int: 48678000 }, inter: { be: 71568000, int: 86630000 } },
            4000: { intra: { be: 52533000, int: 62428000 }, inter: { be: 91773000, int: 111100000 } },
            5000: { intra: { be: 63073000, int: 74953000 }, inter: { be: 110186000, int: 133390000 } },
            6000: { intra: { be: 72594000, int: 86263000 }, inter: { be: 126818000, int: 153519000 } },
            7000: { intra: { be: 81092000, int: 96358000 }, inter: { be: 141665000, int: 171485000 } },
            8000: { intra: { be: 88549000, int: 105229000 }, inter: { be: 154691000, int: 187272000 } },
            9000: { intra: { be: 94996000, int: 112890000 }, inter: { be: 165955000, int: 200906000 } },
            10000: { intra: { be: 100412000, int: 119326000 }, inter: { be: 175416000, int: 212361000 } }
        };

        const ASTINET_LITE_PRICING = {
            1: { "JaBoDeTaBek": 81000, "Jawa": 155000, "Sumatera": 210000, "Kalimantan & KTI": 221000 },
            2: { "JaBoDeTaBek": 158000, "Jawa": 305000, "Sumatera": 412000, "Kalimantan & KTI": 434000 },
            3: { "JaBoDeTaBek": 228000, "Jawa": 439000, "Sumatera": 593000, "Kalimantan & KTI": 626000 },
            5: { "JaBoDeTaBek": 349000, "Jawa": 670000, "Sumatera": 908000, "Kalimantan & KTI": 956000 },
            10: { "JaBoDeTaBek": 470000, "Jawa": 900000, "Sumatera": 1220000, "Kalimantan & KTI": 1286000 },
            20: { "JaBoDeTaBek": 910000, "Jawa": 1740000, "Sumatera": 2360000, "Kalimantan & KTI": 2485000 },
            30: { "JaBoDeTaBek": 1313000, "Jawa": 2509000, "Sumatera": 3404000, "Kalimantan & KTI": 3584000 },
            40: { "JaBoDeTaBek": 1683000, "Jawa": 3216000, "Sumatera": 4364000, "Kalimantan & KTI": 4592000 },
            50: { "JaBoDeTaBek": 2020000, "Jawa": 3857000, "Sumatera": 5236000, "Kalimantan & KTI": 5511000 },
            60: { "JaBoDeTaBek": 2324000, "Jawa": 4440000, "Sumatera": 6023000, "Kalimantan & KTI": 6342000 },
            70: { "JaBoDeTaBek": 2596000, "Jawa": 4958000, "Sumatera": 6729000, "Kalimantan & KTI": 7081000 },
            80: { "JaBoDeTaBek": 2837000, "Jawa": 5418000, "Sumatera": 7353000, "Kalimantan & KTI": 7738000 },
            90: { "JaBoDeTaBek": 3043000, "Jawa": 5812000, "Sumatera": 7887000, "Kalimantan & KTI": 8301000 },
            100: { "JaBoDeTaBek": 3215000, "Jawa": 6141000, "Sumatera": 8333000, "Kalimantan & KTI": 8770000, "NTT": 10293000 }
        };

        const ASTINET_FIT_PRICING = {
            1: { "JaBoDeTaBek": 97000, "Jawa": 186000, "Sumatera": 252000, "Kalimantan & KTI": 265000 },
            2: { "JaBoDeTaBek": 189000, "Jawa": 365000, "Sumatera": 493000, "Kalimantan & KTI": 520000 },
            3: { "JaBoDeTaBek": 272000, "Jawa": 523000, "Sumatera": 707000, "Kalimantan & KTI": 747000 },
            5: { "JaBoDeTaBek": 416000, "Jawa": 798000, "Sumatera": 1082000, "Kalimantan & KTI": 1139000 },
            10: { "JaBoDeTaBek": 560000, "Jawa": 1073000, "Sumatera": 1453000, "Kalimantan & KTI": 1532000 },
            20: { "JaBoDeTaBek": 1085000, "Jawa": 2075000, "Sumatera": 2814000, "Kalimantan & KTI": 2962000 },
            30: { "JaBoDeTaBek": 1566000, "Jawa": 2993000, "Sumatera": 4060000, "Kalimantan & KTI": 4275000 },
            40: { "JaBoDeTaBek": 2008000, "Jawa": 3837000, "Sumatera": 5207000, "Kalimantan & KTI": 5478000 },
            50: { "JaBoDeTaBek": 2410000, "Jawa": 4602000, "Sumatera": 6247000, "Kalimantan & KTI": 6575000 },
            60: { "JaBoDeTaBek": 2773000, "Jawa": 5298000, "Sumatera": 7187000, "Kalimantan & KTI": 7568000 },
            70: { "JaBoDeTaBek": 3096000, "Jawa": 5913000, "Sumatera": 8025000, "Kalimantan & KTI": 8445000 },
            80: { "JaBoDeTaBek": 3385000, "Jawa": 6465000, "Sumatera": 8774000, "Kalimantan & KTI": 9233000 },
            90: { "JaBoDeTaBek": 3630000, "Jawa": 6933000, "Sumatera": 9408000, "Kalimantan & KTI": 9902000 },
            100: { "JaBoDeTaBek": 3901000, "Jawa": 7451000, "Sumatera": 10111000, "Kalimantan & KTI": 10641000, "NTT": 12849000 }
        };

        const ASTINET_BB_GLOBAL_PRICING = {
            1: { "JaBoDeTaBek": 151000, "Jawa": 174000, "Sumatera": 186000, "Kalimantan & KTI": 225000, "NTT": 293000 },
            2: { "JaBoDeTaBek": 292000, "Jawa": 337000, "Sumatera": 360000, "Kalimantan & KTI": 435000, "NTT": 568000 },
            3: { "JaBoDeTaBek": 424000, "Jawa": 489000, "Sumatera": 524000, "Kalimantan & KTI": 633000, "NTT": 829000 },
            4: { "JaBoDeTaBek": 549000, "Jawa": 634000, "Sumatera": 678000, "Kalimantan & KTI": 819000, "NTT": 1072000 },
            5: { "JaBoDeTaBek": 665000, "Jawa": 766000, "Sumatera": 822000, "Kalimantan & KTI": 990000, "NTT": 1297000 },
            6: { "JaBoDeTaBek": 740000, "Jawa": 853000, "Sumatera": 914000, "Kalimantan & KTI": 1149000, "NTT": 1508000 },
            7: { "JaBoDeTaBek": 835000, "Jawa": 963000, "Sumatera": 1031000, "Kalimantan & KTI": 1298000, "NTT": 1703000 },
            8: { "JaBoDeTaBek": 922000, "Jawa": 1063000, "Sumatera": 1138000, "Kalimantan & KTI": 1433000, "NTT": 1880000 },
            9: { "JaBoDeTaBek": 1001000, "Jawa": 1152000, "Sumatera": 1233000, "Kalimantan & KTI": 1555000, "NTT": 2039000 },
            10: { "JaBoDeTaBek": 1071000, "Jawa": 1233000, "Sumatera": 1321000, "Kalimantan & KTI": 1665000, "NTT": 2187000 },
            20: { "JaBoDeTaBek": 1845000, "Jawa": 2125000, "Sumatera": 2275000, "Kalimantan & KTI": 3236000, "NTT": 4250000 },
            50: { "JaBoDeTaBek": 4165000, "Jawa": 4791000, "Sumatera": 5132000, "Kalimantan & KTI": 7306000, "NTT": 10193000 },
            100: { "JaBoDeTaBek": 7114000, "Jawa": 8183000, "Sumatera": 8767000, "Kalimantan & KTI": 12480000, "NTT": 16384000 },
            200: { "JaBoDeTaBek": 13213000, "Jawa": 15195000, "Sumatera": 16281000, "Kalimantan & KTI": 23181000, "NTT": 31857000 },
            500: { "JaBoDeTaBek": 28908000, "Jawa": 33245000, "Sumatera": 35619000, "Kalimantan & KTI": 44954000, "NTT": 72809000 },
            1000: { "JaBoDeTaBek": 40770000, "Jawa": 46887000, "Sumatera": 50235000, "Kalimantan & KTI": 72988000, "NTT": 105410000 }
        };

        const ASTINET_BB_DOMESTIK_PRICING = {
            1: { "JaBoDeTaBek": 39000, "Jawa": 44000, "Sumatera": 48000, "Kalimantan & KTI": 86000, "NTT": 154000 },
            2: { "JaBoDeTaBek": 74000, "Jawa": 83000, "Sumatera": 89000, "Kalimantan & KTI": 163000, "NTT": 296000 },
            3: { "JaBoDeTaBek": 109000, "Jawa": 122000, "Sumatera": 132000, "Kalimantan & KTI": 239000, "NTT": 428000 },
            4: { "JaBoDeTaBek": 143000, "Jawa": 161000, "Sumatera": 173000, "Kalimantan & KTI": 314000, "NTT": 552000 },
            5: { "JaBoDeTaBek": 175000, "Jawa": 198000, "Sumatera": 211000, "Kalimantan & KTI": 385000, "NTT": 666000 },
            6: { "JaBoDeTaBek": 193000, "Jawa": 218000, "Sumatera": 234000, "Kalimantan & KTI": 424000, "NTT": 770000 },
            7: { "JaBoDeTaBek": 222000, "Jawa": 250000, "Sumatera": 267000, "Kalimantan & KTI": 488000, "NTT": 866000 },
            8: { "JaBoDeTaBek": 249000, "Jawa": 280000, "Sumatera": 299000, "Kalimantan & KTI": 547000, "NTT": 954000 },
            9: { "JaBoDeTaBek": 279000, "Jawa": 314000, "Sumatera": 336000, "Kalimantan & KTI": 613000, "NTT": 1031000 },
            10: { "JaBoDeTaBek": 301000, "Jawa": 339000, "Sumatera": 362000, "Kalimantan & KTI": 663000, "NTT": 1098000 },
            20: { "JaBoDeTaBek": 553000, "Jawa": 621000, "Sumatera": 664000, "Kalimantan & KTI": 1216000, "NTT": 2127000 },
            50: { "JaBoDeTaBek": 1171000, "Jawa": 1312000, "Sumatera": 1406000, "Kalimantan & KTI": 2576000, "NTT": 4732000 },
            100: { "JaBoDeTaBek": 2137000, "Jawa": 2395000, "Sumatera": 2565000, "Kalimantan & KTI": 4702000, "NTT": 7885000 },
            200: { "JaBoDeTaBek": 3711000, "Jawa": 4157000, "Sumatera": 4454000, "Kalimantan & KTI": 8165000, "NTT": 14455000 },
            500: { "JaBoDeTaBek": 7917000, "Jawa": 8869000, "Sumatera": 9501000, "Kalimantan & KTI": 17418000, "NTT": 26515000 },
            1000: { "JaBoDeTaBek": 12545000, "Jawa": 14052000, "Sumatera": 15055000, "Kalimantan & KTI": 19405000, "NTT": 40508000 }
        };

        const SIPTRUNK_OTC_CC = [
            { max: 50, price: 3000000 },
            { max: 600, price: 5000000 },
            { max: 1000, price: 6500000 }
        ];

        const SIPTRUNK_OTC_NUMBER = [
            { max: 100, price: 500000 },
            { max: 200, price: 1000000 },
            { max: 300, price: 1500000 },
            { max: 400, price: 2000000 },
            { max: 500, price: 2500000 },
            { max: 600, price: 3000000 },
            { max: 700, price: 3500000 },
            { max: 800, price: 4000000 },
            { max: 900, price: 4500000 },
            { max: 1000, price: 5000000 },
            { max: 10000, price: 6000000 }
        ];

        const SIPTRUNK_MRC_NUMBER = [
            { max: 10, price: 550000 },
            { max: 30, price: 575000 },
            { max: 50, price: 595000 },
            { max: 100, price: 650000 },
            { max: 200, price: 1165000 },
            { max: 300, price: 1695000 },
            { max: 400, price: 2185000 },
            { max: 500, price: 2640000 },
            { max: 600, price: 3100000 },
            { max: 700, price: 3490000 },
            { max: 800, price: 3840000 },
            { max: 900, price: 4160000 },
            { max: 1000, price: 4440000 },
            { max: 2000, price: 8000000 },
            { max: 3000, price: 12000000 },
            { max: 4000, price: 16000000 },
            { max: 5000, price: 20000000 },
            { max: 6000, price: 24000000 },
            { max: 7000, price: 28000000 },
            { max: 8000, price: 32000000 },
            { max: 9000, price: 36000000 },
            { max: 10000, price: 40000000 }
        ];

        const SIPTRUNK_MRC_CC = {
            3: { standard: 1450000, ha: 1800000 },
            5: { standard: 1470000, ha: 1800000 },
            10: { standard: 1500000, ha: 1900000 },
            20: { standard: 1580000, ha: 1900000 },
            30: { standard: 1650000, ha: 2000000 },
            40: { standard: 1980000, ha: 2400000 },
            50: { standard: 2480000, ha: 3000000 },
            60: { standard: 2970000, ha: 3500000 },
            70: { standard: 3470000, ha: 4000000 },
            80: { standard: 3960000, ha: 4500000 },
            90: { standard: 4460000, ha: 5000000 },
            100: { standard: 4950000, ha: 5500000 },
            120: { standard: 5940000, ha: 6500000 },
            140: { standard: 6930000, ha: 7500000 },
            160: { standard: 7920000, ha: 8500000 },
            180: { standard: 8910000, ha: 9500000 },
            200: { standard: 9900000, ha: 10500000 },
            250: { standard: 12380000, ha: 13000000 },
            300: { standard: 14850000, ha: 15600000 },
            350: { standard: 17330000, ha: 18200000 },
            400: { standard: 19800000, ha: 20100000 },
            450: { standard: 22280000, ha: 23100000 },
            500: { standard: 24750000, ha: 25800000 },
            600: { standard: 29700000, ha: 30900000 },
            700: { standard: 34650000, ha: 36050000 },
            800: { standard: 39600000, ha: 41200000 },
            900: { standard: 44550000, ha: 46350000 },
            1000: { standard: 49500000, ha: 51500000 }
        };

        const IP_TRANSIT_BB_GLOBAL_PRICING = {
            1: { "JaBoDeTaBek": 134000, "Jawa": 151000, "Sumatera": 161000, "Kalimantan & KTI": 195000 },
            2: { "JaBoDeTaBek": 260000, "Jawa": 293000, "Sumatera": 313000, "Kalimantan & KTI": 378250 },
            3: { "JaBoDeTaBek": 378000, "Jawa": 425000, "Sumatera": 455000, "Kalimantan & KTI": 549950 },
            4: { "JaBoDeTaBek": 490000, "Jawa": 551000, "Sumatera": 589000, "Kalimantan & KTI": 711450 },
            5: { "JaBoDeTaBek": 593000, "Jawa": 666000, "Sumatera": 714000, "Kalimantan & KTI": 860200 },
            6: { "JaBoDeTaBek": 660000, "Jawa": 741000, "Sumatera": 794000, "Kalimantan & KTI": 998750 },
            7: { "JaBoDeTaBek": 745000, "Jawa": 837000, "Sumatera": 896000, "Kalimantan & KTI": 1127950 },
            8: { "JaBoDeTaBek": 823000, "Jawa": 924000, "Sumatera": 989000, "Kalimantan & KTI": 1245250 },
            9: { "JaBoDeTaBek": 893000, "Jawa": 1001000, "Sumatera": 1072000, "Kalimantan & KTI": 1351500 },
            10: { "JaBoDeTaBek": 956000, "Jawa": 1072000, "Sumatera": 1148000, "Kalimantan & KTI": 1447550 },
            20: { "JaBoDeTaBek": 1647000, "Jawa": 1847000, "Sumatera": 1978000, "Kalimantan & KTI": 2813500 },
            50: { "JaBoDeTaBek": 3718000, "Jawa": 4166000, "Sumatera": 4462000, "Kalimantan & KTI": 6352900 },
            100: { "JaBoDeTaBek": 6351000, "Jawa": 7115000, "Sumatera": 7623000, "Kalimantan & KTI": 10851950 },
            200: { "JaBoDeTaBek": 11797000, "Jawa": 13213000, "Sumatera": 14157000, "Kalimantan & KTI": 20156900 },
            500: { "JaBoDeTaBek": 25810000, "Jawa": 28908000, "Sumatera": 30973000, "Kalimantan & KTI": 39089800 },
            600: { "JaBoDeTaBek": 28797000, "Jawa": 32254000, "Sumatera": 34557000, "Kalimantan & KTI": 49205650 },
            700: { "JaBoDeTaBek": 31605000, "Jawa": 35399000, "Sumatera": 37927000, "Kalimantan & KTI": 54003900 },
            800: { "JaBoDeTaBek": 33917000, "Jawa": 37989000, "Sumatera": 40703000, "Kalimantan & KTI": 57954700 },
            900: { "JaBoDeTaBek": 35039000, "Jawa": 39245000, "Sumatera": 42047000, "Kalimantan & KTI": 61092900 },
            1000: { "JaBoDeTaBek": 36401000, "Jawa": 40771000, "Sumatera": 43682000, "Kalimantan & KTI": 63467800 },
            2000: { "JaBoDeTaBek": 58438000, "Jawa": 65451000, "Sumatera": 70127000, "Kalimantan & KTI": 123409800 },
            3000: { "JaBoDeTaBek": 85152000, "Jawa": 95371000, "Sumatera": 102183000, "Kalimantan & KTI": 179824300 },
            4000: { "JaBoDeTaBek": 110197000, "Jawa": 123422000, "Sumatera": 132237000, "Kalimantan & KTI": 232713000 },
            5000: { "JaBoDeTaBek": 133572000, "Jawa": 149601000, "Sumatera": 160288000, "Kalimantan & KTI": 282076750 },
            6000: { "JaBoDeTaBek": 155277000, "Jawa": 173911000, "Sumatera": 186333000, "Kalimantan & KTI": 327913000 },
            7000: { "JaBoDeTaBek": 175312000, "Jawa": 196350000, "Sumatera": 210376000, "Kalimantan & KTI": 370223450 },
            8000: { "JaBoDeTaBek": 197631000, "Jawa": 221348000, "Sumatera": 237158000, "Kalimantan & KTI": 409009800 },
            9000: { "JaBoDeTaBek": 214668000, "Jawa": 240429000, "Sumatera": 257603000, "Kalimantan & KTI": 444267800 },
            10000: { "JaBoDeTaBek": 230000000, "Jawa": 257601000, "Sumatera": 276001000, "Kalimantan & KTI": 476000000 }
        };

        const IP_TRANSIT_BB_DOMESTIK_PRICING = {
            1: { "JaBoDeTaBek": 36000, "Jawa": 41000, "Sumatera": 44000, "Kalimantan & KTI": 80000 },
            2: { "JaBoDeTaBek": 69000, "Jawa": 77000, "Sumatera": 83000, "Kalimantan & KTI": 152000 },
            3: { "JaBoDeTaBek": 101000, "Jawa": 114000, "Sumatera": 123000, "Kalimantan & KTI": 223000 },
            4: { "JaBoDeTaBek": 133000, "Jawa": 150000, "Sumatera": 161000, "Kalimantan & KTI": 293000 },
            5: { "JaBoDeTaBek": 163000, "Jawa": 185000, "Sumatera": 197000, "Kalimantan & KTI": 359000 },
            6: { "JaBoDeTaBek": 180000, "Jawa": 203000, "Sumatera": 218000, "Kalimantan & KTI": 396000 },
            7: { "JaBoDeTaBek": 207000, "Jawa": 233000, "Sumatera": 249000, "Kalimantan & KTI": 456000 },
            8: { "JaBoDeTaBek": 232000, "Jawa": 261000, "Sumatera": 279000, "Kalimantan & KTI": 511000 },
            9: { "JaBoDeTaBek": 260000, "Jawa": 293000, "Sumatera": 314000, "Kalimantan & KTI": 572000 },
            10: { "JaBoDeTaBek": 281000, "Jawa": 316000, "Sumatera": 338000, "Kalimantan & KTI": 619000 },
            20: { "JaBoDeTaBek": 516000, "Jawa": 580000, "Sumatera": 620000, "Kalimantan & KTI": 1136000 },
            50: { "JaBoDeTaBek": 1094000, "Jawa": 1226000, "Sumatera": 1314000, "Kalimantan & KTI": 2407000 },
            100: { "JaBoDeTaBek": 1997000, "Jawa": 2238000, "Sumatera": 2397000, "Kalimantan & KTI": 4394000 },
            200: { "JaBoDeTaBek": 3468000, "Jawa": 3885000, "Sumatera": 4162000, "Kalimantan & KTI": 7630000 },
            500: { "JaBoDeTaBek": 7399000, "Jawa": 8288000, "Sumatera": 8879000, "Kalimantan & KTI": 16278000 },
            600: { "JaBoDeTaBek": 8243000, "Jawa": 9233000, "Sumatera": 9892000, "Kalimantan & KTI": 18135000 },
            700: { "JaBoDeTaBek": 9306000, "Jawa": 10425000, "Sumatera": 11169000, "Kalimantan & KTI": 20474000 },
            800: { "JaBoDeTaBek": 10280000, "Jawa": 11515000, "Sumatera": 12337000, "Kalimantan & KTI": 22616000 },
            900: { "JaBoDeTaBek": 10944000, "Jawa": 12259000, "Sumatera": 13133000, "Kalimantan & KTI": 24077000 },
            1000: { "JaBoDeTaBek": 11724000, "Jawa": 13132000, "Sumatera": 14070000, "Kalimantan & KTI": 25793000 },
            2000: { "JaBoDeTaBek": 23470000, "Jawa": 26289000, "Sumatera": 28166000, "Kalimantan & KTI": 51634000 },
            3000: { "JaBoDeTaBek": 34905000, "Jawa": 39095000, "Sumatera": 41886000, "Kalimantan & KTI": 76791000 },
            4000: { "JaBoDeTaBek": 46136000, "Jawa": 51673000, "Sumatera": 55364000, "Kalimantan & KTI": 101500000 },
            5000: { "JaBoDeTaBek": 57161000, "Jawa": 64021000, "Sumatera": 68594000, "Kalimantan & KTI": 125755000 },
            6000: { "JaBoDeTaBek": 68322000, "Jawa": 76522000, "Sumatera": 81988000, "Kalimantan & KTI": 150309000 },
            7000: { "JaBoDeTaBek": 79239000, "Jawa": 88748000, "Sumatera": 95088000, "Kalimantan & KTI": 174326000 },
            8000: { "JaBoDeTaBek": 90531000, "Jawa": 101395000, "Sumatera": 108638000, "Kalimantan & KTI": 199169000 },
            9000: { "JaBoDeTaBek": 101796000, "Jawa": 114012000, "Sumatera": 122156000, "Kalimantan & KTI": 223952000 },
            10000: { "JaBoDeTaBek": 112092000, "Jawa": 125544000, "Sumatera": 134511000, "Kalimantan & KTI": 246603000 }
        };

        // --- Helpers ---
        const parseBandwidth = (bwString) => {
            if (!bwString) return 0;
            if (typeof bwString === 'number') return bwString;

            const match = bwString.match(/([\d.]+)\s*(Kbps|Mbps|Gbps)/i);
            if (match) {
                let val = parseFloat(match[1]);
                const unit = match[2].toLowerCase();
                
                if (unit === 'gbps') val *= 1000;
                if (unit === 'kbps') val /= 1000;
                
                return val; // in Mbps
            }

            // Fallback: try parsing as plain number (assume Mbps)
            const floatVal = parseFloat(bwString);
            return !isNaN(floatVal) ? floatVal : 0;
        };

        const calculateInterpolatedPrice = (bwVal, location, pricingTable) => {
            if (!bwVal || !location || !pricingTable) return null;

            const sortedKeys = Object.keys(pricingTable)
                .map(k => parseFloat(k))
                .sort((a, b) => a - b);

            // Exact match
            if (pricingTable[bwVal] && pricingTable[bwVal][location]) {
                return pricingTable[bwVal][location];
            }

            // Find range
            let lower = null;
            let upper = null;

            for (let k of sortedKeys) {
                if (k < bwVal) lower = k;
                if (k > bwVal) {
                    upper = k;
                    break;
                }
            }

            if (lower !== null && upper !== null) {
                const priceA = pricingTable[lower][location];
                const priceB = pricingTable[upper][location];

                if (priceA !== undefined && priceB !== undefined) {
                    const x = bwVal - lower;
                    const y = upper - lower;
                    // Formula: Tarif C = Tarif A + ( (x/y) * (Tarif B - Tarif A) )
                    return priceA + ((x / y) * (priceB - priceA));
                }
            }

            return null;
        };

        const readFileAsArrayBuffer = (file) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        };


        // --- Doc Generation Logic ---
        function getInterpolatedPrice(pricingTable, bwVal, scope) {
            const keys = Object.keys(pricingTable).map(Number).sort((a, b) => a - b);
            
            // Check exact match
            if (pricingTable[bwVal]) {
                return scope ? pricingTable[bwVal][scope] : pricingTable[bwVal];
            }

            // Find lower (A) and upper (B) bounds
            let lower = null;
            let upper = null;

            for (let i = 0; i < keys.length; i++) {
                if (keys[i] < bwVal) lower = keys[i];
                if (keys[i] > bwVal) {
                    upper = keys[i];
                    break;
                }
            }

            if (lower !== null && upper !== null) {
                const priceA = scope ? pricingTable[lower][scope] : pricingTable[lower];
                const priceB = scope ? pricingTable[upper][scope] : pricingTable[upper];
                
                if (!priceA || !priceB) return null;
                
                // Linear Interpolation: Price C = Price A + ((C - A) / (B - A)) * (Price B - Price A)
                const interpolate = (valA, valB) => {
                    return valA + ((bwVal - lower) / (upper - lower)) * (valB - valA);
                };

                return {
                    be: Math.round(interpolate(priceA.be, priceB.be)),
                    int: Math.round(interpolate(priceA.int, priceB.int))
                };
            }

            return null; // Out of bounds or cannot interpolate
        }

        function getInterpolatedPriceIpTransit(pricingTable, bwVal, scope) {
            const itemExact = pricingTable.find(x => x.bw === bwVal);
            if (itemExact) {
                if (scope) return itemExact[scope];
                return itemExact;
            }

            // Find lower and upper bounds
            let lowerItem = null;
            let upperItem = null;

            // Sort by bandwidth just in case
            const sortedTable = [...pricingTable].sort((a, b) => a.bw - b.bw);

            for (let i = 0; i < sortedTable.length; i++) {
                if (sortedTable[i].bw < bwVal) lowerItem = sortedTable[i];
                if (sortedTable[i].bw > bwVal) {
                    upperItem = sortedTable[i];
                    break;
                }
            }

            if (lowerItem && upperItem) {
                const getPrice = (item) => scope ? item[scope] : item;
                
                const priceA = getPrice(lowerItem);
                const priceB = getPrice(upperItem);

                // Check if prices are objects (like {g:..., d:...}) or numbers
                if (typeof priceA === 'number' && typeof priceB === 'number') {
                     // Linear Interpolation: Price C = Price A + ((C - A) / (B - A)) * (Price B - Price A)
                    const interpolate = (valA, valB) => {
                        return valA + ((bwVal - lowerItem.bw) / (upperItem.bw - lowerItem.bw)) * (valB - valA);
                    };
                    return Math.round(interpolate(priceA, priceB));
                } else if (typeof priceA === 'object' && typeof priceB === 'object') {
                    // Interpolate each property (g, d, etc.)
                    const interpolate = (valA, valB) => {
                        return valA + ((bwVal - lowerItem.bw) / (upperItem.bw - lowerItem.bw)) * (valB - valA);
                    };
                    
                    const result = {};
                    for (const key in priceA) {
                         if (priceB.hasOwnProperty(key)) {
                             result[key] = Math.round(interpolate(priceA[key], priceB[key]));
                         }
                    }
                    return result;
                }
            }
            return null;
        }

        function getMetroPriceObject(zone, bwVal, isInter, isNeucentrix) {
            let priceObj = null;
            zone = zone || 'Jabodetabek';
            let pricingTable = null;
            
            if (isNeucentrix) {
                if (zone === 'Jabodetabek') {
                    pricingTable = METRO_NEUCENTRIX_JABODETABEK_PRICING;
                } else if (zone === 'Jabar Jateng' || zone === 'Jatim Bali') {
                    pricingTable = METRO_NEUCENTRIX_JAWA_BALI_PRICING;
                } else if (zone === 'Sumatra') {
                    pricingTable = METRO_NEUCENTRIX_SUMATRA_PRICING;
                } else if (zone === 'Kalimantan') {
                    pricingTable = METRO_NEUCENTRIX_KALIMANTAN_PRICING;
                } else if (zone === 'Sulawesi' || zone === 'Papua Maluku') {
                    pricingTable = METRO_NEUCENTRIX_KTI_PRICING;
                } else {
                    // Fallback to Jabodetabek
                    pricingTable = METRO_NEUCENTRIX_JABODETABEK_PRICING;
                }
            } else {
                if (zone === 'Jabar Jateng') {
                    pricingTable = METRO_JABAR_JATENG_PRICING;
                } else if (zone === 'Jatim Bali') {
                    pricingTable = METRO_JATIM_BALI_PRICING;
                } else if (zone === 'Sumatra') {
                    pricingTable = METRO_SUMATRA_PRICING;
                } else if (zone === 'Kalimantan') {
                    pricingTable = METRO_KALIMANTAN_PRICING;
                } else if (zone === 'Sulawesi' || zone === 'Sulawesi Selatan') {
                    pricingTable = METRO_SULAWESI_PRICING;
                } else if (zone === 'Papua Maluku') {
                    pricingTable = METRO_PAPUA_MALUKU_PRICING;
                } else if (zone === 'NTT') {
                    pricingTable = METRO_NUSA_TENGGARA_PRICING;
                } else {
                    pricingTable = METRO_JABO_PRICING;
                }
            }

            if (pricingTable) {
                // Use interpolation logic
                const useScope = (pricingTable !== METRO_JABO_PRICING);
                priceObj = getInterpolatedPrice(pricingTable, bwVal, useScope ? (isInter ? 'inter' : 'intra') : null);
            }

            return priceObj;
        }
        async function generateSPH(formData, services) {
            const hasKet = services.some(s => !s.type.toLowerCase().includes('astinet'));
            const grandTotalLabelSpan = hasKet ? 6 : 5;
            try {
                if (typeof window.saveAs === 'undefined') {
                    throw new Error("Library FileSaver.js belum dimuat. Periksa koneksi internet Anda.");
                }
                const { amName, customerName, subscriptionDuration, quoteNumber } = formData;
            const dateStr = new Date().toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });

            const { ImageRun, Footer } = docx; // Ensure ImageRun and Footer are destructured

            // --- Duration Parsing & Pricing Logic ---
            const durationMatch = subscriptionDuration.match(/(\d+)\s*(Bulan|Hari)/i);
            const durationValue = durationMatch ? parseInt(durationMatch[1]) : 12;
            const durationUnit = durationMatch ? durationMatch[2] : 'Bulan';
            const isDaily = durationUnit.toLowerCase() === 'hari';

            let priceMultiplier = 1;
            if (isDaily) {
                if (durationValue >= 1 && durationValue <= 3) priceMultiplier = 0.33;
                else if (durationValue >= 4 && durationValue <= 7) priceMultiplier = 0.53;
                else if (durationValue >= 8 && durationValue <= 14) priceMultiplier = 0.90;
                else if (durationValue >= 15 && durationValue <= 30) priceMultiplier = 1.00;
            }

            const durationLabel = `${durationValue} ${durationUnit}`;
            const ppnPercent = 11;

            const overviewRows = services.map((s) => {
                const quantity = s.quantity || 1;
                const baseMrc = s.mrc || 0;
                const displayMrc = isDaily ? Math.round(baseMrc * priceMultiplier) : baseMrc;
                const monthlyTotal = displayMrc * quantity;
                const discount = s.discountPercent || 0;
                const discountedMonthlyTotal = Math.round(monthlyTotal * (1 - discount / 100));

                let area = '-';
                if (s.type === 'IP Transit' || s.type === 'IP Transit Beda Bandwidth') {
                    area = s.zone || '-';
                } else if (s.type === 'Metro Ethernet') {
                    if (s.sites && s.sites.length > 0) {
                        area = s.sites[0].zone || s.sites[0].name || '-';
                    }
                } else {
                    area = s.location || '-';
                }

                const bandwidthLabel = s.bandwidth || '-';

                return {
                    name: s.type,
                    area,
                    bandwidth: bandwidthLabel,
                    monthlyTotal,
                    discountedMonthlyTotal,
                    discount
                };
            });

            const totalMonthly = overviewRows.reduce((sum, r) => sum + (r.monthlyTotal || 0), 0);
            const totalMonthlyDiscounted = overviewRows.reduce((sum, r) => sum + (r.discountedMonthlyTotal || 0), 0);
            const contractDuration = isDaily ? 1 : durationValue;
            const totalContract = totalMonthly * contractDuration;
            const totalContractDiscounted = totalMonthlyDiscounted * contractDuration;
            const totalContractDiscountedWithPpn = Math.round(totalContractDiscounted * (1 + ppnPercent / 100));
            // ----------------------------------------

            // --- Dynamic Content Logic ---
            const uniqueServices = [...new Set(services.map(s => s.type))];
            let serviceNamesString = uniqueServices[0];
            if (uniqueServices.length > 1) {
                const last = uniqueServices.pop();
                serviceNamesString = uniqueServices.join(', ') + ' dan ' + last;
            }

            const hasAstinet = services.some(s => s.type.toLowerCase().includes('astinet'));
            const hasMetro = services.some(s => s.type === 'Metro Ethernet');
            
            // --- SLG Logic ---
            const slgItems = [];
            // Check for Metro sites that are NOT Neucentrix (Standard Metro)
            const hasMetroE = services.some(s => 
                s.type === 'Metro Ethernet' && (!s.sites || s.sites.some(site => !site.isNeucentrix))
            );
            const hasIpTransit = services.some(s => s.type.includes('IP Transit'));
            // Check for Metro sites with isNeucentrix
            const hasNeucentrix = services.some(s => 
                (s.type === 'Metro Ethernet' && s.sites && s.sites.some(site => site.isNeucentrix))
            );
            const hasAstinetAll = services.some(s => s.type.toLowerCase().includes('astinet'));
            const hasSipTrunk = services.some(s => s.type === 'SIP Trunk');
            const hasWMS = services.some(s => s.type === 'WMS');
            const hasWMSFit = services.some(s => s.type === 'WMS Fit');
            const hasWMSLite = services.some(s => s.type === 'WMS Lite');
            const isWMSFamily = hasWMS || hasWMSFit || hasWMSLite;

            // VPN IP CoS Logic
            const vpnIpServices = services.filter(s => s.type === 'VPN IP');
            const vpnCosTypes = [...new Set(vpnIpServices.map(s => s.vpnCos || 'Best Effort'))];

            if (hasMetroE) slgItems.push("Metro E : 99.5%");
            if (hasIpTransit) slgItems.push("IP Transit : 99.5%");
            if (hasNeucentrix) slgItems.push("Neucentrix: 99.74%");
            if (hasAstinetAll) slgItems.push("Astinet (all) : 95%");
            if (hasSipTrunk) slgItems.push("SIPTrunk : 95%");
            if (hasWMS) slgItems.push("WMS : 99%");
            if (hasWMSFit) slgItems.push("WMS Fit : 99%");
            if (hasWMSLite) slgItems.push("WMS Lite : 99%");

            const termsList = [
                ...(hasWMS ? ["Layanan WMS sudah termasuk perangkat Access Point dan manage service dari Telkom."] : []),
                ...(hasWMSFit ? [
                    "Layanan WMS Fit mendukung 6 metode login fleksibel (portal) + WPA2-PSK (non-portal).",
                    "Layanan WMS Fit menggunakan SSID single khusus venue."
                ] : []),
                ...(hasWMSLite ? [
                    "Layanan WMS Lite mendukung kapasitas hingga 32 pengguna.",
                    "Layanan WMS Lite mendukung 6 metode login fleksibel (portal).",
                    "Layanan WMS Lite memiliki radius jangkauan 15 meter (indoor).",
                    "Layanan WMS Lite menggunakan SSID single khusus venue."
                ] : []),
                // VPN IP CoS Terms
                ...(vpnCosTypes.includes('Interactive') ? [
                    "VPN IP Interactive: Untuk aplikasi real time yang mendukung trafik yang memiliki sensitivitas terhadap delay dan jitter (IP PBX, IP VICON). Application: Voice calls & Video Conferencing."
                ] : []),
                ...(vpnCosTypes.includes('Critical') ? [
                    "VPN IP Critical: Mendukung mission-critical aplikasi enterprise yang bersifat interactive atau time dependent serta aplikasi-aplikasi bisnis (Intranet, Extranet, Disaster Recovery Service, Carrier Interconnection). Application: SAP, Siebel, Oracle, Baan, People Soft, JD Edward, Citric Client/Server Applications, Webbased Application Messaging dll."
                ] : []),
                ...(vpnCosTypes.includes('Best Effort') ? [
                    "VPN IP Best EFFORT: Mendukung aplikasi non-critical dan non delay sensitive (Intranet, Extranet). Application: Microsoft Exchange, FTP, HTTP, SMTP, Angle, Mail."
                ] : []),

                "Seluruh Biaya belum termasuk PPN (11%).",
                isWMSFamily 
                    ? "End Delivery berupa Access Point saja yang disediakan Telkom TANPA interface port LAN-Ethernet." 
                    : "End Delivery berupa modem yang disediakan Telkom dengan interface port LAN-Ethernet.",
                isWMSFamily 
                    ? "Kabel LAN Ethernet, perangkat router, mikrotik, switch, catuan sumber listrik, Instalasi Kabel Gedung (IKG) dan CPE lainnya merupakan tanggungan Pelanggan."
                    : "Kabel LAN Ethernet, perangkat router, mikrotik, access point, catuan listrik, Instalasi Kabel Gedung (IKG) dan CPE lainnya merupakan tanggungan Pelanggan.",
                `Masa berlaku penawaran 20 hari sejak tanggal surat ini. (Lama berlangganan: ${subscriptionDuration})`,
                "Penawaran bersifat terbatas/rahasia tidak diperkenankan disebarluaskan.",
                ...(slgItems.length > 0 ? [{
                    title: "Service Level Guarantee Availability:",
                    items: slgItems
                }] : [])
            ];
            // -----------------------------


            // Prepare Header (Text Fallback)
            let headerChildren = [];
            if (headerChildren.length === 0) {
                headerChildren = [
                    new TextRun({
                        text: "Telkom Indonesia",
                        bold: true,
                        size: 48, // 24pt
                        font: "Gotham Rounded Medium",
                        color: "000000"
                    })
                ];
            }


            // --- Local Loop Calculation ---
            const localLoopRows = [];
            let totalLocalLoopMrc = 0;
            let localLoopIndex = 1;

            const headerLocalLoopRow = new TableRow({
                children: [
                    "No", "Layanan", "Lokasi / Site", "Jarak (km)", "Harga/km (Rp)", "Total (Rp)"
                ].map(text => new TableCell({
                    children: [new Paragraph({ 
                        children: [new TextRun({ text, bold: true, color: "FFFFFF", font: "Aptos Narrow", size: 20 })], 
                        alignment: AlignmentType.CENTER 
                    })],
                    shading: { fill: "CC0000" }, 
                    verticalAlign: VerticalAlign.CENTER,
                    margins: { top: 100, bottom: 100, left: 100, right: 100 }
                }))
            });

            services.forEach(service => {
                const qty = service.quantity || 1;
                if ((service.type.toLowerCase().includes('astinet') || service.type.includes('IP Transit') || service.type === 'VPN IP') && service.distanceKm > 5) {
                     const dist = parseFloat(service.distanceKm);
                     const chargeableDist = dist - 5;
                     const cost = chargeableDist * 750000 * qty;
                     totalLocalLoopMrc += cost;
                     
                     localLoopRows.push(new TableRow({
                         children: [
                             new TableCell({ children: [new Paragraph({ text: (localLoopIndex++).toString(), alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                             new TableCell({ children: [new Paragraph({ text: service.type, alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                             new TableCell({ children: [new Paragraph({ text: service.location || "-", alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                             new TableCell({ children: [new Paragraph({ text: `${dist} km (Chargeable: ${chargeableDist.toFixed(1)} km)`, alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                             new TableCell({ children: [new Paragraph({ text: "750.000", alignment: AlignmentType.RIGHT, font: "Aptos Narrow" })] }),
                             new TableCell({ children: [new Paragraph({ text: cost.toLocaleString('id-ID'), alignment: AlignmentType.RIGHT, font: "Aptos Narrow" })] }),
                         ]
                     }));
                } else if (service.type === 'Metro Ethernet') {
                    service.sites.forEach(site => {
                        if (site.distanceKm > 5) {
                             const dist = parseFloat(site.distanceKm);
                             const chargeableDist = dist - 5;
                             const cost = chargeableDist * 950000 * qty;
                             totalLocalLoopMrc += cost;

                             localLoopRows.push(new TableRow({
                                 children: [
                                     new TableCell({ children: [new Paragraph({ text: (localLoopIndex++).toString(), alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                                     new TableCell({ children: [new Paragraph({ text: "Metro Ethernet", alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                                     new TableCell({ children: [new Paragraph({ text: site.name, alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                                     new TableCell({ children: [new Paragraph({ text: `${dist} km (Chargeable: ${chargeableDist.toFixed(1)} km)`, alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                                     new TableCell({ children: [new Paragraph({ text: "950.000", alignment: AlignmentType.RIGHT, font: "Aptos Narrow" })] }),
                                     new TableCell({ children: [new Paragraph({ text: cost.toLocaleString('id-ID'), alignment: AlignmentType.RIGHT, font: "Aptos Narrow" })] }),
                                 ]
                             }));
                        }
                    });
                }
            });

            if (localLoopRows.length > 0) {
                localLoopRows.unshift(headerLocalLoopRow);
                
                // Add Total Row for Local Loop
                 localLoopRows.push(new TableRow({
                    children: [
                        new TableCell({ 
                            columnSpan: 5,
                            children: [new Paragraph({ text: "Total Biaya Local Loop (Bulanan)", alignment: AlignmentType.RIGHT, bold: true, font: "Aptos Narrow" })] 
                        }),
                        new TableCell({ children: [new Paragraph({ text: totalLocalLoopMrc.toLocaleString('id-ID'), alignment: AlignmentType.RIGHT, bold: true, font: "Aptos Narrow" })] }),
                    ]
                }));
            }

            const doc = new Document({
                fonts: [
                    { name: "Gotham Rounded Family", data: base64ToUint8Array(GOTHAM_BOLD_B64) },
                    { name: "Gotham Rounded Book", data: base64ToUint8Array(GOTHAM_BOOK_B64) },
                    { name: "Gotham Rounded Medium", data: base64ToUint8Array(GOTHAM_MEDIUM_B64) }
                ],
                styles: {
                    default: {
                        document: {
                            run: {
                                font: "Aptos Narrow",
                            },
                        },
                    },
                },
                sections: [{
                    properties: {},
                    children: [
                        // Header Logo
                        new Paragraph({
                            alignment: AlignmentType.RIGHT,
                            children: headerChildren,
                        }),
                        new Paragraph({ text: "" }), // Spacer

                        // Date
                        new Paragraph({
                            text: `Jakarta, ${dateStr}`,
                            spacing: { after: 200 },
                            font: "Aptos Narrow",
                        }),

                        // Subject
                        new Paragraph({
                            children: [
                                new TextRun({ text: "Perihal : Surat Penawaran Harga - Layanan Telkom", bold: true, font: "Aptos Narrow" })
                            ],
                            spacing: { after: 200 }
                        }),

                        // Quote Number (Optional)
                        ...(quoteNumber ? [
                            new Paragraph({
                                children: [
                                    new TextRun({ text: `Nomor Quote : ${quoteNumber}`, bold: true, font: "Aptos Narrow" })
                                ],
                                spacing: { after: 200 }
                            })
                        ] : []),

                        // Recipient
                        new Paragraph({ text: "Kepada Yth.", font: "Aptos Narrow" }),
                        new Paragraph({ text: "Manajemen", font: "Aptos Narrow", strike: true }), // Mimic the red squiggle/edit in image? No, just clean text.
                        new Paragraph({ text: customerName.toUpperCase(), bold: true, font: "Aptos Narrow" }),
                        new Paragraph({ text: "Di Tempat", font: "Aptos Narrow", spacing: { after: 300 } }),

                        // Opening
                        new Paragraph({
                            children: [
                                new TextRun({ text: "Kami mengucapkan terima kasih atas kepercayaan yang diberikan oleh ", font: "Aptos Narrow" }),
                                new TextRun({ text: customerName.toUpperCase(), bold: true, font: "Aptos Narrow" }),
                                new TextRun({ text: " kepada PT Telkom Indonesia untuk dapat bekerjasama dalam penyediaan layanan telekomunikasi.", font: "Aptos Narrow" })
                            ],
                            alignment: AlignmentType.JUSTIFIED,
                            spacing: { after: 200 }
                        }),

                        new Paragraph({
                            text: `Sehubungan dengan informasi kebutuhan layanan ${serviceNamesString} yang kami terima, bersama ini kami sampaikan penawaran layanan untuk ${customerName.toUpperCase()} sebagai berikut :`,
                            alignment: AlignmentType.JUSTIFIED,
                            font: "Aptos Narrow",
                            spacing: { after: 300 }
                        }),

                        // Services Tables
                        ...services.flatMap((service, index) => {
                            // Logic to determine rows
                            // If Metro Ethernet, we might have multiple rows (sites)
                            // If Astinet, usually 1 row per service entry unless user added multiple sites logic to astinet too? 
                            // Current form allows adding "Sites" only to Metro. Other services have "Location".
                            
                            const isMetro = service.type === 'Metro Ethernet';
                            const rows = [];
                            
                            // Header Row
                                    const bwUnit = service.type === 'SL WDM' ? "Gbps" : "Mbps";
                                    const col4Header = service.type === 'SIP Trunk' ? "Spesifikasi" : `BW (${bwUnit})`;
                                    
                                    const isAstinet = service.type.toLowerCase().includes('astinet') || service.type.includes('IP Transit');
                                    const headerCols = ["No", "List Kebutuhan", "Site / Lokasi", col4Header, "Harga Aktivasi (Rp)", "Harga Bulanan (Rp)"];
                                    if (!isAstinet) headerCols.push("Ket");

                                    const headerRow = new TableRow({
                                        children: headerCols.map(text => new TableCell({
                                            children: [new Paragraph({ 
                                                children: [new TextRun({ text, bold: true, color: "FFFFFF", font: "Aptos Narrow", size: 20 })], 
                                                alignment: AlignmentType.CENTER 
                                            })],
                                            shading: { fill: "CC0000" }, // Red background
                                            verticalAlign: VerticalAlign.CENTER,
                                            margins: { top: 100, bottom: 100, left: 100, right: 100 }
                                        }))
                                    });
                                    rows.push(headerRow);

                            // Data Rows
                            let totalOtc = 0;
                            let totalMrc = 0;

                            const qty = service.quantity || 1;

                            if (isMetro) {
                                // Calculate isInter for SPH context
                                const zones = service.sites.map(s => s.zone || '').filter(z => z);
                                const uniqueZones = new Set(zones);
                                const isInter = uniqueZones.size > 1;

                                service.sites.forEach((site, i) => {
                                    // Calculate per-site MRC
                                    let siteMrc = 0;
                                    const bwVal = parseBandwidth(site.bandwidth);
                                    
                                    if (bwVal > 0) {
                                        const zone = site.zone || 'Jabodetabek';
                                        const isNeucentrix = site.isNeucentrix || false;
                                        const priceObj = getMetroPriceObject(zone, bwVal, isInter, isNeucentrix);

                                        if (priceObj) {
                                            const qos = service.metroQos || 'Interactive';
                                            const typeKey = qos === 'Interactive' ? 'int' : 'be';
                                            let basePrice = priceObj[typeKey];
                                            
                                            if (zone === 'Sulawesi Selatan' && !isNeucentrix) {
                                                basePrice = basePrice * 1.3;
                                            }
                                            
                                            siteMrc = basePrice;
                                        }
                                    }

                                    // Apply Temporary Pricing
                                    if (isDaily) {
                                        siteMrc = Math.round(siteMrc * priceMultiplier);
                                    }
                                    
                                    // Handle OTC (Per Site)
                                    const siteOtc = parseFloat(service.otc) || 0;

                                    totalOtc += siteOtc * qty;
                                    totalMrc += siteMrc * qty;

                                    rows.push(new TableRow({
                                        children: [
                                            new TableCell({ children: [new Paragraph({ text: (i + 1).toString(), alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                                            new TableCell({ children: [new Paragraph({ text: `${service.type}${qty > 1 ? ` (x${qty})` : ''}`, alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                                            new TableCell({ children: [new Paragraph({ text: `${site.name} (${site.zone || 'Jabodetabek'})${site.isNeucentrix ? ' - Metro Neucentrix' : ''}`, alignment: AlignmentType.CENTER, bold: true, font: "Aptos Narrow" })] }),
                                            new TableCell({ children: [new Paragraph({ text: site.bandwidth.replace(/\D/g,''), alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }), 
                                            new TableCell({ children: [new Paragraph({ text: siteOtc > 0 ? (siteOtc * qty).toLocaleString('id-ID') : "-", alignment: AlignmentType.RIGHT, font: "Aptos Narrow" })] }),
                                            new TableCell({ children: [new Paragraph({ text: (siteMrc * qty).toLocaleString('id-ID'), alignment: AlignmentType.RIGHT, font: "Aptos Narrow" })] }),
                                            new TableCell({ children: [new Paragraph({ text: i === 0 ? "Backhaul" : "Site", alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }), 
                                        ]
                                    }));
                                });
                            } else {
                                // Non-Metro (Astinet etc)
                                const otc = parseFloat(service.otc) || 0;
                                let mrc = parseFloat(service.mrc) || 0;

                                // Apply Temporary Pricing Logic
                                if (isDaily) {
                                    mrc = Math.round(mrc * priceMultiplier);
                                }

                                totalOtc = otc * qty;
                                totalMrc = mrc * qty;

                                const rowCells = [
                                        new TableCell({ children: [new Paragraph({ text: "1", alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                                        new TableCell({ children: [new Paragraph({ text: `${service.type}${qty > 1 ? ` (x${qty})` : ''}`, alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }),
                                        new TableCell({ children: [new Paragraph({ text: service.isNeucentrix ? "Neucentrix (National)" : (service.zone || service.location || "-"), alignment: AlignmentType.CENTER, bold: true, font: "Aptos Narrow" })] }),
                                        new TableCell({ 
                                            children: [
                                                new Paragraph({ 
                                                    children: (service.type === 'Astinet Beda Bandwidth' || service.type === 'IP Transit Beda Bandwidth')
                                                        ? service.bandwidth.split('|').map((part, idx) => new TextRun({ text: part.trim(), break: idx > 0 ? 1 : 0, font: "Aptos Narrow" }))
                                                        : [new TextRun({ text: service.type === 'SIP Trunk' ? `${service.jumlahNomor || 3} No / ${service.concurrentCall || 3} CC / ${service.ipAddress || 1} IP / ${service.sipTrunkType || 'Standard'}` : service.bandwidth.replace(/\D/g,''), font: "Aptos Narrow" })],
                                                    alignment: AlignmentType.CENTER 
                                                })
                                            ] 
                                        }),
                                        new TableCell({ children: [new Paragraph({ text: (otc * qty).toLocaleString('id-ID'), alignment: AlignmentType.RIGHT, font: "Aptos Narrow" })] }),
                                        new TableCell({ children: [new Paragraph({ text: (mrc * qty).toLocaleString('id-ID'), alignment: AlignmentType.RIGHT, font: "Aptos Narrow" })] }),
                                ];
                                if (!isAstinet) {
                                    rowCells.push(new TableCell({ children: [new Paragraph({ text: service.remarks || "-", alignment: AlignmentType.CENTER, font: "Aptos Narrow" })] }));
                                }
                                
                                rows.push(new TableRow({
                                    children: rowCells
                                }));
                            }

                            // Total Row
                            const contractDuration = isDaily ? 1 : (parseInt(subscriptionDuration) || 12);
                            const totalContract = totalOtc + (totalMrc * contractDuration);

                            const totalRowCells = [
                                    new TableCell({ 
                                        columnSpan: 4,
                                        children: [new Paragraph({ text: "Total Bulanan", alignment: AlignmentType.RIGHT, bold: true, font: "Aptos Narrow" })] 
                                    }),
                                    new TableCell({ children: [new Paragraph({ text: totalOtc.toLocaleString('id-ID'), alignment: AlignmentType.RIGHT, font: "Aptos Narrow" })] }),
                                    new TableCell({ children: [new Paragraph({ text: totalMrc.toLocaleString('id-ID'), alignment: AlignmentType.RIGHT, font: "Aptos Narrow" })] }),
                            ];
                            if (!isAstinet) {
                                totalRowCells.push(new TableCell({ children: [new Paragraph({ text: "", font: "Aptos Narrow" })] }));
                            }

                            rows.push(new TableRow({
                                children: totalRowCells
                            }));

                            // Contract Total Row
                            const contractRowCells = [
                                    new TableCell({ 
                                        columnSpan: 4,
                                        children: [new Paragraph({ text: `Total Biaya Selama ${subscriptionDuration}`, alignment: AlignmentType.RIGHT, bold: true, font: "Aptos Narrow" })] 
                                    }),
                                    new TableCell({ 
                                        columnSpan: 2,
                                        children: [new Paragraph({ text: totalContract.toLocaleString('id-ID'), alignment: AlignmentType.RIGHT, bold: true, font: "Aptos Narrow" })] 
                                    }),
                            ];
                            if (!isAstinet) {
                                contractRowCells.push(new TableCell({ children: [new Paragraph({ text: "", font: "Aptos Narrow" })] }));
                            }

                            rows.push(new TableRow({
                                children: contractRowCells
                            }));

                            return [
                                new Paragraph({
                                    children: [new TextRun({ text: (service.type === 'Metro Ethernet' || service.type === 'SIP Trunk') ? service.type : `${service.type} ${service.bandwidth}`, bold: true, size: 24, font: "Aptos Narrow" })],
                                    spacing: { before: 200, after: 100 }
                                }),
                                new Table({
                                    rows: rows,
                                    width: { size: 100, type: WidthType.PERCENTAGE },
                                })
                            ];
                        }),

                        // Local Loop Table
                        ...(localLoopRows.length > 0 ? [
                            new Paragraph({
                                children: [new TextRun({ text: "Biaya Local Loop / Last Mile*", bold: true, size: 24, font: "Aptos Narrow" })],
                                spacing: { before: 200, after: 50 }
                            }),
                            new Paragraph({
                                children: [new TextRun({ text: "*(Tarif tambahan apabila di atas 5 km dari site Telkom terdekat ke lokasi pelanggan)", italics: true, size: 16, font: "Aptos Narrow" })],
                                spacing: { after: 100 }
                            }),
                            new Table({
                                rows: localLoopRows,
                                width: { size: 100, type: WidthType.PERCENTAGE },
                            }),
                            new Paragraph({ text: "", spacing: { after: 0 } })
                        ] : []),

                        // Grand Total (only if > 1 service or Local Loop exists)
                        ...(services.length > 1 || totalLocalLoopMrc > 0 ? [
                            new Table({
                                rows: [
                                    // Row 1: Total OTC
                                    new TableRow({
                                        children: [
                                            new TableCell({ 
                                                children: [new Paragraph({ text: "Total OTC", bold: true, font: "Aptos Narrow", alignment: AlignmentType.RIGHT })],
                                                columnSpan: grandTotalLabelSpan,
                                                shading: { fill: "E0E0E0" },
                                                verticalAlign: VerticalAlign.CENTER
                                            }),
                                            new TableCell({ 
                                                children: [new Paragraph({ text: services.reduce((acc, s) => {
                                                    let sum = 0;
                                                    const qty = s.quantity || 1;
                                                    if (s.type === 'Metro Ethernet') {
                                                        s.sites.forEach(() => sum += parseFloat(s.otc) || 0);
                                                    } else {
                                                        sum += parseFloat(s.otc) || 0;
                                                    }
                                                    return acc + (sum * qty);
                                                }, 0).toLocaleString('id-ID'), bold: true, font: "Aptos Narrow", alignment: AlignmentType.RIGHT })],
                                                columnSpan: 2,
                                                shading: { fill: "E0E0E0" },
                                                verticalAlign: VerticalAlign.CENTER
                                            })
                                        ]
                                    }),
                                    // Row 2: Total Bulanan
                                    new TableRow({
                                        children: [
                                            new TableCell({ 
                                                children: [new Paragraph({ text: `Total Bulanan (apabila deal ${services.length} layanan di atas sekaligus)`, bold: true, font: "Aptos Narrow", alignment: AlignmentType.RIGHT })],
                                                columnSpan: grandTotalLabelSpan,
                                                shading: { fill: "E0E0E0" },
                                                verticalAlign: VerticalAlign.CENTER
                                            }),
                                            new TableCell({ 
                                                children: [new Paragraph({ text: services.reduce((acc, s) => {
                                                    let mrc = parseFloat(s.mrc) || 0;
                                                    const qty = s.quantity || 1;
                                                    if (isDaily) mrc = Math.round(mrc * priceMultiplier);
                                                    return acc + (mrc * qty);
                                                }, totalLocalLoopMrc).toLocaleString('id-ID'), bold: true, font: "Aptos Narrow", alignment: AlignmentType.RIGHT })],
                                                columnSpan: 2,
                                                shading: { fill: "E0E0E0" },
                                                verticalAlign: VerticalAlign.CENTER
                                            })
                                        ]
                                    }),
                                    // Row 3: Total Biaya Selama X Bulan
                                    new TableRow({
                                        children: [
                                            new TableCell({ 
                                                children: [new Paragraph({ text: `Total Biaya Selama ${subscriptionDuration.toUpperCase()}`, bold: true, font: "Aptos Narrow", alignment: AlignmentType.RIGHT })],
                                                columnSpan: grandTotalLabelSpan,
                                                shading: { fill: "E0E0E0" },
                                                verticalAlign: VerticalAlign.CENTER
                                            }),
                                            new TableCell({ 
                                                children: [new Paragraph({ text: services.reduce((acc, s) => {
                                                    const contractDuration = isDaily ? 1 : (parseInt(subscriptionDuration) || 12);
                                                    let otc = 0;
                                                     let mrc = parseFloat(s.mrc) || 0;
                                                     const qty = s.quantity || 1;

                                                     if (s.type === 'Metro Ethernet') {
                                                         s.sites.forEach(() => {
                                                             otc += parseFloat(s.otc) || 0;
                                                         });
                                                     } else {
                                                         otc += parseFloat(s.otc) || 0;
                                                     }
                                                    
                                                    if (isDaily) {
                                                        mrc = Math.round(mrc * priceMultiplier);
                                                    }

                                                    return acc + ((otc + (mrc * contractDuration)) * qty);
                                                }, totalLocalLoopMrc * (isDaily ? 1 : (parseInt(subscriptionDuration) || 12))).toLocaleString('id-ID'), bold: true, font: "Aptos Narrow", alignment: AlignmentType.RIGHT })],
                                                columnSpan: 2,
                                                shading: { fill: "E0E0E0" },
                                                verticalAlign: VerticalAlign.CENTER
                                            })
                                        ]
                                    })
                                ],
                                width: { size: 100, type: WidthType.PERCENTAGE },
                            })
                        ] : []),

                        // Terms
                        new Paragraph({
                            text: `Syarat dan Ketentuan Layanan :`,
                            spacing: { before: 300, after: 100 },
                            italics: true,
                            font: "Aptos Narrow",
                            size: 20
                        }),
                        ...termsList.flatMap((term, i) => {
                            if (typeof term === 'string') {
                                return [new Paragraph({
                                    text: `${i + 1}. ${term}`,
                                    italics: true,
                                    font: "Aptos Narrow",
                                    size: 20,
                                    spacing: { after: 50 },
                                    indent: { left: 720, hanging: 360 } // Indentation
                                })];
                            } else {
                                return [
                                    new Paragraph({
                                        text: `${i + 1}. ${term.title}`,
                                        italics: true,
                                        font: "Aptos Narrow",
                                        size: 20,
                                        spacing: { after: 50 },
                                        indent: { left: 720, hanging: 360 }
                                    }),
                                    ...term.items.map((sub, j) => new Paragraph({
                                        text: `${String.fromCharCode(97 + j)}. ${sub}`,
                                        italics: true,
                                        font: "Aptos Narrow",
                                        size: 20,
                                        spacing: { after: 50 },
                                        indent: { left: 1440, hanging: 360 } // Double indentation
                                    }))
                                ];
                            }
                        }),

                        // Closing
                        new Paragraph({
                            text: `Demikian informasi ini kami sampaikan, besar harapan kami dapat selalu memenuhi kebutuhan ${customerName.toUpperCase()} melalui layanan yang kami berikan. Atas perhatiannya kami ucapkan terima kasih.`,
                            spacing: { before: 300, after: 300 },
                            alignment: AlignmentType.JUSTIFIED,
                            font: "Aptos Narrow"
                        }),

                        // Signature
                        new Paragraph({ text: "Hormat saya,", font: "Aptos Narrow", spacing: { after: 300 } }),
                        new Paragraph({ 
                            children: [
                                new TextRun({ text: amName, bold: true, size: 48, font: "Mistral" })
                            ]
                        }), 
                        new Paragraph({ text: "Account Manager", italics: true, font: "Aptos Narrow" }),
                        new Paragraph({ text: "Witel Jakarta Centrum", italics: true, font: "Aptos Narrow" }),
                    ]
                }]
            });

            const blob = await Packer.toBlob(doc);
            window.saveAs(blob, `SPH_Telkom_${customerName.replace(/\s+/g, '_')}.docx`);
            } catch (error) {
                console.error("Error generating SPH:", error);
                alert("Gagal membuat dokumen: " + error.message + "\n\nCek konsol browser untuk detail.");
            }
        };

        // --- Components ---

        const FormattedNumberInput = ({ value, onChange, placeholder, className, style }) => {
            // Format number with commas
            const format = (val) => {
                if (val === undefined || val === null || val === '') return '';
                // Handle 0 explicitly if needed, but '0' -> '0' is fine.
                // Convert to string and add commas
                return val.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            };

            const handleChange = (e) => {
                // Remove commas and non-digits (except maybe dot if we supported decimals, but usually prices are integers here)
                const raw = e.target.value.replace(/,/g, '');
                
                // Allow empty string to clear input
                if (raw === '') {
                    onChange('');
                    return;
                }

                // Only allow digits
                if (/^\d+$/.test(raw)) {
                    onChange(parseInt(raw, 10)); // Store as number
                }
            };

            return (
                <input
                    type="text"
                    value={format(value)}
                    onChange={handleChange}
                    placeholder={placeholder}
                    className={className}
                    style={style}
                />
            );
        };

        const BandwidthSelector = ({ value, isCustom, onValueChange, onCustomChange, serviceType, options }) => {
            const bwOptions = options || (serviceType === 'SL WDM' ? SL_WDM_BANDWIDTH_OPTIONS : 
                              (serviceType === 'VPN IP' ? VPN_IP_BANDWIDTH_OPTIONS : BANDWIDTH_OPTIONS));

            const getUnit = (val, type) => {
                const match = val.match(/(Kbps|Mbps|Gbps)/i);
                if (match) return match[0];
                if (type === 'SL WDM') return 'Gbps';
                if (type === 'VPN IP') return 'Kbps';
                return 'Mbps';
            };

            return (
                <div className="flex gap-2" style={{flex:1}}>
                    <select
                        value={!isCustom && bwOptions.includes(value) ? value : 'Custom'}
                        onChange={(e) => {
                            const val = e.target.value;
                            if (val === 'Custom') {
                                onCustomChange(true);
                            } else {
                                onValueChange(val);
                                onCustomChange(false);
                            }
                        }}
                        className="form-control"
                        style={isCustom ? {flex: '0 0 90px'} : {flex:1}}
                    >
                        {bwOptions.map(opt => (
                            <option key={opt} value={opt}>{opt}</option>
                        ))}
                        <option value="Custom">Custom</option>
                    </select>
                    {(isCustom || !bwOptions.includes(value)) && (
                        <div className="flex gap-2" style={{flex:1}}>
                            <input
                                type="number"
                                value={parseFloat(value) || ''}
                                onChange={(e) => {
                                    const val = e.target.value;
                                    const unit = getUnit(value, serviceType);
                                    onValueChange(val ? `${val} ${unit}` : '');
                                }}
                                className="form-control"
                                placeholder="Nilai"
                                style={{flex:1}}
                            />
                            <select
                                value={getUnit(value, serviceType)}
                                onChange={(e) => {
                                    const unit = e.target.value;
                                    const val = parseFloat(value) || 0;
                                    onValueChange(`${val} ${unit}`);
                                }}
                                className="form-control"
                                style={{width: '100px'}}
                            >
                                <option value="Kbps">Kbps</option>
                                <option value="Mbps">Mbps</option>
                                <option value="Gbps">Gbps</option>
                            </select>
                        </div>
                    )}
                </div>
            );
        };



        function App() {
            const [isGenerating, setIsGenerating] = useState(false);



            const [formData, setFormData] = useState({
                amName: '',
                customerName: '',
                quoteNumber: '',
                subscriptionDuration: '12 Bulan',
            });

            const [isAmCustom, setIsAmCustom] = useState(false);

            const [services, setServices] = useState([
                {
                    id: Date.now(),
                    type: 'Astinet',
                    bandwidth: '100 Mbps',
                    location: '',
                    sites: [],
                    otc: 2500000,
                    mrc: 1000000,
                    remarks: '',
                    quantity: 1,
                    isCustomBandwidth: false,
                    bandwidthGlobal: '',
                    bandwidthDomestik: '',
                    isCustomBandwidthGlobal: false,
                    isCustomBandwidthDomestik: false,
                    discountPercent: 0
                }
            ]);

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const addService = () => {
                setServices(prev => [
                    ...prev,
                    {
                        id: Date.now() + Math.random(),
                        type: 'Astinet',
                        bandwidth: '100 Mbps',
                        location: '',
                        sites: [],
                        otc: 2500000,
                        mrc: 0,
                        remarks: '',
                        quantity: 1,
                        isCustomBandwidth: false,
                        jumlahNomor: 3,
                        concurrentCall: 3,
                        ipAddress: 1,
                        sipTrunkType: 'Standard',
                        bandwidthGlobal: '',
                        bandwidthDomestik: '',
                        isCustomBandwidthGlobal: false,
                        isCustomBandwidthDomestik: false,
                        vpnType: 'Standard',
                        vpnCos: 'Best Effort',
                        localLoopPrice: 0,
                        discountPercent: 0
                    }
                ]);
            };

            const removeService = (id) => {
                setServices(prev => prev.filter(s => s.id !== id));
            };


            const calculateMetroPrice = (service) => {
                const qos = service.metroQos || 'Interactive';
                let totalMrc = 0;
                
                // Determine Inter/Intra
                const zones = service.sites.map(s => s.zone || '').filter(z => z);
                const uniqueZones = new Set(zones);
                const isInter = uniqueZones.size > 1;
                
                service.sites.forEach(site => {
                    const bwVal = parseBandwidth(site.bandwidth);
                    if (bwVal > 0) {
                        const zone = site.zone || 'Jabodetabek';
                        const isNeucentrix = site.isNeucentrix || false;
                        const priceObj = getMetroPriceObject(zone, bwVal, isInter, isNeucentrix);

                        if (priceObj) {
                            const typeKey = qos === 'Interactive' ? 'int' : 'be';
                            let basePrice = priceObj[typeKey];
                            
                            // Multiplier for Sulawesi Selatan (NOT applicable if Neucentrix)
                            if (zone === 'Sulawesi Selatan' && !isNeucentrix) {
                                basePrice = basePrice * 1.3;
                            }
                            
                            totalMrc += basePrice;
                        }
                    }
                });
                
                return totalMrc;
            };

            const updateService = (id, field, value) => {
                setServices(prev => prev.map(s => {
                    if (s.id === id) {
                        const updated = { ...s, [field]: value };
                        
                        // Logic for Astinet & Astinet Lite & Astinet Fit Auto-Pricing
                        if (['Astinet', 'Astinet Lite', 'Astinet Fit'].includes(updated.type)) {
                            if (field === 'bandwidth' || field === 'location' || field === 'type') {
                                const bwVal = parseBandwidth(updated.bandwidth);
                                let pricingTable = null;
                                if (updated.type === 'Astinet') pricingTable = ASTINET_PRICING;
                                else if (updated.type === 'Astinet Lite') pricingTable = ASTINET_LITE_PRICING;
                                else if (updated.type === 'Astinet Fit') pricingTable = ASTINET_FIT_PRICING;

                                if (bwVal > 0 && updated.location && pricingTable) {
                                    // Handle Special Zones (NTT & Sulawesi Selatan)
                                    let lookupLocation = updated.location;
                                    let multiplier = 1.0;
                                    
                                    if (updated.location === 'NTT') {
                                        // Astinet Standard has explicit NTT prices.
                                        // Lite and Fit have explicit NTT prices ONLY for 100 Mbps, otherwise fallback to Kalimantan & KTI.
                                        const isSpecialLiteFit = (updated.type === 'Astinet Lite' || updated.type === 'Astinet Fit') && bwVal === 100;
                                        
                                        if (updated.type !== 'Astinet' && !isSpecialLiteFit) {
                                            lookupLocation = 'Kalimantan & KTI';
                                        }
                                    } else if (updated.location === 'Sulawesi Selatan') {
                                        lookupLocation = 'Kalimantan & KTI';
                                        multiplier = 1.3;
                                    }

                                    const price = calculateInterpolatedPrice(bwVal, lookupLocation, pricingTable);
                                    if (price !== null) {
                                        updated.mrc = Math.round(price * multiplier);
                                    } else {
                                        updated.mrc = '';
                                    }
                                } else if (field === 'location' && value === '') {
                                    updated.mrc = '';
                                }
                            }
                        }



                        // Logic for IP Transit Auto-Pricing
                        if (updated.type === 'IP Transit') {
                            if (field === 'bandwidth' || field === 'zone' || field === 'isNeucentrix' || field === 'type') {
                                // Enforce Neucentrix constraint
                                if (field === 'zone' && (value === 'Sulawesi Selatan' || value === 'NTT')) {
                                    updated.isNeucentrix = false;
                                }
                                if (field === 'isNeucentrix' && value === true && (updated.zone === 'Sulawesi Selatan' || updated.zone === 'NTT')) {
                                    updated.isNeucentrix = false;
                                }

                                const bwVal = parseBandwidth(updated.bandwidth);
                                const zone = updated.zone || 'JaBoDeTaBek';
                                const isNeucentrix = updated.isNeucentrix || false;
                                
                                if (bwVal > 0) {
                                    let pricingTable = IP_TRANSIT_PRICING;
                                    let scope = null;
                                    
                                    if (isNeucentrix) {
                                        pricingTable = IP_TRANSIT_NEUCENTRIX_PRICING;
                                        scope = 'price';
                                    } else {
                                        // Standard IP Transit
                                        if (zone === 'JaBoDeTaBek') scope = 'jabodetabek';
                                        else if (zone === 'Jawa') scope = 'jawa';
                                        else if (zone === 'Sumatera') scope = 'sumatera';
                                        else scope = 'kti'; // Kalimantan & KTI, NTT, Sulawesi Selatan
                                    }
                                    
                                    const price = getInterpolatedPriceIpTransit(pricingTable, bwVal, scope);
                                    
                                    if (price !== null) {
                                        let finalPrice = price;
                                        // Apply 130% for Sulawesi Selatan (Non-Neucentrix)
                                        if (zone === 'Sulawesi Selatan' && !isNeucentrix) {
                                            finalPrice = Math.round(finalPrice * 1.3);
                                        }
                                        updated.mrc = finalPrice;
                                    } else {
                                        updated.mrc = '';
                                    }
                                }
                            }
                        }

                        // Logic for IP Transit Beda Bandwidth
                        if (updated.type === 'IP Transit Beda Bandwidth') {
                             if (['bandwidthGlobal', 'bandwidthDomestik', 'zone', 'isNeucentrix', 'type'].includes(field)) {
                                 // Enforce Neucentrix constraint
                                 if (field === 'zone' && (value === 'Sulawesi Selatan' || value === 'NTT')) {
                                     updated.isNeucentrix = false;
                                 }
                                 if (field === 'isNeucentrix' && value === true && (updated.zone === 'Sulawesi Selatan' || updated.zone === 'NTT')) {
                                     updated.isNeucentrix = false;
                                 }

                                 const bwGlobal = parseBandwidth(updated.bandwidthGlobal);
                                 const bwDomestik = parseBandwidth(updated.bandwidthDomestik);
                                 const zone = updated.zone || 'JaBoDeTaBek';
                                 
                                 // Map user selection to pricing table keys
                                 let pricingZone = zone;
                                 if (zone === 'NTT' || zone === 'Sulawesi Selatan') {
                                     pricingZone = 'Kalimantan & KTI';
                                 }
                                 
                                 if (bwGlobal > 0 && bwDomestik > 0) {
                                     let priceGlobal = null;
                                     let priceDomestik = null;

                                     if (updated.isNeucentrix) {
                                         priceGlobal = getInterpolatedPriceIpTransit(IP_TRANSIT_NEUCENTRIX_BB_PRICING, bwGlobal, 'g');
                                         priceDomestik = getInterpolatedPriceIpTransit(IP_TRANSIT_NEUCENTRIX_BB_PRICING, bwDomestik, 'd');
                                     } else {
                                         priceGlobal = calculateInterpolatedPrice(bwGlobal, pricingZone, IP_TRANSIT_BB_GLOBAL_PRICING);
                                         priceDomestik = calculateInterpolatedPrice(bwDomestik, pricingZone, IP_TRANSIT_BB_DOMESTIK_PRICING);
                                     }
                                     
                                     if (priceGlobal !== null && priceDomestik !== null) {
                                         if (zone === 'Sulawesi Selatan' && !updated.isNeucentrix) {
                                             priceGlobal = priceGlobal * 1.3;
                                             priceDomestik = priceDomestik * 1.3;
                                         }
                                         updated.mrc = Math.round(priceGlobal + priceDomestik);
                                     } else {
                                         updated.mrc = '';
                                     }
                                 } else {
                                     updated.mrc = '';
                                 }

                                 if (updated.bandwidthGlobal || updated.bandwidthDomestik) {
                                     updated.bandwidth = `Global: ${updated.bandwidthGlobal || '-'} | Domestik: ${updated.bandwidthDomestik || '-'}`;
                                 }
                             }
                        }

                        // Logic for Metro Ethernet Auto-Pricing
                        if (updated.type === 'Metro Ethernet') {
                            if (field === 'type' || field === 'metroQos') {
                                updated.mrc = calculateMetroPrice(updated);
                            }
                        }

                        // Logic for Astinet Beda Bandwidth Auto-Pricing
                        if (updated.type === 'Astinet Beda Bandwidth') {
                             if (['bandwidthGlobal', 'bandwidthDomestik', 'location'].includes(field)) {
                                 const bwGlobal = parseBandwidth(updated.bandwidthGlobal);
                                 const bwDomestik = parseBandwidth(updated.bandwidthDomestik);
                                 
                                 if (updated.location) {
                                     const priceGlobal = calculateInterpolatedPrice(bwGlobal, updated.location, ASTINET_BB_GLOBAL_PRICING);
                                     const priceDomestik = calculateInterpolatedPrice(bwDomestik, updated.location, ASTINET_BB_DOMESTIK_PRICING);
                                     
                                     if (priceGlobal !== null && priceDomestik !== null) {
                                         updated.mrc = Math.round(priceGlobal + priceDomestik);
                                     } else {
                                         updated.mrc = '';
                                     }
                                 }
                                 
                                 // Update main bandwidth string for DOCX
                                 if (updated.bandwidthGlobal || updated.bandwidthDomestik) {
                                     updated.bandwidth = `Global: ${updated.bandwidthGlobal || '-'} | Domestik: ${updated.bandwidthDomestik || '-'}`;
                                 }
                             }
                        }

                        // Logic for SIP Trunk Auto-Pricing
                        if (updated.type === 'SIP Trunk') {
                             if (['jumlahNomor', 'concurrentCall', 'ipAddress', 'sipTrunkType'].includes(field)) {
                                 const cc = parseInt(updated.concurrentCall) || 0;
                                 const num = parseInt(updated.jumlahNomor) || 0;
                                 const ip = parseInt(updated.ipAddress) || 0;
                                 const type = updated.sipTrunkType || 'Standard';
                                 
                                 let otc = 0;
                                 let mrc = 0;
                                 
                                 // 1. CC OTC
                                 if (cc >= 3 && cc <= 50) otc += 3000000;
                                 else if (cc <= 600) otc += 5000000;
                                 else if (cc <= 1000) otc += 6500000;
                                 
                                 // 2. Number OTC
                                 const otcNum = SIPTRUNK_OTC_NUMBER.find(r => num <= r.max);
                                 if (otcNum) otc += otcNum.price;
                                 
                                 // 3. IP OTC
                                 if (ip >= 2 && ip <= 5) otc += 500000;
                                 else if (ip >= 6 && ip <= 12) otc += 1000000;
                                 
                                 // 4. CC MRC
                                 const ccKeys = Object.keys(SIPTRUNK_MRC_CC).map(Number).sort((a,b) => a-b);
                                 const matchedCC = ccKeys.find(k => k >= cc);
                                 if (matchedCC) {
                                     const priceObj = SIPTRUNK_MRC_CC[matchedCC];
                                     mrc += (type === 'HA' ? priceObj.ha : priceObj.standard);
                                 }
                                 
                                 // 5. Number MRC
                                 const mrcNum = SIPTRUNK_MRC_NUMBER.find(r => num <= r.max);
                                 if (mrcNum) mrc += mrcNum.price;
                                 
                                 // 6. IP MRC
                                 if (ip >= 2 && ip <= 5) mrc += 500000;
                                 else if (ip >= 6 && ip <= 12) mrc += 1200000;
                                 
                                 updated.otc = otc;
                                 updated.mrc = mrc;
                             }
                        }

                        // Logic for VPN IP Auto-Pricing
                        if (updated.type === 'VPN IP') {
                             if (field === 'type') {
                                 updated.otc = 2250000;
                                 updated.bandwidth = 1; // Default 1 Mbps
                                 updated.vpnType = 'Standard';
                                 updated.vpnCos = 'Best Effort';
                                 updated.distanceKm = 0;
                                 updated.localLoopPrice = 0;
                                 updated.mrc = 0;
                             }
                             if (['bandwidth', 'vpnType', 'vpnCos', 'distanceKm', 'location'].includes(field)) {
                                  const bwVal = (typeof updated.bandwidth === 'number') ? updated.bandwidth : parseBandwidth(updated.bandwidth);
                                  const type = (updated.vpnType === 'Dual Homing') ? 'dual_homing' : 'standard';
                                  const cos = updated.vpnCos || 'Best Effort';
                                  const dist = parseFloat(updated.distanceKm) || 0;
                                  const loc = updated.location;
                                  
                                  // Calculate Local Loop: (Distance - 5) * 750,000. Min 0.
                                  const chargeableDist = Math.max(0, dist - 5);
                                  const llPrice = Math.round(chargeableDist * 750000);
                                  updated.localLoopPrice = llPrice;
                                  
                                  let servicePrice = 0;
                                  // Lookup in VPN_IP_PRICING
                                  if (loc && VPN_IP_PRICING[type] && VPN_IP_PRICING[type][cos]) {
                                      const table = VPN_IP_PRICING[type][cos];
                                      // Check if table has the key (number or string)
                                      if (table[bwVal]) {
                                          const priceObj = table[bwVal];
                                          if (priceObj[loc]) {
                                              servicePrice = priceObj[loc];
                                          } else if (loc === 'Sumatera' && priceObj['SUMATRA']) {
                                              servicePrice = priceObj['SUMATRA'];
                                          } else if (loc === 'JaBoDeTaBek' && priceObj['JABODETABEK']) {
                                              servicePrice = priceObj['JABODETABEK'];
                                          }
                                      }
                                  }
                                  
                                  updated.mrc = servicePrice;
                             }
                        }

                        // Logic for WMS & WMS Fit Auto-Pricing
                        if (updated.type === 'WMS') {
                             if (field === 'type') {
                                 updated.otc = 500000;
                                 updated.bandwidth = "20 Mbps"; // Default to Silver
                                 updated.mrc = WMS_PACKAGES["WMS Silver"].price;
                                 updated.isCustomBandwidth = false;
                             }
                             
                             if (field === 'bandwidth') {
                                 const pkg = Object.values(WMS_PACKAGES).find(p => p.bandwidth === value);
                                 if (pkg) {
                                     updated.mrc = pkg.price;
                                 }
                             }
                        } else if (updated.type === 'WMS Fit') {
                             if (field === 'type') {
                                 updated.otc = 500000;
                                 updated.bandwidth = "50 Mbps"; // Default to Fit Gold
                                 updated.mrc = WMS_FIT_PACKAGES["WMS Fit Gold"].price;
                                 updated.isCustomBandwidth = false;
                             }
                             
                             if (field === 'bandwidth') {
                                 const pkg = Object.values(WMS_FIT_PACKAGES).find(p => p.bandwidth === value);
                                 if (pkg) {
                                     updated.mrc = pkg.price;
                                 }
                             }
                        } else if (updated.type === 'WMS Lite') {
                             if (field === 'type') {
                                 updated.otc = 500000;
                                 updated.bandwidth = "30 Mbps"; // Default to Silver Lite
                                 updated.mrc = WMS_LITE_PACKAGES["WMS Silver Lite"].price;
                                 updated.isCustomBandwidth = false;
                             }
                             
                             if (field === 'bandwidth') {
                                 const pkg = Object.values(WMS_LITE_PACKAGES).find(p => p.bandwidth === value);
                                 if (pkg) {
                                     updated.mrc = pkg.price;
                                 }
                             }
                        }

                        if (field === 'type') {
                             // Reset price if type changes, as tables might differ (or user switches to non-priced service)
                             // But also re-calculate if switching between Astinet variants
                             if (['Astinet', 'Astinet Lite', 'Astinet Fit'].includes(value)) {
                                  const bwVal = parseBandwidth(updated.bandwidth);
                                  let pricingTable = null;
                                  if (value === 'Astinet') pricingTable = ASTINET_PRICING;
                                  else if (value === 'Astinet Lite') pricingTable = ASTINET_LITE_PRICING;
                                  else if (value === 'Astinet Fit') pricingTable = ASTINET_FIT_PRICING;
 
                                  if (bwVal > 0 && updated.location && pricingTable) {
                                      const price = calculateInterpolatedPrice(bwVal, updated.location, pricingTable);
                                      if (price !== null) {
                                         updated.mrc = Math.round(price);
                                      } else {
                                          updated.mrc = '';
                                      }
                                  }
                             } else if (value === 'Astinet Beda Bandwidth') {
                                 // Reset or recalculate if already has global/domestik
                                 const bwGlobal = parseBandwidth(updated.bandwidthGlobal);
                                 const bwDomestik = parseBandwidth(updated.bandwidthDomestik);
                                 
                                 if (updated.location && bwGlobal > 0 && bwDomestik > 0) {
                                     const priceGlobal = calculateInterpolatedPrice(bwGlobal, updated.location, ASTINET_BB_GLOBAL_PRICING);
                                     const priceDomestik = calculateInterpolatedPrice(bwDomestik, updated.location, ASTINET_BB_DOMESTIK_PRICING);
                                     
                                     if (priceGlobal !== null && priceDomestik !== null) {
                                         updated.mrc = Math.round(priceGlobal + priceDomestik);
                                     } else {
                                         updated.mrc = '';
                                     }
                                 } else {
                                     updated.mrc = '';
                                 }
                                 
                                 if (updated.bandwidthGlobal || updated.bandwidthDomestik) {
                                     updated.bandwidth = `Global: ${updated.bandwidthGlobal || '-'} | Domestik: ${updated.bandwidthDomestik || '-'}`;
                                 }
                             } else if (value === 'SIP Trunk') {
                                 const cc = parseInt(updated.concurrentCall) || 3;
                                 const num = parseInt(updated.jumlahNomor) || 3;
                                 const ip = parseInt(updated.ipAddress) || 1;
                                 const type = updated.sipTrunkType || 'Standard';
                                 
                                 let otc = 0;
                                 let mrc = 0;
                                 
                                 // 1. CC OTC
                                 if (cc >= 3 && cc <= 50) otc += 3000000;
                                 else if (cc <= 600) otc += 5000000;
                                 else if (cc <= 1000) otc += 6500000;
                                 
                                 // 2. Number OTC
                                 const otcNum = SIPTRUNK_OTC_NUMBER.find(r => num <= r.max);
                                 if (otcNum) otc += otcNum.price;
                                 
                                 // 3. IP OTC
                                 if (ip >= 2 && ip <= 5) otc += 500000;
                                 else if (ip >= 6 && ip <= 12) otc += 1000000;
                                 
                                 // 4. CC MRC
                                 const ccKeys = Object.keys(SIPTRUNK_MRC_CC).map(Number).sort((a,b) => a-b);
                                 const matchedCC = ccKeys.find(k => k >= cc);
                                 if (matchedCC) {
                                     const priceObj = SIPTRUNK_MRC_CC[matchedCC];
                                     mrc += (type === 'HA' ? priceObj.ha : priceObj.standard);
                                 }
                                 
                                 // 5. Number MRC
                                 const mrcNum = SIPTRUNK_MRC_NUMBER.find(r => num <= r.max);
                                 if (mrcNum) mrc += mrcNum.price;
                                 
                                 // 6. IP MRC
                                 if (ip >= 2 && ip <= 5) mrc += 500000;
                                 else if (ip >= 6 && ip <= 12) mrc += 1200000;
                                 
                                 updated.otc = otc;
                                 updated.mrc = mrc;
                             } else if (value.includes('IP Transit')) {
                                // Default Init for IP Transit
                                updated.isNeucentrix = false;
                                updated.distanceKm = 0;

                                if (value === 'IP Transit Beda Bandwidth') {
                                    updated.zone = 'JaBoDeTaBek';
                                    updated.bandwidthGlobal = '10 Mbps';
                                    updated.bandwidthDomestik = '10 Mbps';
                                    
                                    // Calculate initial price
                                    const bwGlobal = 10;
                                    const bwDomestik = 10;
                                    const pricingZone = updated.zone;
                                    
                                    let priceGlobal = calculateInterpolatedPrice(bwGlobal, pricingZone, IP_TRANSIT_BB_GLOBAL_PRICING);
                                    let priceDomestik = calculateInterpolatedPrice(bwDomestik, pricingZone, IP_TRANSIT_BB_DOMESTIK_PRICING);
                                    
                                    if (priceGlobal !== null && priceDomestik !== null) {
                                        updated.mrc = Math.round(priceGlobal + priceDomestik);
                                    } else {
                                        updated.mrc = '';
                                    }
                                    updated.bandwidth = `Global: ${updated.bandwidthGlobal} | Domestik: ${updated.bandwidthDomestik}`;
                                } else {
                                    updated.zone = 'JaBoDeTaBek';
                                    updated.mrc = '';
                                }
                            } else {
                                 // Switching to service without auto-pricing logic currently implemented (like Metro, etc)
                                 // Maybe keep existing or reset? Let's keep existing to be safe, or maybe reset if desired.
                                 // But let's leave it alone for now, user can edit.
                             }
                        }

                        if (field === 'type' && value !== 'Metro Ethernet') {
                           updated.sites = [];
                        } else if (field === 'type' && value === 'Metro Ethernet' && updated.sites.length === 0) {
                            // Pre-fill 2 sites for convenience
                            updated.sites = [
                                { name: 'Site A', bandwidth: '10 Mbps', isCustomBandwidth: false, zone: 'Jabodetabek', isNeucentrix: false }, 
                                { name: 'Site B', bandwidth: '10 Mbps', isCustomBandwidth: false, zone: 'Jabodetabek', isNeucentrix: false }
                            ];
                            updated.mrc = calculateMetroPrice(updated);
                        }
                        return updated;
                    }
                    return s;
                }));
            };

            const addSiteToService = (serviceId) => {
                setServices(prev => prev.map(s => {
                    if (s.id === serviceId) {
                        const newSites = [...s.sites, { name: '', bandwidth: '10 Mbps', isCustomBandwidth: false, zone: 'Jabodetabek', isNeucentrix: false }];
                        const updatedService = { ...s, sites: newSites };
                        if (s.type === 'Metro Ethernet') {
                            updatedService.mrc = calculateMetroPrice(updatedService);
                        }
                        return updatedService;
                    }
                    return s;
                }));
            };

            const updateSite = (serviceId, siteIndex, field, value) => {
                setServices(prev => prev.map(s => {
                    if (s.id === serviceId) {
                        const newSites = [...s.sites];
                        const oldSite = newSites[siteIndex];
                        newSites[siteIndex] = { ...oldSite, [field]: value };
                        
                        // Validation: If Zone is Sulsel/Nusra, Neucentrix must be false
                        if (field === 'zone') {
                            if (value === 'Sulawesi Selatan' || value === 'NTT') {
                                newSites[siteIndex].isNeucentrix = false;
                            }
                        }
                        if (field === 'isNeucentrix' && value === true) {
                            if (oldSite.zone === 'Sulawesi Selatan' || oldSite.zone === 'NTT') {
                                // Prevent enabling if invalid zone
                                newSites[siteIndex].isNeucentrix = false;
                            }
                        }

                        // Calculate price update if Metro
                        const updatedService = { ...s, sites: newSites };
                        if (s.type === 'Metro Ethernet') {
                            updatedService.mrc = calculateMetroPrice(updatedService);
                        }
                        
                        return updatedService;
                    }
                    return s;
                }));
            };

            const removeSite = (serviceId, siteIndex) => {
                setServices(prev => prev.map(s => {
                    if (s.id === serviceId) {
                        const newSites = s.sites.filter((_, i) => i !== siteIndex);
                        const updatedService = { ...s, sites: newSites };
                        if (s.type === 'Metro Ethernet') {
                            updatedService.mrc = calculateMetroPrice(updatedService);
                        }
                        return updatedService;
                    }
                    return s;
                }));
            };

            // --- Duration Parsing & Pricing Logic for Display ---
            const durationMatch = formData.subscriptionDuration.match(/(\d+)\s*(Bulan|Hari)/i);
            const durationValue = durationMatch ? parseInt(durationMatch[1]) : 12;
            const durationUnit = durationMatch ? durationMatch[2] : 'Bulan';
            const isDaily = durationUnit.toLowerCase() === 'hari';

            let priceMultiplier = 1;
            if (isDaily) {
                if (durationValue >= 1 && durationValue <= 3) priceMultiplier = 0.33;
                else if (durationValue >= 4 && durationValue <= 7) priceMultiplier = 0.53;
                else if (durationValue >= 8 && durationValue <= 14) priceMultiplier = 0.90;
                else if (durationValue >= 15 && durationValue <= 30) priceMultiplier = 1.00;
            }

            // --- Overview Table Calculations ---
            const ppnPercent = 11;
            const durationLabel = `${durationValue} ${durationUnit}`;
            
            const overviewRows = services.map(s => {
                let name = s.type;
                let area = s.location || '-';
                let bandwidth = s.bandwidth || '-';
                
                if (s.type.includes('IP Transit')) {
                    area = s.zone || area;
                } else if (s.type === 'Metro Ethernet') {
                    if (s.sites && s.sites.length > 0) {
                        area = s.sites[0].zone || area;
                        bandwidth = s.sites.map(site => `${site.name || 'Site'}: ${site.bandwidth || '-'}`).join(' | ');
                    }
                }

                // Calculate price
                // Base price (before discount)
                let basePrice = s.mrc || 0;
                if (isDaily) {
                     basePrice = Math.round(basePrice * priceMultiplier);
                }
                
                // Total for this service (x quantity)
                const qty = s.quantity || 1;
                const monthlyTotal = basePrice * qty;
                
                // Discount
                const discountPercent = s.discountPercent || 0;
                const discountedMonthlyTotal = Math.round(monthlyTotal * (1 - discountPercent / 100));

                return {
                    name,
                    area,
                    bandwidth,
                    monthlyTotal,
                    discountedMonthlyTotal
                };
            });

            const totalMonthly = overviewRows.reduce((acc, row) => acc + row.monthlyTotal, 0);
            const totalMonthlyDiscounted = overviewRows.reduce((acc, row) => acc + row.discountedMonthlyTotal, 0);
            
            // Calculate contract total
            const totalContract = isDaily ? totalMonthly : (totalMonthly * durationValue);
            const totalContractDiscounted = isDaily ? totalMonthlyDiscounted : (totalMonthlyDiscounted * durationValue);
            
            const totalContractDiscountedWithPpn = Math.round(totalContractDiscounted * (1 + ppnPercent / 100));

            const uniqueDiscounts = [...new Set(services.map(s => s.discountPercent || 0))];
            const headerDiscountLabel = uniqueDiscounts.length === 1 && uniqueDiscounts[0] > 0
                ? `(Disc. ${uniqueDiscounts[0]}%)`
                : '(Disc.)';

            return (
                <div className="container my-10">
                    <div className="header">
                        <div className="flex justify-between items-start">
                            <div className="flex items-center gap-3">
                                <IconFileText />
                                <h1>SPH Generator</h1>
                            </div>
                        </div>
                    </div>

                    <div className="content">
                        {/* Global Info */}
                        <div className="section-title">Informasi Pelanggan</div>
                        <div className="grid-3">
                            <div className="form-group">
                                <label>Nama AM (Account Manager)</label>
                                <div className="flex gap-2">
                                    <select
                                        value={isAmCustom ? 'Custom' : (AM_NAMES.includes(formData.amName) ? formData.amName : '')}
                                        onChange={(e) => {
                                            const val = e.target.value;
                                            if (val === 'Custom') {
                                                setIsAmCustom(true);
                                                setFormData(prev => ({ ...prev, amName: '' }));
                                            } else {
                                                setIsAmCustom(false);
                                                setFormData(prev => ({ ...prev, amName: val }));
                                            }
                                        }}
                                        className="form-control"
                                        style={{flex:1}}
                                    >
                                        <option value="" disabled>-- Pilih AM --</option>
                                        {AM_NAMES.map(name => (
                                            <option key={name} value={name}>{name}</option>
                                        ))}
                                        <option value="Custom">Custom (Manual Input)</option>
                                    </select>
                                </div>
                                {isAmCustom && (
                                    <input
                                        type="text"
                                        name="amName"
                                        value={formData.amName}
                                        onChange={handleInputChange}
                                        className="form-control mt-2"
                                        placeholder="Ketik Nama AM..."
                                        autoFocus
                                    />
                                )}
                            </div>
                            <div className="form-group">
                                <label>Nama Pelanggan</label>
                                <input
                                    type="text"
                                    name="customerName"
                                    value={formData.customerName}
                                    onChange={handleInputChange}
                                    className="form-control"
                                    placeholder="Ex: PT Maju Bersama Sejahtera"
                                />
                            </div>
                            <div className="form-group">
                                <label>Lama Berlangganan</label>
                                <div className="flex gap-2">
                                    <input
                                        type="number"
                                        min="1"
                                        value={parseInt(formData.subscriptionDuration) || ''}
                                        onChange={(e) => {
                                            const val = e.target.value;
                                            const unit = formData.subscriptionDuration.toLowerCase().includes('hari') ? 'Hari' : 'Bulan';
                                            setFormData(prev => ({ 
                                                ...prev, 
                                                subscriptionDuration: val ? `${val} ${unit}` : '' 
                                            }));
                                        }}
                                        className="form-control"
                                        placeholder="Nilai"
                                        style={{flex:1}}
                                    />
                                    <select
                                        value={formData.subscriptionDuration.toLowerCase().includes('hari') ? 'Hari' : 'Bulan'}
                                        onChange={(e) => {
                                            const unit = e.target.value;
                                            const val = parseInt(formData.subscriptionDuration) || 12;
                                            setFormData(prev => ({ 
                                                ...prev, 
                                                subscriptionDuration: `${val} ${unit}` 
                                            }));
                                        }}
                                        className="form-control"
                                        style={{width: '120px'}}
                                    >
                                        <option value="Bulan">Bulan</option>
                                        <option value="Hari">Hari</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        {/* Services */}
                        <div className="flex justify-between items-center mt-6 mb-4">
                            <div className="section-title" style={{margin:0}}>Daftar Layanan</div>
                            <div className="flex gap-2">
                                <a href="kalk-ncix.html" target="_blank" className="btn" style={{backgroundColor: '#10b981', color: 'white', textDecoration: 'none', display: 'flex', alignItems: 'center'}}>
                                    <span className="mr-1"><IconFileText /></span> Kalkulator NeuCentrIX
                                </a>
                                <button onClick={addService} className="btn btn-primary">
                                    <span className="mr-1"><IconPlus /></span> Tambah Layanan
                                </button>
                            </div>
                        </div>

                        {services.map((service, index) => {
                            const bwOptions = service.type === 'SL WDM' ? SL_WDM_BANDWIDTH_OPTIONS : 
                                              (service.type === 'VPN IP' ? VPN_IP_BANDWIDTH_OPTIONS : BANDWIDTH_OPTIONS);
                            
                            const getUnit = (val, type) => {
                                const match = val.match(/(Kbps|Mbps|Gbps)/i);
                                if (match) return match[0];
                                if (type === 'SL WDM') return 'Gbps';
                                if (type === 'VPN IP') return 'Kbps';
                                return 'Mbps';
                            };

                            return (
                                <div key={service.id} className="service-card">
                                <div className="flex justify-between items-start mb-4 border-b pb-2">
                                    <h3 className="font-bold text-gray-700">Layanan #{index + 1}</h3>
                                    {services.length > 1 && (
                                        <button onClick={() => removeService(service.id)} className="text-red-500 hover:text-red-700">
                                            <IconTrash />
                                        </button>
                                    )}
                                </div>
                                
                                <div className="grid-2 mb-4">
                                    <div className="form-group">
                                        <label>Jenis Layanan</label>
                                        <select
                                            value={service.type}
                                            onChange={(e) => updateService(service.id, 'type', e.target.value)}
                                            className="form-control"
                                        >
                                            {SERVICE_OPTIONS.map(opt => (
                                                <option key={opt} value={opt}>{opt}</option>
                                            ))}
                                        </select>
                                    </div>
                                    {service.type !== 'Metro Ethernet' && service.type !== 'SIP Trunk' && (
                                    <>
                                    <div className="form-group">
                                        <label>Bandwidth</label>
                                        {service.type.includes('Beda Bandwidth') ? (
                                            <div style={{display: 'flex', flexDirection: 'column', gap: '10px'}}>
                                                <div>
                                                    <label style={{fontSize: '0.8em', color: '#666'}}>Bandwidth Global</label>
                                                    <BandwidthSelector
                                                        value={service.bandwidthGlobal}
                                                        isCustom={service.isCustomBandwidthGlobal}
                                                        onValueChange={(val) => updateService(service.id, 'bandwidthGlobal', val)}
                                                        onCustomChange={(val) => updateService(service.id, 'isCustomBandwidthGlobal', val)}
                                                        serviceType={service.type}
                                                        options={service.isNeucentrix ? IP_TRANSIT_NEUCENTRIX_BANDWIDTH_OPTIONS : undefined}
                                                    />
                                                </div>
                                                <div>
                                                    <label style={{fontSize: '0.8em', color: '#666'}}>Bandwidth Domestik</label>
                                                    <BandwidthSelector
                                                        value={service.bandwidthDomestik}
                                                        isCustom={service.isCustomBandwidthDomestik}
                                                        onValueChange={(val) => updateService(service.id, 'bandwidthDomestik', val)}
                                                        onCustomChange={(val) => updateService(service.id, 'isCustomBandwidthDomestik', val)}
                                                        serviceType={service.type}
                                                        options={service.isNeucentrix ? IP_TRANSIT_NEUCENTRIX_BANDWIDTH_OPTIONS : undefined}
                                                    />
                                                </div>
                                            </div>
                                        ) : service.type === 'WMS' ? (
                                            <select
                                                value={service.bandwidth}
                                                onChange={(e) => updateService(service.id, 'bandwidth', e.target.value)}
                                                className="form-control"
                                            >
                                                {Object.entries(WMS_PACKAGES).map(([pkgName, pkgDetails]) => (
                                                    <option key={pkgName} value={pkgDetails.bandwidth}>
                                                        {pkgName} ({pkgDetails.bandwidth})
                                                    </option>
                                                ))}
                                            </select>
                                        ) : service.type === 'WMS Fit' ? (
                                            <select
                                                value={service.bandwidth}
                                                onChange={(e) => updateService(service.id, 'bandwidth', e.target.value)}
                                                className="form-control"
                                            >
                                                {Object.entries(WMS_FIT_PACKAGES).map(([pkgName, pkgDetails]) => (
                                                    <option key={pkgName} value={pkgDetails.bandwidth}>
                                                        {pkgName} ({pkgDetails.bandwidth})
                                                    </option>
                                                ))}
                                            </select>
                                        ) : service.type === 'WMS Lite' ? (
                                            <select
                                                value={service.bandwidth}
                                                onChange={(e) => updateService(service.id, 'bandwidth', e.target.value)}
                                                className="form-control"
                                            >
                                                {Object.entries(WMS_LITE_PACKAGES).map(([pkgName, pkgDetails]) => (
                                                    <option key={pkgName} value={pkgDetails.bandwidth}>
                                                        {pkgName} ({pkgDetails.bandwidth})
                                                    </option>
                                                ))}
                                            </select>
                                        ) : service.type === 'VPN IP' ? (
                                            <select
                                                value={service.bandwidth}
                                                onChange={(e) => updateService(service.id, 'bandwidth', e.target.value)}
                                                className="form-control"
                                            >
                                                {VPN_IP_BANDWIDTH_OPTIONS.map(opt => (
                                                    <option key={opt.value} value={opt.value}>
                                                        {opt.label}
                                                    </option>
                                                ))}
                                            </select>
                                        ) : (
                                            <BandwidthSelector
                                                value={service.bandwidth}
                                                isCustom={service.isCustomBandwidth}
                                                serviceType={service.type}
                                                onValueChange={(val) => updateService(service.id, 'bandwidth', val)}
                                                onCustomChange={(isCustom) => updateService(service.id, 'isCustomBandwidth', isCustom)}
                                            />
                                        )}
                                    </div>
                                    
                                    {service.type.includes('IP Transit') && (
                                        <div className="form-group">
                                            {!service.isNeucentrix && <label>Wilayah / Zone</label>}
                                            <div className="flex flex-col gap-2">
                                                {!service.isNeucentrix && (
                                                    <select
                                                        value={service.zone || (service.type === 'IP Transit Beda Bandwidth' ? 'JaBoDeTaBek' : 'JaBoDeTaBek')}
                                                        onChange={(e) => updateService(service.id, 'zone', e.target.value)}
                                                        className="form-control"
                                                    >
                                                        {(service.type === 'IP Transit Beda Bandwidth' ? IP_TRANSIT_BB_ZONE_OPTIONS : IP_TRANSIT_STD_ZONE_OPTIONS).map(opt => (
                                                            <option key={opt} value={opt}>{opt}</option>
                                                        ))}
                                                    </select>
                                                )}
                                                <div className="flex items-center gap-1">
                                                    <input
                                                        type="checkbox"
                                                        id={`ncix-${service.id}`}
                                                        checked={service.isNeucentrix || false}
                                                        disabled={service.zone === 'Sulawesi Selatan' || service.zone === 'NTT'}
                                                        onChange={(e) => updateService(service.id, 'isNeucentrix', e.target.checked)}
                                                        className="cursor-pointer"
                                                    />
                                                    <label 
                                                        htmlFor={`ncix-${service.id}`}
                                                        className={`text-sm cursor-pointer ${service.zone === 'Sulawesi Selatan' || service.zone === 'NTT' ? 'text-gray-400' : 'text-gray-600'}`}
                                                        style={{userSelect: 'none'}}
                                                    >
                                                        IP Transit Neucentrix (National Price)
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                    </>
                                    )}

                                    {service.type === 'VPN IP' && (
                                        <div className="grid-2" style={{gridColumn: '1 / -1'}}>
                                            <div className="form-group">
                                                <label>Tipe VPN</label>
                                                <select
                                                    value={service.vpnType || 'Standard'}
                                                    onChange={(e) => updateService(service.id, 'vpnType', e.target.value)}
                                                    className="form-control"
                                                >
                                                    {VPN_IP_TYPE_OPTIONS.map(opt => (
                                                        <option key={opt} value={opt}>{opt}</option>
                                                    ))}
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label>Class of Service (CoS)</label>
                                                <select
                                                    value={service.vpnCos || 'Best Effort'}
                                                    onChange={(e) => updateService(service.id, 'vpnCos', e.target.value)}
                                                    className="form-control"
                                                >
                                                    {VPN_IP_COS_OPTIONS.map(opt => (
                                                        <option key={opt} value={opt}>{opt}</option>
                                                    ))}
                                                </select>
                                            </div>
                                        </div>
                                    )}

                                    {service.type === 'SIP Trunk' && (
                                        <div className="grid-3" style={{gridColumn: '1 / -1'}}>
                                            <div className="form-group">
                                                <label>Tipe Trunk</label>
                                                <select
                                                    value={service.sipTrunkType || 'Standard'}
                                                    onChange={(e) => updateService(service.id, 'sipTrunkType', e.target.value)}
                                                    className="form-control"
                                                >
                                                    <option value="Standard">Standard</option>
                                                    <option value="HA">High Availability (HA)</option>
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label>Jumlah Nomor (Min 3)</label>
                                                <input
                                                    type="number"
                                                    min="3"
                                                    max="10000"
                                                    value={service.jumlahNomor || 3}
                                                    onChange={(e) => updateService(service.id, 'jumlahNomor', e.target.value)}
                                                    className="form-control"
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label>Concurrent Call (Min 3)</label>
                                                <input
                                                    type="number"
                                                    min="3"
                                                    max="10000"
                                                    value={service.concurrentCall || 3}
                                                    onChange={(e) => updateService(service.id, 'concurrentCall', e.target.value)}
                                                    className="form-control"
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label>Jumlah IP Address (Max 12)</label>
                                                <input
                                                    type="number"
                                                    min="1"
                                                    max="12"
                                                    value={service.ipAddress || 1}
                                                    onChange={(e) => updateService(service.id, 'ipAddress', e.target.value)}
                                                    className="form-control"
                                                />
                                            </div>
                                        </div>
                                    )}
                                </div>

                                {service.type === 'Metro Ethernet' ? (
                                    <div className="bg-white p-4 rounded border border-gray-200 mb-4">
                                        <div className="flex justify-between items-center mb-2">
                                            <div className="flex flex-col">
                                                <label className="text-sm font-bold text-gray-700">Sites (Metro Ethernet)</label>
                                                <div className="text-xs text-gray-500">
                                                    Mode: {service.sites.length < 2 ? 'Invalid (Min 2)' : (service.sites.length === 2 ? 'P2P' : 'P2MP')} | Status: {(() => {
                                                        const zones = service.sites.map(s => s.zone || '').filter(z => z);
                                                        const unique = new Set(zones);
                                                        if (zones.length < service.sites.length) return 'Isi Zona';
                                                        return unique.size > 1 ? 'Inter-Zone (Beda Zona)' : 'Intra-Zone (Satu Zona)';
                                                    })()}
                                                </div>
                                            </div>
                                            <div className="flex items-center gap-2">
                                                <select
                                                    value={service.metroQos || 'Interactive'}
                                                    onChange={(e) => updateService(service.id, 'metroQos', e.target.value)}
                                                    className="form-control"
                                                    style={{fontSize: '0.8rem', padding: '4px 8px', height: 'auto'}}
                                                >
                                                    <option value="Best Effort">Best Effort</option>
                                                    <option value="Interactive">Interactive</option>
                                                </select>
                                                <button onClick={() => addSiteToService(service.id)} className="text-blue-600 text-sm font-medium">+ Add Site</button>
                                            </div>
                                        </div>
                                        {service.sites.map((site, sIdx) => (
                                            <div key={sIdx} className="flex gap-2 mb-2 items-start">
                                                <div style={{flex: 1}}>
                                                    <div className="flex gap-2 mb-1">
                                                        <input 
                                                            type="text" 
                                                            className="form-control"
                                                            placeholder={`Nama Site ${sIdx + 1}`}
                                                            value={site.name}
                                                            onChange={(e) => updateSite(service.id, sIdx, 'name', e.target.value)}
                                                            style={{flex: 2}}
                                                        />
                                                        <div style={{flex: 1, display: 'flex', flexDirection: 'column'}}>
                                                            <select 
                                                                className="form-control"
                                                                value={site.zone || ''}
                                                                onChange={(e) => updateSite(service.id, sIdx, 'zone', e.target.value)}
                                                                style={{width: '100%'}}
                                                            >
                                                                <option value="" disabled>Pilih Zona</option>
                                                                {METRO_ZONE_OPTIONS.map(opt => (
                                                                    <option key={opt} value={opt}>{opt}</option>
                                                                ))}
                                                            </select>
                                                            <div className="flex items-center gap-1 mt-1">
                                                                <input
                                                                    type="checkbox"
                                                                    id={`ncix-${service.id}-${sIdx}`}
                                                                    checked={site.isNeucentrix || false}
                                                                    disabled={site.zone === 'Sulawesi Selatan' || site.zone === 'NTT'}
                                                                    onChange={(e) => updateSite(service.id, sIdx, 'isNeucentrix', e.target.checked)}
                                                                    className="cursor-pointer"
                                                                />
                                                                <label 
                                                                    htmlFor={`ncix-${service.id}-${sIdx}`} 
                                                                    className={`text-xs cursor-pointer ${site.zone === 'Sulawesi Selatan' || site.zone === 'NTT' ? 'text-gray-400' : 'text-gray-600'}`}
                                                                    style={{userSelect: 'none'}}
                                                                >
                                                                    Metro Neucentrix
                                                                </label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <BandwidthSelector
                                                        value={site.bandwidth}
                                                        isCustom={site.isCustomBandwidth}
                                                        serviceType={service.type}
                                                        onValueChange={(val) => updateSite(service.id, sIdx, 'bandwidth', val)}
                                                        onCustomChange={(isCustom) => updateSite(service.id, sIdx, 'isCustomBandwidth', isCustom)}
                                                    />
                                                    <div className="flex gap-2 items-center mt-2">
                                                        <label className="text-xs text-gray-600">Jarak ke Kantor Telkom (km):</label>
                                                        <input
                                                            type="number"
                                                            min="0"
                                                            step="0.1"
                                                            className="form-control"
                                                            style={{width: '80px', fontSize: '0.8rem', padding: '2px 4px', height: 'auto'}}
                                                            value={site.distanceKm || ''}
                                                            onChange={(e) => updateSite(service.id, sIdx, 'distanceKm', e.target.value)}
                                                            placeholder="0"
                                                        />
                                                    </div>
                                                    {(() => {
                                                        const bwVal = parseBandwidth(site.bandwidth);
                                                        const qos = service.metroQos || 'Interactive';
                                                        let price = 0;
                                                        
                                                        // Calculate isInter for context
                                                        const zones = service.sites.map(s => s.zone || '').filter(z => z);
                                                        const uniqueZones = new Set(zones);
                                                        const isInter = uniqueZones.size > 1;
                                                        
                                                        const zone = site.zone || 'Jabodetabek';
                                                        const isNeucentrix = site.isNeucentrix || false;
                                                        const priceObj = getMetroPriceObject(zone, bwVal, isInter, isNeucentrix);

                                                        if (priceObj) {
                                                            const typeKey = qos === 'Interactive' ? 'int' : 'be';
                                                            let basePrice = priceObj[typeKey];
                                                            
                                                            // Multiplier for Sulawesi Selatan (NOT applicable if Neucentrix)
                                                            if (zone === 'Sulawesi Selatan' && !isNeucentrix) {
                                                                basePrice = basePrice * 1.3;
                                                            }
                                                            
                                                            price = basePrice;
                                                        }

                                                        if (price > 0) {
                                                            return <div className="text-xs text-gray-500 mt-1 font-semibold">Harga: Rp {price.toLocaleString('id-ID')}</div>;
                                                        }
                                                        return null;
                                                    })()}
                                                </div>
                                                <button onClick={() => removeSite(service.id, sIdx)} className="btn-danger-text mt-1">
                                                    <IconX />
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                ) : (
                                    <>
                                    {!service.type.includes('IP Transit') && service.type !== 'SIP Trunk' && !['WMS', 'WMS Fit', 'WMS Lite'].includes(service.type) && (
                                    <div className="form-group">
                                        <label>Lokasi</label>
                                        <div className="flex gap-2">
                                            {!['WMS', 'WMS Fit', 'WMS Lite'].includes(service.type) && (
                                            <select
                                                value={
                                                    service.type === 'VPN IP'
                                                    ? (VPN_IP_LOCATION_OPTIONS.includes(service.location) ? service.location : '')
                                                    : (LOCATION_OPTIONS.includes(service.location) ? service.location : (service.location ? 'Custom' : ''))
                                                }
                                                onChange={(e) => {
                                                    const val = e.target.value;
                                                    updateService(service.id, 'location', val === 'Custom' ? '' : val);
                                                }}
                                                className="form-control"
                                                style={{flex:1}}
                                            >
                                                <option value="" disabled>Pilih Lokasi</option>
                                                {service.type === 'VPN IP' ? (
                                                    VPN_IP_LOCATION_OPTIONS.map(opt => (
                                                        <option key={opt} value={opt}>{opt}</option>
                                                    ))
                                                ) : (
                                                    LOCATION_OPTIONS.map(opt => (
                                                        <option key={opt} value={opt}>{opt}</option>
                                                    ))
                                                )}
                                                {!service.type.includes('Astinet') && service.type !== 'VPN IP' && <option value="Custom">Custom</option>}
                                            </select>
                                            )}
                                            {(['WMS', 'WMS Fit', 'WMS Lite'].includes(service.type) || (!LOCATION_OPTIONS.includes(service.location) && !service.type.includes('Astinet') && service.type !== 'VPN IP')) && (
                                                <input
                                                    type="text"
                                                    value={service.location}
                                                    onChange={(e) => updateService(service.id, 'location', e.target.value)}
                                                    className="form-control"
                                                    placeholder={['WMS', 'WMS Fit', 'WMS Lite'].includes(service.type) ? "Isi lokasi" : "Isi lokasi manual"}
                                                    style={{flex:1}}
                                                />
                                            )}
                                        </div>
                                    </div>
                                    )}
                                    
                                    {(service.type.toLowerCase().includes('astinet') || service.type.includes('IP Transit') || service.type === 'VPN IP') && (
                                        <div className="form-group">
                                            <label>{service.type === 'VPN IP' ? 'Jarak ... km dari titik pelanggan ke kantor Telkom terdekat' : 'Jarak ke Kantor Telkom (km)'}</label>
                                            <input
                                                type="number"
                                                min="0"
                                                step="0.1"
                                                className="form-control"
                                                value={service.distanceKm || ''}
                                                onChange={(e) => updateService(service.id, 'distanceKm', e.target.value)}
                                                placeholder="0"
                                            />
                                        </div>
                                    )}
                                    </>
                                )}

                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(5, 1fr)', gap: '1rem' }} className="mb-4">
                                    <div className="form-group">
                                        <label>Jumlah Sirkuit (Qty)</label>
                                        <input
                                            type="number"
                                            min="1"
                                            value={service.quantity || 1}
                                            onChange={(e) => updateService(service.id, 'quantity', parseInt(e.target.value) || 1)}
                                            className="form-control"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>Harga Aktivasi (OTC)</label>
                                        <FormattedNumberInput
                                            value={service.otc}
                                            onChange={(val) => updateService(service.id, 'otc', val)}
                                            className="form-control"
                                            placeholder="0"
                                            disabled={service.type === 'VPN IP'}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>{isDaily ? `Harga Layanan (${durationValue} Hari)` : 'Harga Layanan (Bulanan)'}</label>
                                        <FormattedNumberInput
                                            value={isDaily ? Math.round(service.mrc * priceMultiplier) : service.mrc}
                                            onChange={(val) => {
                                                let newMrc = val;
                                                if (isDaily && priceMultiplier > 0) {
                                                     newMrc = Math.round(val / priceMultiplier);
                                                }
                                                updateService(service.id, 'mrc', newMrc);
                                            }}
                                            className="form-control"
                                            placeholder="0"
                                        />
                                        {isDaily && (
                                            <div style={{fontSize: '0.8em', color: '#666', marginTop: '4px'}}>
                                                (Base Bulanan: {(service.mrc || 0).toLocaleString('id-ID')})
                                                <div style={{color: '#10b981', fontWeight: 'bold'}}>
                                                    Diskon: Rp {((service.mrc || 0) - Math.round(service.mrc * priceMultiplier)).toLocaleString('id-ID')} ({Math.round((1 - priceMultiplier) * 100)}%)
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                    <div className="form-group">
                                        <label>Diskon (%)</label>
                                        <input
                                            type="number"
                                            min="0"
                                            max="100"
                                            value={service.discountPercent ?? 0}
                                            onChange={(e) => {
                                                const num = parseInt(e.target.value, 10);
                                                const safeVal = isNaN(num) ? 0 : Math.min(100, Math.max(0, num));
                                                updateService(service.id, 'discountPercent', safeVal);
                                            }}
                                            className="form-control"
                                            placeholder="0"
                                        />
                                    </div>
                                    { !service.type.toLowerCase().includes('astinet') && service.type !== 'VPN IP' && (
                                    <div className="form-group">
                                        <label>Keterangan</label>
                                        <input
                                            type="text"
                                            value={service.remarks}
                                            onChange={(e) => updateService(service.id, 'remarks', e.target.value)}
                                            className="form-control"
                                            placeholder="Ex: Backhaul"
                                        />
                                    </div>
                                    )}
                                </div>
                            </div>
                            );
                        })}

                        <div className="mt-10">
                            <div className="flex justify-between items-center mb-3">
                                <h3 className="text-lg font-semibold text-gray-800">Tarif Ringkasan</h3>
                                <div className="flex flex-wrap gap-3 items-center text-sm">
                                    <div className="flex items-center gap-2">
                                        <span className="font-medium text-gray-700">Durasi</span>
                                        <span className="px-2 py-1 border rounded bg-gray-50">{durationLabel}</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <span className="font-medium text-gray-700">PPN</span>
                                        <span className="px-2 py-1 border rounded bg-gray-50">{ppnPercent}%</span>
                                    </div>
                                </div>
                            </div>

                            <div className="overflow-x-auto">
                                <table className="min-w-full text-sm border border-gray-200">
                                    <thead>
                                        <tr className="bg-red-600 text-white">
                                            <th className="px-3 py-2 text-left">Layanan</th>
                                            <th className="px-3 py-2 text-left">Area</th>
                                            <th className="px-3 py-2 text-left">Bandwidth</th>
                                            <th className="px-3 py-2 text-right">
                                                Tarif per {isDaily ? `${durationValue} Hari` : 'Bulan'}
                                            </th>
                                            <th className="px-3 py-2 text-right">
                                                {headerDiscountLabel}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {overviewRows.map((row, idx) => (
                                            <tr key={idx} className="border-t">
                                                <td className="px-3 py-2">{row.name}</td>
                                                <td className="px-3 py-2">{row.area}</td>
                                                <td className="px-3 py-2">{row.bandwidth}</td>
                                                <td className="px-3 py-2 text-right">
                                                    {row.monthlyTotal.toLocaleString('id-ID')}
                                                </td>
                                                <td className="px-3 py-2 text-right">
                                                    {row.discountedMonthlyTotal.toLocaleString('id-ID')}
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                    <tfoot>
                                        <tr className="bg-red-50 font-semibold">
                                            <td className="px-3 py-2" colSpan="3">Total</td>
                                            <td className="px-3 py-2 text-right">
                                                {totalMonthly.toLocaleString('id-ID')}
                                            </td>
                                            <td className="px-3 py-2 text-right">
                                                {totalMonthlyDiscounted.toLocaleString('id-ID')}
                                            </td>
                                        </tr>
                                        <tr className="bg-red-100 font-semibold">
                                            <td className="px-3 py-2" colSpan="3">
                                                Total {durationLabel}
                                            </td>
                                            <td className="px-3 py-2 text-right">
                                                {totalContract.toLocaleString('id-ID')}
                                            </td>
                                            <td className="px-3 py-2 text-right">
                                                {totalContractDiscounted.toLocaleString('id-ID')}
                                            </td>
                                        </tr>
                                        <tr className="bg-red-100 font-semibold">
                                            <td className="px-3 py-2" colSpan="4">
                                                Total {durationLabel} (Incl. PPN {ppnPercent}%)
                                            </td>
                                            <td className="px-3 py-2 text-right">
                                                {totalContractDiscountedWithPpn.toLocaleString('id-ID')}
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>

                        <div className="flex justify-end mt-8">
                            <button 
                                onClick={async () => {
                                    setIsGenerating(true);
                                    // Use a small timeout to allow UI to update
                                    await new Promise(r => setTimeout(r, 100));
                                    await generateSPH(formData, services);
                                    setIsGenerating(false);
                                }} 
                                disabled={isGenerating}
                                className="btn btn-primary" 
                                style={{fontSize: '1.1rem', padding: '12px 24px', opacity: isGenerating ? 0.7 : 1, cursor: isGenerating ? 'not-allowed' : 'pointer'}}
                            >
                                <span className="mr-2">{isGenerating ? '...' : <IconDownload />}</span> {isGenerating ? 'Memproses...' : 'Download SPH (.docx)'}
                            </button>
                        </div>

                        
                        {/* Footer Images for Copy-Paste */}
                        <div className="mt-8 border-t pt-4 text-center">
                            <h3 className="text-gray-600 font-bold mb-4">
                                Header & Footer Images <br/>
                                <span className="text-sm font-normal">(Add on For Manual Copy-Paste in SPH)</span>
                            </h3>
                            <div className="flex flex-col gap-6 items-center">
                                {/* Header (Logo) */}
                                <div className="border p-2 rounded bg-white shadow-sm" style={{maxWidth: '100%'}}>
                                    <p className="text-sm text-gray-500 mb-2">Header (Logo)</p>
                                    <img 
                                        src="./Picture1.jpg" 
                                        alt="Telkom Indonesia Logo" 
                                        style={{maxWidth: '200px', height: 'auto', display: 'block', margin: '0 auto'}} 
                                    />
                                </div>
                                {/* Footer (Pattern) */}
                                <div className="border p-2 rounded bg-white shadow-sm" style={{maxWidth: '100%'}}>
                                    <p className="text-sm text-gray-500 mb-2">Footer (Pattern)</p>
                                    <img 
                                        src="./Picture2-.png" 
                                        alt="Footer Pattern" 
                                        style={{maxWidth: '100%', height: 'auto', display: 'block', margin: '0 auto'}} 
                                    />
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style={{maxWidth: '56rem', margin: '0 auto', textAlign: 'center', color: '#666', fontSize: '0.75rem', fontStyle: 'italic', paddingLeft: '1rem', paddingRight: '1rem'}}>
                        *for next development will add these service (SL WDM) in the future.
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
